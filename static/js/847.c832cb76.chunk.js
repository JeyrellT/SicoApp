"use strict";(self.webpackChunksicop_app=self.webpackChunksicop_app||[]).push([[847],{7847:(e,n,o)=>{o.r(n),o.d(n,{default:()=>d});var i=o(9379),t=o(9950),a=o(7939),s=o(1397),r=o.n(s),l=o(724),c=o(4414);function d(e){let{onSaveCategory:n}=e;const[o,s]=(0,t.useState)([]),[d,u]=(0,t.useState)(""),[p,g]=(0,t.useState)([]),[f,h]=(0,t.useState)(!1),[m,x]=(0,t.useState)("exact"),[b,y]=(0,t.useState)(.5),[C,v]=(0,t.useState)(""),[j,S]=(0,t.useState)([]),[L,z]=(0,t.useState)(new Set),w=(0,t.useMemo)(()=>0===p.length?null:{total:p.length,totalMonto:r().sumBy(p,e=>e.presupuestoLinea||0),avgScore:r().meanBy(p,"score"),instituciones:r().countBy(p,"codigoInstitucion"),topKeywords:r().chain(p).flatMap(e=>e.coincidencias).countBy().toPairs().orderBy([1],["desc"]).take(10).value()},[p]),T=()=>{const e=d.trim().toLowerCase();e&&!o.includes(e)&&(s([...o,e]),u(""))},k=()=>{const e=a.M.obtenerDatos("DetalleLineaCartel")||[],n=a.M.obtenerDatos("DetalleCarteles")||[],i=[];if(console.log("[KeywordTestingPanel] \ud83d\udd0d Iniciando b\xfasqueda exacta..."),console.log("[KeywordTestingPanel] \ud83d\udcca Total lineas: ".concat(e.length,", Total carteles: ").concat(n.length)),console.log("[KeywordTestingPanel] \ud83d\udd11 Keywords a buscar:",o),e.length>0){const n=e[0];console.log("[KeywordTestingPanel] \ud83d\udd2c Campos de la primera l\xednea:",Object.keys(n)),console.log("[KeywordTestingPanel] \ud83d\udd2c Muestra de primera l\xednea:",{numeroCartel:n.numeroCartel,numeroLinea:n.numeroLinea,descripcionLinea:n.descripcionLinea,DESC_LINEA:n.DESC_LINEA,desc_linea:n.desc_linea})}if(n.length>0){const e=n[0];console.log("[KeywordTestingPanel] \ud83d\udd2c Campos del primer cartel:",Object.keys(e)),console.log("[KeywordTestingPanel] \ud83d\udd2c Muestra de primer cartel:",{numeroCartel:e.numeroCartel,nombreCartel:e.nombreCartel,nombre_cartel:e.nombre_cartel})}const t=new Map(n.map(e=>[e.numeroCartel,e])),s=r().groupBy(e,"numeroCartel"),l=e=>(e||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim(),c=e=>{if(!e)return[];const n=l(e),i=[];for(const t of o){const e=l(t);n.includes(e)&&i.push(t)}return i},d=function(e){for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];for(const t of o){const n=e[t];if(void 0!==n&&null!==n&&""!==n)return console.log('[obtenerCampo] \u2705 Encontrado campo "'.concat(t,'" con valor:'),String(n).substring(0,100)),String(n)}return console.log("[obtenerCampo] \u274c NO encontrado ninguno de:",o,"en objeto con campos:",Object.keys(e).slice(0,20)),""};let u=0,p=0;return console.log("[KeywordTestingPanel] \ud83d\udcca Iniciando an\xe1lisis de",e.length,"l\xedneas"),e.length>0&&(console.log("[KeywordTestingPanel] \ud83d\udd2c Primera l\xednea completa:",e[0]),console.log("[KeywordTestingPanel] \ud83d\udd2c Campos disponibles:",Object.keys(e[0]))),e.forEach((e,n)=>{u++,n<3&&console.log("[KeywordTestingPanel] \ud83d\udd0d Analizando l\xednea ".concat(n+1,":"),{numeroCartel:e.numeroCartel,numeroLinea:e.numeroLinea,camposDisponibles:Object.keys(e),descripcionLinea:e.descripcionLinea,DESC_LINEA:e.DESC_LINEA,desc_linea:e.desc_linea,DESCRIPCION_LINEA:e.DESCRIPCION_LINEA});const a=t.get(e.numeroCartel),r=[],l=[],g=d(e,"descripcionLinea","DESC_LINEA","desc_linea","DESCRIPCION_LINEA"),f=c(g);if(f.length>0&&(f.forEach(e=>{r.includes(e)||r.push(e)}),l.push({fuente:"Descripci\xf3n de l\xednea",texto:g.substring(0,200),palabras:f})),a){const e=d(a,"nombreCartel","NOMBRE_CARTEL","nombre_cartel","cartel_nm"),n=c(e);n.length>0&&(n.forEach(e=>{r.includes(e)||r.push(e)}),l.push({fuente:"Nombre del cartel",texto:e.substring(0,200),palabras:n}));const o=d(a,"descripcionCartel","DESCRIPCION_CARTEL","descripcion","DESCRIPCION"),i=c(o);i.length>0&&(i.forEach(e=>{r.includes(e)||r.push(e)}),l.push({fuente:"Descripci\xf3n del cartel",texto:o.substring(0,200),palabras:i}));const t=d(a,"clasificacionObjeto","CLASIFICACION_OBJETO","clasificacion","CLAS_OBJ"),s=c(t);s.length>0&&(s.forEach(e=>{r.includes(e)||r.push(e)}),l.push({fuente:"Clasificaci\xf3n UNSPSC",texto:t.substring(0,200),palabras:s}))}if(r.length>0){p++;const n=r.length/o.length;let t=e.descripcionLinea||(null===a||void 0===a?void 0:a.nombreCartel)||(null===a||void 0===a?void 0:a.descripcionCartel)||"Sin descripci\xf3n";const c=s[e.numeroCartel]||[];i.push({numeroCartel:e.numeroCartel,numeroLinea:e.numeroLinea,descripcionLinea:t,presupuestoLinea:e.presupuestoLinea||0,codigoInstitucion:(null===a||void 0===a?void 0:a.codigoInstitucion)||"",nombreCartel:(null===a||void 0===a?void 0:a.nombreCartel)||"",coincidencias:r,fuentesConCoincidencias:l,score:n,mode:"exact",todasLasLineas:c}),p<=5&&(console.log("[KeywordTestingPanel] \u2705 L\xednea ".concat(e.numeroLinea," del Cartel ").concat(e.numeroCartel,": ").concat(r.length," keywords encontradas")),console.log("[KeywordTestingPanel]    \ud83d\udccd Fuentes:",l.map(e=>e.fuente).join(", ")),console.log("[KeywordTestingPanel]    \ud83d\udd11 Keywords:",r.join(", ")))}}),console.log("[KeywordTestingPanel] \u2705 B\xfasqueda completa: ".concat(p," l\xedneas con coincidencias (de ").concat(u," analizadas)")),console.log("[KeywordTestingPanel] \ud83d\udcca Fuentes \xfanicas usadas:",[...new Set(i.flatMap(e=>{var n;return(null===(n=e.fuentesConCoincidencias)||void 0===n?void 0:n.map(e=>e.fuente))||[]}))].join(", ")),i},A=()=>{const e=a.M.obtenerDatos("DetalleLineaCartel")||[],n=a.M.obtenerDatos("DetalleCarteles")||[],i=[];console.log("[KeywordTestingPanel] \ud83d\udd0d Iniciando b\xfasqueda fuzzy..."),console.log("[KeywordTestingPanel] \ud83d\udcca Total lineas: ".concat(e.length,", Total carteles: ").concat(n.length));const t=new Map(n.map(e=>[e.numeroCartel,e])),s=e=>(e||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim(),r=e=>{if(!e)return[];const n=s(e).split(/\s+/),i=[];for(const t of o){const e=s(t);n.some(n=>n.includes(e)||e.includes(n))&&i.push(t)}return i};let l=0,c=0;return e.forEach(e=>{l++;const n=t.get(e.numeroCartel),a=[],s=[],d=r(e.descripcionLinea);if(d.length>0&&(d.forEach(e=>{a.includes(e)||a.push(e)}),s.push({fuente:"Descripci\xf3n de l\xednea",texto:(e.descripcionLinea||"").substring(0,200),palabras:d})),null!==n&&void 0!==n&&n.nombreCartel){const e=r(n.nombreCartel);e.length>0&&(e.forEach(e=>{a.includes(e)||a.push(e)}),s.push({fuente:"Nombre del cartel",texto:n.nombreCartel.substring(0,200),palabras:e}))}if(null!==n&&void 0!==n&&n.descripcionCartel){const e=r(n.descripcionCartel);e.length>0&&(e.forEach(e=>{a.includes(e)||a.push(e)}),s.push({fuente:"Descripci\xf3n del cartel",texto:n.descripcionCartel.substring(0,200),palabras:e}))}if(null!==n&&void 0!==n&&n.clasificacionObjeto){const e=r(n.clasificacionObjeto);e.length>0&&(e.forEach(e=>{a.includes(e)||a.push(e)}),s.push({fuente:"Clasificaci\xf3n UNSPSC",texto:n.clasificacionObjeto.substring(0,200),palabras:e}))}if(a.length>0){c++;const t=a.length/o.length*.9;let r=e.descripcionLinea||(null===n||void 0===n?void 0:n.nombreCartel)||(null===n||void 0===n?void 0:n.descripcionCartel)||"Sin descripci\xf3n";i.push({numeroCartel:e.numeroCartel,numeroLinea:e.numeroLinea,descripcionLinea:r,presupuestoLinea:e.presupuestoLinea||0,codigoInstitucion:(null===n||void 0===n?void 0:n.codigoInstitucion)||"",nombreCartel:(null===n||void 0===n?void 0:n.nombreCartel)||"",coincidencias:a,fuentesConCoincidencias:s,score:t,mode:"fuzzy"}),c<=5&&(console.log("[KeywordTestingPanel] \u2705 L\xednea ".concat(e.numeroLinea," del Cartel ").concat(e.numeroCartel," (fuzzy): ").concat(a.length," keywords")),console.log("[KeywordTestingPanel]    \ud83d\udccd Fuentes:",s.map(e=>e.fuente).join(", ")))}}),console.log("[KeywordTestingPanel] \u2705 B\xfasqueda fuzzy completa: ".concat(c," l\xedneas encontradas (de ").concat(l," analizadas)")),console.log("[KeywordTestingPanel] \ud83d\udcca Fuentes \xfanicas usadas:",[...new Set(i.flatMap(e=>{var n;return(null===(n=e.fuentesConCoincidencias)||void 0===n?void 0:n.map(e=>e.fuente))||[]}))].join(", ")),i},I=()=>{const e=a.M.obtenerDatos("DetalleLineaCartel")||[],n=[],t={computadora:["computador","pc","ordenador","equipo de c\xf3mputo"],software:["programa","aplicaci\xf3n","sistema inform\xe1tico"],"veh\xedculo":["autom\xf3vil","carro","transporte"],mobiliario:["mueble","escritorio","silla"],"construcci\xf3n":["obra","edificaci\xf3n","infraestructura"],mantenimiento:["reparaci\xf3n","servicio"],"m\xe9dico":["sanitario","cl\xednico","salud"],"educaci\xf3n":["escolar","acad\xe9mico","docente"]},s=new Set(o);for(const i of o)t[i]&&t[i].forEach(e=>s.add(e));for(const a of e){const e=(a.descripcionLinea||"").toLowerCase(),r=[];let l=0;for(const n of Array.from(s))if(e.includes(n)){const e=o.find(e=>{var o;return e===n||(null===(o=t[e])||void 0===o?void 0:o.includes(n))});e&&!r.includes(e)&&r.push(e),l++}if(r.length>0){const e=r.length/o.length*(1+.1*l);n.push((0,i.A)((0,i.A)({},a),{},{coincidencias:r,score:Math.min(e,1),mode:"semantic",semanticMatches:l}))}}return n};return(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:l.S2,children:[(0,c.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:20,fontWeight:700,color:"#1f2937"},children:"\ud83e\uddea Panel de Prueba de Palabras Clave"}),(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:20,marginBottom:20},children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{marginBottom:16},children:[(0,c.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600,color:"#374151"},children:"Agregar palabras clave"}),(0,c.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,c.jsx)("input",{type:"text",value:d,onChange:e=>u(e.target.value),onKeyPress:e=>"Enter"===e.key&&T(),placeholder:"Ej: computadora, software, m\xe9dico...",style:{flex:1,padding:"10px 12px",border:"2px solid #e5e7eb",borderRadius:8,fontSize:14}}),(0,c.jsx)("button",{onClick:T,style:(0,l.HM)("primary"),children:"+ Agregar"})]}),(0,c.jsxs)("div",{style:{marginTop:12,minHeight:60},children:[o.map(e=>(0,c.jsxs)("span",{style:(0,i.A)((0,i.A)({},l.qS),{},{background:"linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%)",color:"white",fontSize:13,padding:"6px 12px",cursor:"pointer"}),onClick:()=>(e=>{s(o.filter(n=>n!==e))})(e),children:[e," \xd7"]},e)),0===o.length&&(0,c.jsx)("div",{style:{color:"#9ca3af",fontSize:13,fontStyle:"italic"},children:"No hay palabras clave agregadas"})]})]}),(0,c.jsxs)("div",{style:{marginBottom:16},children:[(0,c.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600,color:"#374151"},children:"Modo de an\xe1lisis"}),(0,c.jsxs)("select",{value:m,onChange:e=>x(e.target.value),style:{width:"100%",padding:"10px 12px",border:"2px solid #e5e7eb",borderRadius:8,fontSize:14,cursor:"pointer"},children:[(0,c.jsx)("option",{value:"exact",children:"Exacto - Coincidencia literal"}),(0,c.jsx)("option",{value:"fuzzy",children:"Fuzzy - Permite variaciones"}),(0,c.jsx)("option",{value:"semantic",children:"Sem\xe1ntico - Incluye sin\xf3nimos"})]})]}),(0,c.jsxs)("div",{style:{marginBottom:16},children:[(0,c.jsxs)("label",{style:{display:"block",marginBottom:8,fontWeight:600,color:"#374151"},children:["Confianza m\xednima: ",(100*b).toFixed(0),"%"]}),(0,c.jsx)("input",{type:"range",min:"0",max:"1",step:"0.1",value:b,onChange:e=>y(parseFloat(e.target.value)),style:{width:"100%"}})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{marginBottom:16},children:[(0,c.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:600,color:"#374151"},children:"Nombre de la categor\xeda (para guardar)"}),(0,c.jsx)("input",{type:"text",value:C,onChange:e=>v(e.target.value),placeholder:"Ej: Equipo de C\xf3mputo",style:{width:"100%",padding:"10px 12px",border:"2px solid #e5e7eb",borderRadius:8,fontSize:14}})]}),(0,c.jsxs)("div",{style:{background:"#fef3c7",border:"2px solid #fbbf24",borderRadius:8,padding:16,marginBottom:16},children:[(0,c.jsx)("div",{style:{fontWeight:600,color:"#92400e",marginBottom:8},children:"\u2139\ufe0f Modos de an\xe1lisis:"}),(0,c.jsxs)("ul",{style:{margin:0,paddingLeft:20,fontSize:13,color:"#78350f"},children:[(0,c.jsxs)("li",{children:[(0,c.jsx)("strong",{children:"Exacto:"})," Busca coincidencias literales"]}),(0,c.jsxs)("li",{children:[(0,c.jsx)("strong",{children:"Fuzzy:"})," Encuentra palabras similares"]}),(0,c.jsxs)("li",{children:[(0,c.jsx)("strong",{children:"Sem\xe1ntico:"})," Incluye sin\xf3nimos y t\xe9rminos relacionados"]})]})]}),(0,c.jsx)("button",{onClick:()=>{0!==o.length?(h(!0),setTimeout(()=>{try{let e=[];e="exact"===m?k():"fuzzy"===m?A():I(),e=e.filter(e=>e.score>=b),j.length>0&&(e=e.filter(e=>j.includes(e.codigoInstitucion)));const n=r().groupBy(e,"numeroCartel"),o=Object.entries(n).map(e=>{let[n,o]=e;const i=o[0],t=r().uniq(r().flatMap(o,e=>e.coincidencias)),a=r().meanBy(o,"score"),s=r().sumBy(o,e=>e.presupuestoLinea||0),l=o.some(e=>{var n;return null===(n=e.fuentesConCoincidencias)||void 0===n?void 0:n.some(e=>"Nombre del cartel"===e.fuente)});return{numeroCartel:n,nombreCartel:i.nombreCartel,codigoInstitucion:i.codigoInstitucion,coincidencias:t,score:a,presupuestoTotal:s,cantidadLineasConCoincidencias:o.length,lineasConCoincidencias:o,nombreTieneCoincidencias:l,mode:i.mode}}),i=r().orderBy(o,[e=>e.nombreTieneCoincidencias?1:0,"score"],["desc","desc"]);g(i)}finally{h(!1)}},100)):alert("Agrega al menos una palabra clave para analizar")},disabled:f||0===o.length,style:(0,i.A)((0,i.A)({},(0,l.HM)("primary")),{},{width:"100%",padding:"12px",fontSize:16,marginRight:0,opacity:f||0===o.length?.5:1,cursor:f||0===o.length?"not-allowed":"pointer"}),children:f?"\ud83d\udd04 Analizando...":"\ud83d\udd0d Analizar Licitaciones"})]})]})]}),p.length>0&&(0,c.jsxs)(c.Fragment,{children:[w&&(0,c.jsxs)("div",{style:l.S2,children:[(0,c.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:18,fontWeight:700,color:"#1f2937"},children:"\ud83d\udcca Estad\xedsticas del An\xe1lisis"}),(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:16,marginBottom:20},children:[(0,c.jsxs)("div",{style:{textAlign:"center",padding:16,background:"#dbeafe",borderRadius:8},children:[(0,c.jsx)("div",{style:{fontSize:28,fontWeight:700,color:"#1e40af"},children:w.total}),(0,c.jsx)("div",{style:{color:"#1e3a8a",fontSize:14},children:"Licitaciones encontradas"})]}),(0,c.jsxs)("div",{style:{textAlign:"center",padding:16,background:"#dcfce7",borderRadius:8},children:[(0,c.jsx)("div",{style:{fontSize:20,fontWeight:700,color:"#166534"},children:(0,l.up)(w.totalMonto)}),(0,c.jsx)("div",{style:{color:"#14532d",fontSize:14},children:"Monto total"})]}),(0,c.jsxs)("div",{style:{textAlign:"center",padding:16,background:"#fef3c7",borderRadius:8},children:[(0,c.jsxs)("div",{style:{fontSize:28,fontWeight:700,color:"#92400e"},children:[(100*w.avgScore).toFixed(0),"%"]}),(0,c.jsx)("div",{style:{color:"#78350f",fontSize:14},children:"Confianza promedio"})]}),(0,c.jsxs)("div",{style:{textAlign:"center",padding:16,background:"#e0e7ff",borderRadius:8},children:[(0,c.jsx)("div",{style:{fontSize:28,fontWeight:700,color:"#3730a3"},children:Object.keys(w.instituciones).length}),(0,c.jsx)("div",{style:{color:"#312e81",fontSize:14},children:"Instituciones"})]})]}),(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("strong",{style:{color:"#374151"},children:"Top palabras clave:"})," ",w.topKeywords.slice(0,5).map(e=>{let[n,o]=e;return(0,c.jsxs)("span",{style:(0,i.A)((0,i.A)({},l.qS),{},{background:"#22c55e",color:"white",fontSize:12}),children:[n," (",o,")"]},n)})]}),(0,c.jsx)("button",{onClick:()=>{C.trim()?0!==o.length?n&&(n(o,C.trim()),v(""),s([]),g([]),alert('\u2705 Categor\xeda "'.concat(C,'" guardada con ').concat(o.length," palabras clave"))):alert("Agrega al menos una palabra clave"):alert("Ingresa un nombre para la categor\xeda")},style:(0,l.HM)("primary"),children:"\ud83d\udcbe Guardar como Categor\xeda"})]})]}),(0,c.jsxs)("div",{style:l.S2,children:[(0,c.jsxs)("h3",{style:{margin:"0 0 16px 0",fontSize:18,fontWeight:700,color:"#1f2937"},children:["\ud83d\udccb Licitaciones Encontradas (",p.length,")"]}),(0,c.jsxs)("div",{style:{maxHeight:700,overflow:"auto"},children:[p.slice(0,50).map((e,n)=>{var o,t,a;const s=L.has(e.numeroCartel);return(0,c.jsxs)("div",{style:{background:e.nombreTieneCoincidencias?"#ecfdf5":"#f9fafb",border:e.nombreTieneCoincidencias?"2px solid #10b981":"1px solid #e5e7eb",borderRadius:8,padding:16,marginBottom:12},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:12},children:[(0,c.jsxs)("div",{style:{display:"flex",gap:12,alignItems:"center",flex:1},children:[e.nombreTieneCoincidencias&&(0,c.jsx)("span",{style:{background:"#10b981",color:"white",padding:"4px 10px",borderRadius:6,fontSize:11,fontWeight:700,textTransform:"uppercase"},children:"\u2b50 Nombre Coincide"}),(0,c.jsx)("span",{style:{background:"#3b82f6",color:"white",padding:"6px 12px",borderRadius:6,fontSize:13,fontWeight:700},children:e.numeroCartel}),(0,c.jsx)("span",{style:{background:"#f3f4f6",color:"#374151",padding:"4px 10px",borderRadius:6,fontSize:12,fontWeight:600},children:e.codigoInstitucion}),(0,c.jsxs)("span",{style:{background:e.score>=.8?"#22c55e":e.score>=.6?"#fbbf24":"#f97316",color:"white",padding:"4px 10px",borderRadius:6,fontSize:12,fontWeight:700},children:[(100*e.score).toFixed(0),"% confianza"]}),(0,c.jsxs)("span",{style:{background:"#e0e7ff",color:"#3730a3",padding:"4px 10px",borderRadius:6,fontSize:11,fontWeight:600},children:[e.cantidadLineasConCoincidencias," l\xedneas con coincidencias"]})]}),e.presupuestoTotal>0&&(0,c.jsx)("span",{style:{color:"#059669",fontWeight:700,fontSize:14},children:(0,l.up)(e.presupuestoTotal)})]}),(0,c.jsx)("div",{style:{fontSize:15,color:"#111827",lineHeight:1.5,marginBottom:12,fontWeight:600,background:e.nombreTieneCoincidencias?"#d1fae5":"transparent",padding:e.nombreTieneCoincidencias?"8px 12px":"0",borderRadius:e.nombreTieneCoincidencias?6:0,border:e.nombreTieneCoincidencias?"1px solid #6ee7b7":"none"},children:e.nombreCartel||"Sin nombre"}),(0,c.jsxs)("div",{style:{display:"flex",gap:6,flexWrap:"wrap",alignItems:"center",marginBottom:12},children:[(0,c.jsx)("span",{style:{fontSize:12,color:"#6b7280",fontWeight:600},children:"\ud83d\udd11 Palabras clave encontradas:"}),e.coincidencias.map(e=>(0,c.jsxs)("span",{style:(0,i.A)((0,i.A)({},l.qS),{},{background:"#22c55e",color:"white",fontSize:11}),children:["\u2713 ",e]},e))]}),(0,c.jsxs)("button",{onClick:()=>{const n=new Set(L);s?n.delete(e.numeroCartel):n.add(e.numeroCartel),z(n)},style:(0,i.A)((0,i.A)({},(0,l.HM)("secondary")),{},{width:"100%",marginTop:8,marginRight:0,display:"flex",alignItems:"center",justifyContent:"center",gap:8}),children:[s?"\u25bc":"\u25b6"," ",s?"Ocultar":"Ver"," todas las l\xedneas del cartel (",(null===(o=e.lineasConCoincidencias[0])||void 0===o||null===(t=o.todasLasLineas)||void 0===t?void 0:t.length)||0," l\xedneas totales)"]}),s&&(null===(a=e.lineasConCoincidencias[0])||void 0===a?void 0:a.todasLasLineas)&&(0,c.jsxs)("div",{style:{marginTop:16,background:"white",border:"2px solid #e5e7eb",borderRadius:8,padding:16},children:[(0,c.jsx)("h4",{style:{margin:"0 0 12px 0",fontSize:14,fontWeight:700,color:"#1f2937",textTransform:"uppercase",letterSpacing:"0.5px"},children:"\ud83d\udccb Todas las l\xedneas del cartel"}),e.lineasConCoincidencias[0].todasLasLineas.map((n,o)=>{const i=e.lineasConCoincidencias.some(e=>e.numeroLinea===n.numeroLinea),t=e.lineasConCoincidencias.find(e=>e.numeroLinea===n.numeroLinea);return(0,c.jsxs)("div",{style:{background:i?"#fef3c7":"#f9fafb",border:i?"2px solid #fbbf24":"1px solid #e5e7eb",borderRadius:6,padding:12,marginBottom:8},children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,c.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,c.jsxs)("span",{style:{background:i?"#fbbf24":"#9ca3af",color:i?"#78350f":"white",padding:"3px 8px",borderRadius:4,fontSize:11,fontWeight:700},children:["L\xednea ",n.numeroLinea]}),i&&(0,c.jsx)("span",{style:{background:"#10b981",color:"white",padding:"3px 8px",borderRadius:4,fontSize:10,fontWeight:700,textTransform:"uppercase"},children:"\u2713 Coincide"})]}),n.presupuestoLinea>0&&(0,c.jsx)("span",{style:{color:"#059669",fontWeight:600,fontSize:12},children:(0,l.up)(n.presupuestoLinea)})]}),(0,c.jsx)("div",{style:{fontSize:13,color:n.descripcionLinea?"#374151":"#9ca3af",lineHeight:1.5,marginBottom:i?8:0,fontStyle:n.descripcionLinea?"normal":"italic"},children:n.descripcionLinea||"(Sin descripci\xf3n en la l\xednea - ver fuentes de coincidencia abajo)"}),i&&t&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{style:{display:"flex",gap:4,flexWrap:"wrap",marginBottom:8},children:[(0,c.jsx)("span",{style:{fontSize:11,color:"#92400e",fontWeight:600},children:"Palabras encontradas:"}),t.coincidencias.map(e=>(0,c.jsxs)("span",{style:{background:"#22c55e",color:"white",padding:"2px 6px",borderRadius:3,fontSize:10,fontWeight:600},children:["\u2713 ",e]},e))]}),t.fuentesConCoincidencias&&t.fuentesConCoincidencias.length>0&&(0,c.jsxs)("div",{style:{background:"white",border:"2px solid #86efac",borderRadius:4,padding:10},children:[(0,c.jsx)("div",{style:{fontSize:11,fontWeight:700,color:"#059669",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.5px"},children:"\ud83c\udfaf D\xf3nde se encontraron las palabras clave:"}),t.fuentesConCoincidencias.map((e,n)=>(0,c.jsxs)("div",{style:{background:"#f0fdf4",border:"1px solid #86efac",borderRadius:4,padding:8,marginBottom:6,fontSize:12},children:[(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4,flexWrap:"wrap"},children:[(0,c.jsxs)("span",{style:{background:"#22c55e",color:"white",padding:"3px 8px",borderRadius:4,fontSize:10,fontWeight:700,textTransform:"uppercase"},children:["\ud83d\udccd ",e.fuente]}),(0,c.jsx)("div",{style:{display:"flex",gap:4,flexWrap:"wrap"},children:e.palabras.map((e,n)=>(0,c.jsxs)("span",{style:{background:"#dcfce7",color:"#166534",padding:"2px 8px",borderRadius:3,fontSize:10,fontWeight:700},children:["\u2713 ",e]},n))})]}),(0,c.jsxs)("div",{style:{color:"#374151",fontSize:11,lineHeight:1.5,background:"white",padding:"6px 8px",borderRadius:3,border:"1px solid #e5e7eb"},children:[(0,c.jsx)("strong",{style:{color:"#059669"},children:"Texto:"})," ",e.texto]})]},n))]})]})]},o)})]})]},n)}),p.length>50&&(0,c.jsxs)("div",{style:{textAlign:"center",padding:20,color:"#6b7280"},children:["Mostrando 50 de ",p.length," resultados"]})]})]})]}),0===p.length&&!f&&o.length>0&&(0,c.jsxs)("div",{style:(0,i.A)((0,i.A)({},l.S2),{},{textAlign:"center",padding:40}),children:[(0,c.jsx)("div",{style:{fontSize:48,marginBottom:16},children:"\ud83d\udd0d"}),(0,c.jsx)("div",{style:{fontSize:18,color:"#6b7280",marginBottom:8},children:"Palabras clave configuradas"}),(0,c.jsx)("div",{style:{fontSize:14,color:"#9ca3af"},children:'Haz clic en "Analizar Licitaciones" para ver los resultados'})]})]})}}}]);