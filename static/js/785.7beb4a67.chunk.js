"use strict";(self.webpackChunksicop_app=self.webpackChunksicop_app||[]).push([[785],{724:(e,a,t)=>{t.d(a,{HM:()=>o,S2:()=>r,l9:()=>s,qS:()=>n,up:()=>i});const i=e=>new Intl.NumberFormat("es-CR",{style:"currency",currency:"CRC"}).format(e),s=e=>"".concat(e.toFixed(1),"%"),r={background:"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)",borderRadius:12,boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",border:"1px solid rgba(226, 232, 240, 0.8)",padding:24,marginBottom:20,transition:"all 0.3s ease"},n={display:"inline-flex",alignItems:"center",gap:6,padding:"6px 12px",borderRadius:20,fontSize:13,fontWeight:600,margin:"4px 6px 4px 0"},o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"secondary";return{background:"primary"===e?"linear-gradient(135deg, #1e3a8a 0%, #0c4a6e 100%)":"danger"===e?"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)":"#e5e7eb",color:"secondary"!==e?"#fff":"#111827",border:"none",borderRadius:8,padding:"10px 18px",cursor:"pointer",marginRight:10,fontWeight:600,fontSize:14,transition:"all 0.3s ease",boxShadow:"secondary"!==e?"0 2px 4px rgba(0, 0, 0, 0.1)":"none"}}},2785:(e,a,t)=>{t.r(a),t.d(a,{DemoPanel:()=>ma,default:()=>xa});var i=t(9950),s=t(5313),r=t(9379),n=t(7939),o=t(7119),l=t(6479),c=t(7453),d=t(9680),p=t(3147),h=t(5833),m=t(6355),x=t(4799),g=t(3655),u=t(4414);const f=e=>{let{options:a,selectedValues:t,onChange:s,placeholder:r,searchPlaceholder:n,icon:m,color:x,maxDisplayed:g=2}=e;const[f,b]=(0,i.useState)(!1),[v,j]=(0,i.useState)(""),[y,N]=(0,i.useState)(!1),C=(0,i.useRef)(null),w=(0,i.useRef)(null),k=(0,i.useRef)(null),S=(0,i.useRef)(null),[M,_]=(0,i.useState)({top:0,left:0,width:0}),A=function(e,a){const[t,s]=(0,i.useState)(e);return(0,i.useEffect)(()=>{const t=setTimeout(()=>{s(e)},a);return()=>{clearTimeout(t)}},[e,a]),t}(v,300),T=(0,i.useMemo)(()=>{if(!A.trim())return a;const e=A.toLowerCase();return a.filter(a=>a.label.toLowerCase().includes(e)||a.value.toLowerCase().includes(e))},[a,A]);(0,i.useEffect)(()=>{N(v!==A)},[v,A]),(0,i.useEffect)(()=>{const e=e=>{var a,t;const i=e.target;if(!f)return;const s=null===(a=w.current)||void 0===a?void 0:a.contains(i),r=null===(t=k.current)||void 0===t?void 0:t.contains(i);s||r||(b(!1),j(""))};return document.addEventListener("mousedown",e,!0),()=>document.removeEventListener("mousedown",e,!0)},[f]);const z=()=>{if(!w.current)return;const e=w.current.getBoundingClientRect(),a=window.innerHeight,t=e.bottom+420>a&&e.top>420?e.top-420-8:e.bottom+4;_({top:Math.max(8,t+window.scrollY),left:e.left+window.scrollX,width:e.width})};(0,i.useEffect)(()=>{if(f){z();const e=()=>z();return window.addEventListener("resize",e),window.addEventListener("scroll",e,!0),()=>{window.removeEventListener("resize",e),window.removeEventListener("scroll",e,!0)}}},[f]),(0,i.useEffect)(()=>{f&&S.current&&S.current.focus()},[f]);const L=t.map(e=>a.find(a=>a.value===e)).filter(Boolean);return(0,u.jsxs)("div",{className:"advanced-multiselect",ref:C,style:{position:"relative"},children:[(0,u.jsxs)("div",{ref:w,onClick:()=>{b(e=>!e)},style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px 16px",background:"white",border:"2px solid ".concat(f?x:"#e9ecef"),borderRadius:"12px",cursor:"pointer",transition:"all 0.2s ease",minHeight:"48px",boxShadow:f?"0 4px 12px ".concat(x,"20"):"0 2px 8px rgba(0,0,0,0.05)"},onMouseEnter:e=>{f||(e.currentTarget.style.borderColor=x)},onMouseLeave:e=>{f||(e.currentTarget.style.borderColor="#e9ecef")},children:[(0,u.jsx)("div",{style:{color:x,fontSize:"20px"},children:m}),(0,u.jsx)("div",{style:{flex:1,minWidth:0},children:0===t.length?(0,u.jsx)("span",{style:{color:"#6c757d",fontSize:"14px"},children:r}):t.length<=g?(0,u.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px"},children:L.map(e=>(0,u.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:"4px",background:"".concat(x,"15"),color:x,padding:"4px 8px",borderRadius:"6px",fontSize:"12px",fontWeight:600,border:"1px solid ".concat(x,"30")},children:[e.label,(0,u.jsx)(l.A,{size:14,onClick:a=>{return i=e.value,a.stopPropagation(),void s(t.filter(e=>e!==i));var i},style:{cursor:"pointer",opacity:.7}})]},e.value))}):(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,u.jsxs)("span",{style:{background:"".concat(x,"15"),color:x,padding:"4px 12px",borderRadius:"20px",fontSize:"12px",fontWeight:600,border:"1px solid ".concat(x,"30")},children:[t.length," seleccionados"]}),(0,u.jsx)("button",{onClick:e=>{e.stopPropagation(),s([])},style:{background:"transparent",border:"none",color:"#dc3545",fontSize:"12px",cursor:"pointer",padding:"2px 6px",borderRadius:"4px"},children:"Limpiar"})]})}),(0,u.jsx)(c.A,{size:16,style:{color:"#6c757d",transform:f?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s ease"}})]}),f&&(0,o.createPortal)((0,u.jsxs)("div",{ref:k,style:{position:"absolute",top:M.top,left:M.left,width:M.width,background:"white",border:"2px solid ".concat(x),borderRadius:"12px",boxShadow:"0 12px 40px ".concat(x,"33, 0 2px 8px rgba(0,0,0,0.15)"),zIndex:5e3,maxHeight:"420px",overflow:"hidden",display:"flex",flexDirection:"column",animation:"fadeInScale 120ms ease"},children:[(0,u.jsxs)("div",{style:{padding:"16px",borderBottom:"1px solid #e9ecef",background:"#f8f9fa"},children:[(0,u.jsxs)("div",{style:{position:"relative",display:"flex",alignItems:"center"},children:[y?(0,u.jsx)(d.A,{size:16,style:{position:"absolute",left:"12px",color:x,animation:"spin 1s linear infinite"}}):(0,u.jsx)(p.A,{size:16,style:{position:"absolute",left:"12px",color:"#6c757d"}}),(0,u.jsx)("input",{ref:S,type:"text",placeholder:n,value:v,onChange:e=>j(e.target.value),style:{width:"100%",padding:"8px 12px 8px 40px",border:"1px solid ".concat(y?x:"#e9ecef"),borderRadius:"8px",fontSize:"14px",outline:"none",transition:"border-color 0.2s ease"},onFocus:e=>e.target.style.borderColor=x,onBlur:e=>e.target.style.borderColor=y?x:"#e9ecef"})]}),(0,u.jsxs)("div",{style:{display:"flex",gap:"8px",marginTop:"12px"},children:[(0,u.jsx)("button",{onClick:()=>s(T.map(e=>e.value)),style:{background:"".concat(x,"10"),color:x,border:"1px solid ".concat(x,"30"),padding:"4px 8px",borderRadius:"6px",fontSize:"12px",cursor:"pointer",fontWeight:600},children:"Seleccionar todos"}),(0,u.jsx)("button",{onClick:()=>s([]),style:{background:"#fff5f5",color:"#dc3545",border:"1px solid #feb2b2",padding:"4px 8px",borderRadius:"6px",fontSize:"12px",cursor:"pointer",fontWeight:600},children:"Limpiar selecci\xf3n"})]})]}),(0,u.jsx)("div",{style:{flex:1,overflowY:"auto",maxHeight:"300px"},children:y?(0,u.jsxs)("div",{style:{padding:"24px",textAlign:"center",color:"#6c757d",fontSize:"14px"},children:[(0,u.jsx)(d.A,{size:24,style:{opacity:.7,marginBottom:"8px",animation:"spin 1s linear infinite"}}),(0,u.jsx)("div",{children:"Buscando..."}),(0,u.jsx)("div",{style:{fontSize:"12px",marginTop:"4px"},children:"Filtrando resultados"})]}):0===T.length?(0,u.jsxs)("div",{style:{padding:"24px",textAlign:"center",color:"#6c757d",fontSize:"14px"},children:[(0,u.jsx)(p.A,{size:24,style:{opacity:.5,marginBottom:"8px"}}),(0,u.jsx)("div",{children:"No se encontraron resultados"}),(0,u.jsx)("div",{style:{fontSize:"12px",marginTop:"4px"},children:v.trim()?"Intenta con otros t\xe9rminos de b\xfasqueda":"No hay opciones disponibles"})]}):(0,u.jsxs)(u.Fragment,{children:[v.trim()&&(0,u.jsxs)("div",{style:{padding:"8px 16px",background:"#f8f9fa",borderBottom:"1px solid #e9ecef",fontSize:"12px",color:"#6c757d",fontWeight:500},children:[T.length," resultados encontrados",v.trim()&&' para "'.concat(v,'"')]}),T.map(e=>{const a=t.includes(e.value);return(0,u.jsxs)("div",{onClick:()=>(e=>{const a=t.includes(e)?t.filter(a=>a!==e):[...t,e];s(a)})(e.value),style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px 16px",cursor:"pointer",borderBottom:"1px solid #f8f9fa",background:a?"".concat(x,"08"):"white",transition:"all 0.2s ease"},onMouseEnter:e=>{a||(e.currentTarget.style.background="#f8f9fa")},onMouseLeave:e=>{a||(e.currentTarget.style.background="white")},children:[(0,u.jsx)("div",{style:{width:"20px",height:"20px",borderRadius:"4px",border:"2px solid ".concat(a?x:"#e9ecef"),background:a?x:"white",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease"},children:a&&(0,u.jsx)(h.A,{size:12,color:"white"})}),(0,u.jsxs)("div",{style:{flex:1},children:[(0,u.jsx)("div",{style:{fontWeight:a?600:500,color:a?x:"#2c3e50",fontSize:"14px"},children:e.label}),e.count&&(0,u.jsxs)("div",{style:{fontSize:"12px",color:"#6c757d",marginTop:"2px"},children:[e.count.toLocaleString()," elementos"]})]})]},e.value)})]})})]}),document.body)]})},b=e=>{let{institutions:a,categories:t,selectedInstitutions:i,selectedCategories:s,searchKeywords:r="",onInstitutionsChange:n,onCategoriesChange:o,onSearchKeywordsChange:c,onApplyFilters:d,onClearFilters:b,isLoading:v=!1}=e;const j=i.length>0||s.length>0||r.trim().length>0;return(0,u.jsxs)("div",{style:{background:"linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.9) 100%)",backdropFilter:"blur(10px)",borderRadius:"16px",padding:"24px",border:"1px solid rgba(255,255,255,0.2)",boxShadow:"0 8px 32px rgba(0,0,0,0.1)",marginBottom:"24px"},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"20px"},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,u.jsx)("div",{style:{width:"40px",height:"40px",borderRadius:"12px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"center",color:"white"},children:(0,u.jsx)(m.A,{size:20})}),(0,u.jsxs)("div",{children:[(0,u.jsx)("h3",{style:{margin:0,fontSize:"20px",fontWeight:700,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"Filtros Avanzados"}),(0,u.jsx)("p",{style:{margin:0,fontSize:"14px",color:"#6c757d"},children:"Busca y selecciona instituciones y categor\xedas"})]})]}),(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[j&&(0,u.jsxs)("div",{style:{background:"linear-gradient(135deg, #28a745 0%, #20c997 100%)",color:"white",padding:"6px 12px",borderRadius:"20px",fontSize:"12px",fontWeight:600,display:"flex",alignItems:"center",gap:"4px"},children:[(0,u.jsx)(h.A,{size:14}),i.length+s.length+(r?1:0)," filtros activos"]}),v&&(0,u.jsxs)("div",{style:{background:"#17a2b8",color:"white",padding:"6px 12px",borderRadius:"20px",fontSize:"12px",fontWeight:600,display:"flex",alignItems:"center",gap:"6px"},children:[(0,u.jsx)("div",{className:"loading-spinner",style:{width:"12px",height:"12px",border:"2px solid white",borderTop:"2px solid transparent",borderRadius:"50%",animation:"spin 1s linear infinite"}}),"Cargando..."]})]})]}),c&&(0,u.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,u.jsxs)("div",{style:{position:"relative",width:"100%"},children:[(0,u.jsx)(p.A,{size:20,style:{position:"absolute",left:"16px",top:"50%",transform:"translateY(-50%)",color:"#6c757d",pointerEvents:"none"}}),(0,u.jsx)("input",{type:"text",value:r,onChange:e=>c(e.target.value),placeholder:"Buscar por texto (ej: 'Saenz', 'computadoras', 'medicamentos')...",style:{width:"100%",padding:"14px 16px 14px 48px",border:"2px solid #e9ecef",borderRadius:"12px",fontSize:"15px",outline:"none",transition:"all 0.2s ease",background:"white"},onFocus:e=>{e.currentTarget.style.borderColor="#667eea",e.currentTarget.style.boxShadow="0 0 0 3px rgba(102, 126, 234, 0.1)"},onBlur:e=>{e.currentTarget.style.borderColor="#e9ecef",e.currentTarget.style.boxShadow="none"}}),r&&(0,u.jsx)("button",{onClick:()=>c(""),style:{position:"absolute",right:"12px",top:"50%",transform:"translateY(-50%)",background:"transparent",border:"none",cursor:"pointer",color:"#6c757d",padding:"4px",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center"},onMouseEnter:e=>{e.currentTarget.style.background="#f8f9fa",e.currentTarget.style.color="#dc3545"},onMouseLeave:e=>{e.currentTarget.style.background="transparent",e.currentTarget.style.color="#6c757d"},children:(0,u.jsx)(l.A,{size:16})})]}),(0,u.jsx)("p",{style:{margin:"8px 0 0 0",fontSize:"12px",color:"#6c757d",fontStyle:"italic"},children:"\ud83d\udca1 Busca palabras clave en nombres de carteles, descripciones y l\xedneas. Separa m\xfaltiples palabras con espacios."})]}),(0,u.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",marginBottom:"20px"},children:[(0,u.jsx)(f,{options:a,selectedValues:i,onChange:n,placeholder:"Seleccionar instituciones...",searchPlaceholder:"Buscar instituciones por nombre o c\xf3digo...",icon:(0,u.jsx)(x.A,{size:20}),color:"#3498db"}),(0,u.jsx)(f,{options:t,selectedValues:s,onChange:o,placeholder:"Seleccionar categor\xedas...",searchPlaceholder:"Buscar categor\xedas por nombre...",icon:(0,u.jsx)(g.A,{size:20}),color:"#e74c3c"})]}),(0,u.jsxs)("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[j&&(0,u.jsxs)("button",{onClick:b,disabled:v,style:{display:"flex",alignItems:"center",gap:"8px",background:"transparent",color:"#dc3545",border:"2px solid #dc3545",padding:"10px 20px",borderRadius:"12px",fontWeight:600,cursor:v?"not-allowed":"pointer",opacity:v?.6:1,transition:"all 0.2s ease"},onMouseEnter:e=>{v||(e.currentTarget.style.background="#dc3545",e.currentTarget.style.color="white")},onMouseLeave:e=>{v||(e.currentTarget.style.background="transparent",e.currentTarget.style.color="#dc3545")},children:[(0,u.jsx)(l.A,{size:16}),"Limpiar filtros"]}),(0,u.jsxs)("button",{onClick:d,disabled:v,style:{display:"flex",alignItems:"center",gap:"8px",background:j?"linear-gradient(135deg, #667eea 0%, #764ba2 100%)":"linear-gradient(135deg, #6c757d 0%, #495057 100%)",color:"white",border:"none",padding:"12px 24px",borderRadius:"12px",fontWeight:600,cursor:v?"not-allowed":"pointer",opacity:v?.6:1,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",transition:"all 0.2s ease"},onMouseEnter:e=>{v||(e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 20px rgba(0,0,0,0.2)")},onMouseLeave:e=>{v||(e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.15)")},children:[(0,u.jsx)(m.A,{size:16}),j?"Aplicar filtros":"Ver todos los datos"]})]}),(0,u.jsx)("style",{children:"\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n        .loading-spinner {\n          animation: spin 1s linear infinite;\n        }\n      "})]})};var v=t(1095),j=t(5973),y=t(158),N=t(3440),C=t(2174),w=t(987),k=t(7621),S=t(5297),M=t(2528),_=t(294),A=t(3588),T=t(6890),z=t(5391),L=t(8406),P=t(9201),R=t(2828),F=t(5924),D=t(9318),I=t(6987),E=t(1742),W=t(7737),B=t(7637),O=t(8635),H=t(9975),Y=t(6274),U=t(4215),G=t(9051),V=t.n(G);const Z="es-CR",q=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==e||isNaN(e))return"\u2014";const{compact:t=!1,decimals:i=0,showSign:s=!1}=a;if(t&&Math.abs(e)>=1e3){if(Math.abs(e)>=1e9)return"".concat((e/1e9).toFixed(1),"MM");if(Math.abs(e)>=1e6)return"".concat((e/1e6).toFixed(1),"M");if(Math.abs(e)>=1e3)return"".concat((e/1e3).toFixed(1),"K")}return new Intl.NumberFormat(Z,{minimumFractionDigits:i,maximumFractionDigits:i,signDisplay:s?"exceptZero":"auto"}).format(e)},K=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==e||isNaN(e))return"\u2014";const{compact:t=!1,showDecimals:i=!1,showSign:s=!1}=a;if(t&&Math.abs(e)>=1e3){if(Math.abs(e)>=1e9)return"\u20a1".concat((e/1e9).toFixed(1),"MM");if(Math.abs(e)>=1e6)return"\u20a1".concat((e/1e6).toFixed(1),"M");if(Math.abs(e)>=1e3)return"\u20a1".concat((e/1e3).toFixed(1),"K")}return new Intl.NumberFormat(Z,{style:"currency",currency:"CRC",minimumFractionDigits:i?2:0,maximumFractionDigits:i?2:0,signDisplay:s?"exceptZero":"auto"}).format(e).replace("CRC","\u20a1")},X=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==e||isNaN(e))return"\u2014";const{decimals:t=1,showSign:i=!1}=a;return new Intl.NumberFormat(Z,{style:"percent",minimumFractionDigits:t,maximumFractionDigits:t,signDisplay:i?"exceptZero":"auto"}).format(e/100)},J=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return"\u2014";const{format:t="short",includeTime:i=!1}=a,s=e instanceof Date?e:new Date(e);if(isNaN(s.getTime()))return String(e);if("relative"===t){const e=new Intl.RelativeTimeFormat(Z,{numeric:"auto"}),a=new Date,t=Math.floor((s.getTime()-a.getTime())/864e5);return Math.abs(t)<1?"hoy":Math.abs(t)<7?e.format(t,"day"):Math.abs(t)<30?e.format(Math.floor(t/7),"week"):Math.abs(t)<365?e.format(Math.floor(t/30),"month"):e.format(Math.floor(t/365),"year")}const r="short"===t?"short":"medium"===t?"medium":"long";return new Intl.DateTimeFormat(Z,{dateStyle:r,timeStyle:i?"short":void 0}).format(s)},Q=(e,a,t,i)=>{const s=[];if(a.length>0){const t=((e,a)=>a.length?[...a].sort((e,a)=>a-e).findIndex(a=>a<=e)+1||a.length:0)(e,a),i=a.length;s.push({type:"rank",value:"#".concat(t," de ").concat(i),context:t<=3?"Top performer":t>.8*i?"Abajo del promedio":"Posici\xf3n media",sentiment:t<=3?"positive":t>.8*i?"negative":"neutral"});const r=a.reduce((e,a)=>e+a,0);if(r>0){const a=e/r*100;s.push({type:"percentage",value:X(a),context:"del total",sentiment:a>10?"positive":a<1?"negative":"neutral"})}}if(null!=t&&t>0){const a=(e-t)/t*100,i=a>0?"\u2197":a<0?"\u2198":"\u2192";s.push({type:"trend",value:"".concat(i," ").concat(X(Math.abs(a),{showSign:!1})),context:a>0||a<0?"vs per\xedodo anterior":"sin cambio",sentiment:a>0?"positive":a<0?"negative":"neutral"})}if(a.length>=4){const{outliers:t}=(e=>{if(e.length<4)return{outliers:[],threshold:{lower:0,upper:0}};const a=[...e].sort((e,a)=>e-a),t=a[Math.floor(.25*a.length)],i=a[Math.floor(.75*a.length)],s=i-t,r=t-1.5*s,n=i+1.5*s;return{outliers:e.filter(e=>e<r||e>n),threshold:{lower:r,upper:n}}})(a);t.includes(e)&&s.push({type:"outlier",value:"\u26a0\ufe0f At\xedpico",context:"Valor fuera del rango normal",sentiment:"negative"})}return s},$={primary:["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],sequential:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],diverging:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],categorical:["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],status:{success:"#10b981",warning:"#f59e0b",error:"#ef4444",info:"#3b82f6",neutral:"#6b7280"}},ee=e=>K(e,{compact:!0}),ae=(e,a)=>({text:e,title:K(a)}),te={kpi_metrics:{total_contratos:0,total_carteles:0,total_proveedores:0,total_ofertas:0,total_lineas:0,promedio_lineas_por_cartel:0,tasa_exito:0,crecimiento_contratos:0,contratos_recientes:0,carteles_recientes:0},sector_analysis:[],monto_total_contratos:0,tendencias_mensuales:[],tendencias_diarias:[]},ie={top_instituciones:[],top_proveedores:[],offers_histogram:[],tta_distribution:[],tta_stats:{n:0,mediana:0,p90:0},hhi_market:{hhi:0,top5Share:0}},se=e=>{let{title:a,value:t,subtitle:i,trend:s,trendValue:r,icon:n,color:o,onClick:l,badge:c}=e;return(0,u.jsxs)("div",{onClick:l,style:{background:"linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.85) 100%)",backdropFilter:"blur(20px) saturate(180%)",WebkitBackdropFilter:"blur(20px) saturate(180%)",borderRadius:"24px",padding:"32px",boxShadow:"\n        0 8px 32px rgba(0,0,0,0.1),\n        0 0 0 1px rgba(255,255,255,0.2) inset,\n        0 20px 60px rgba(102, 126, 234, 0.15)\n      ",border:"2px solid rgba(255,255,255,0.3)",cursor:l?"pointer":"default",transition:"all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",position:"relative",overflow:"hidden",transform:"translateZ(0) rotateX(0deg) rotateY(0deg)",transformStyle:"preserve-3d",perspective:"1500px",willChange:"transform, box-shadow",animation:"card-float 6s ease-in-out infinite"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-20px) translateZ(30px) rotateX(5deg) scale(1.05)",e.currentTarget.style.boxShadow="\n        0 25px 70px rgba(0,0,0,0.25),\n        0 0 0 2px rgba(255,255,255,0.4) inset,\n        0 35px 100px ".concat(o,"40\n      ")},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0) translateZ(0) rotateX(0deg) scale(1)",e.currentTarget.style.boxShadow="\n        0 8px 32px rgba(0,0,0,0.1),\n        0 0 0 1px rgba(255,255,255,0.2) inset,\n        0 20px 60px rgba(102, 126, 234, 0.15)\n      "},children:[(0,u.jsx)("div",{style:{position:"absolute",top:"-50%",left:"-50%",width:"200%",height:"200%",background:"linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.2) 50%, transparent 70%)",backgroundSize:"500px 500px",animation:"shimmer 4s linear infinite",pointerEvents:"none",opacity:.6}}),c&&(0,u.jsx)("div",{style:{position:"absolute",top:"16px",right:"16px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%)",color:"white",padding:"6px 12px",borderRadius:"12px",fontSize:"11px",fontWeight:700,boxShadow:"0 4px 15px rgba(102, 126, 234, 0.4)",animation:"wiggle 2s ease-in-out infinite",letterSpacing:"0.05em",transform:"translateZ(10px)"},children:c}),(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",position:"relative",zIndex:1},children:[(0,u.jsxs)("div",{style:{flex:1,transform:"translateZ(5px)"},children:[(0,u.jsx)("h3",{style:{margin:"0 0 12px 0",fontSize:"13px",fontWeight:600,color:"#6c757d",letterSpacing:"0.03em",textTransform:"uppercase"},children:a}),(0,u.jsx)("div",{style:{fontSize:"38px",fontWeight:800,color:"#2c3e50",marginBottom:"8px",lineHeight:1.1,letterSpacing:"-0.02em",background:"linear-gradient(135deg, #2c3e50 0%, ".concat(o," 100%)"),WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"number"===typeof t?t.toLocaleString():t}),i&&(0,u.jsx)("p",{style:{margin:"0 0 12px 0",fontSize:"13px",color:"#adb5bd",fontWeight:500,letterSpacing:"0.01em"},children:i}),s&&r&&(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:"12px",fontSize:"13px",fontWeight:600,color:"up"===s?"#28a745":"down"===s?"#dc3545":"#6c757d",padding:"6px 12px",background:"up"===s?"rgba(40, 167, 69, 0.1)":"down"===s?"rgba(220, 53, 69, 0.1)":"rgba(108, 117, 125, 0.1)",borderRadius:"10px",width:"fit-content",gap:"6px"},children:["up"===s?(0,u.jsx)(T.A,{size:16}):"down"===s?(0,u.jsx)(z.A,{size:16}):(0,u.jsx)(L.A,{size:16}),(0,u.jsx)("span",{children:r})]})]}),(0,u.jsx)("div",{onMouseEnter:e=>{e.currentTarget.style.transform="translateZ(20px) scale(1.2) rotateZ(10deg)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateZ(10px) scale(1) rotateZ(0deg)"},style:{width:"72px",height:"72px",borderRadius:"20px",background:"linear-gradient(135deg, ".concat(o,"15 0%, ").concat(o,"35 100%)"),display:"flex",alignItems:"center",justifyContent:"center",color:o,boxShadow:"0 8px 24px ".concat(o,"30, 0 0 0 1px ").concat(o,"20 inset"),transition:"all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1)",transform:"translateZ(10px)",willChange:"transform",animation:"glow-pulse 3s ease-in-out infinite"},children:(0,u.jsx)("div",{style:{transform:"scale(1.3)"},children:n})})]})]})},re=e=>{let{data:a,title:t,height:i=300}=e;return(0,u.jsxs)("div",{onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-6px) translateZ(12px) rotateX(1deg)",e.currentTarget.style.boxShadow="\n        0 20px 60px rgba(0,0,0,0.18),\n        0 0 0 2px rgba(255,255,255,0.35) inset,\n        0 30px 80px rgba(102, 126, 234, 0.22)\n      "},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0) translateZ(0) rotateX(0deg)",e.currentTarget.style.boxShadow="\n        0 12px 40px rgba(0,0,0,0.12),\n        0 0 0 1px rgba(255,255,255,0.25) inset,\n        0 25px 70px rgba(102, 126, 234, 0.18)\n      "},style:{background:"linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.88) 100%)",backdropFilter:"blur(25px) saturate(180%)",WebkitBackdropFilter:"blur(25px) saturate(180%)",borderRadius:"28px",padding:"32px",boxShadow:"\n      0 12px 40px rgba(0,0,0,0.12),\n      0 0 0 1px rgba(255,255,255,0.25) inset,\n      0 25px 70px rgba(102, 126, 234, 0.18)\n    ",border:"2px solid rgba(255,255,255,0.35)",position:"relative",overflow:"hidden",transition:"all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",transform:"translateZ(0)",transformStyle:"preserve-3d",willChange:"transform, box-shadow"},children:[(0,u.jsx)("div",{style:{position:"absolute",top:"-50%",left:"-50%",width:"200%",height:"200%",background:"linear-gradient(45deg, transparent 30%, rgba(102, 126, 234, 0.08) 50%, transparent 70%)",backgroundSize:"500px 500px",animation:"shimmer 6s linear infinite",pointerEvents:"none"}}),(0,u.jsxs)("h3",{style:{margin:"0 0 20px 0",fontSize:"18px",fontWeight:700,display:"flex",alignItems:"center",gap:"8px",position:"relative",zIndex:1,letterSpacing:"-0.01em"},children:[(0,u.jsx)(P.A,{size:20,style:{color:"#667eea",filter:"drop-shadow(0 2px 8px rgba(102, 126, 234, 0.4))",animation:"glow-pulse 2.5s ease-in-out infinite"}}),(0,u.jsx)("span",{style:{background:"linear-gradient(135deg, #2c3e50 0%, #667eea 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:t})]}),(0,u.jsx)(v.u,{width:"100%",height:i,children:(0,u.jsxs)(j.Q,{data:a,children:[(0,u.jsx)("defs",{children:(0,u.jsxs)("linearGradient",{id:"colorGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,u.jsx)("stop",{offset:"5%",stopColor:"#667eea",stopOpacity:.8}),(0,u.jsx)("stop",{offset:"95%",stopColor:"#667eea",stopOpacity:.1})]})}),(0,u.jsx)(y.W,{dataKey:a&&a.length&&"dia"in a[0]?"dia":"mes"}),(0,u.jsx)(N.h,{}),(0,u.jsx)(C.m,{formatter:e=>[e.toLocaleString(),"Carteles"]}),(0,u.jsx)(w.Gk,{type:"monotone",dataKey:"cantidad",stroke:"#667eea",fillOpacity:1,fill:"url(#colorGradient)"})]})})]})},ne=e=>{let{sector:a,index:t}=e;return(0,u.jsxs)("div",{onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-6px) translateZ(10px) rotateX(3deg) scale(1.02)",e.currentTarget.style.boxShadow=t<3?"0 12px 35px rgba(102, 126, 234, 0.3), 0 0 0 2px rgba(102, 126, 234, 0.4) inset":"0 8px 25px rgba(0,0,0,0.15), 0 0 0 1px rgba(255,255,255,0.3) inset"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0) translateZ(0) rotateX(0deg) scale(1)",e.currentTarget.style.boxShadow=t<3?"0 6px 20px rgba(102, 126, 234, 0.2)":"0 4px 12px rgba(0,0,0,0.08)"},style:{background:t<3?"linear-gradient(135deg, rgba(102, 126, 234, 0.12) 0%, rgba(118, 75, 162, 0.12) 50%, rgba(240, 147, 251, 0.08) 100%)":"linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.88) 100%)",backdropFilter:"blur(15px) saturate(160%)",WebkitBackdropFilter:"blur(15px) saturate(160%)",border:t<3?"2px solid rgba(102, 126, 234, 0.4)":"2px solid rgba(233, 236, 239, 0.6)",borderRadius:"16px",padding:"20px",marginBottom:"14px",transition:"all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1)",boxShadow:t<3?"0 6px 20px rgba(102, 126, 234, 0.2)":"0 4px 12px rgba(0,0,0,0.08)",position:"relative",overflow:"hidden",transform:"translateZ(0)",transformStyle:"preserve-3d",willChange:"transform, box-shadow"},children:[t<3&&(0,u.jsx)("div",{style:{position:"absolute",top:"-50%",left:"-50%",width:"200%",height:"200%",background:"linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.25) 50%, transparent 70%)",backgroundSize:"400px 400px",animation:"shimmer 5s linear infinite",pointerEvents:"none"}}),(0,u.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",position:"relative",zIndex:1},children:(0,u.jsxs)("div",{style:{flex:1},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"14px"},children:[(0,u.jsx)("div",{onMouseEnter:e=>{e.currentTarget.style.transform="scale(1.15) rotateZ(5deg)"},onMouseLeave:e=>{e.currentTarget.style.transform="scale(1) rotateZ(0deg)"},style:{width:"20px",height:"20px",backgroundColor:a.color,borderRadius:"6px",boxShadow:"0 4px 12px ".concat(a.color,"50"),transition:"all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)",willChange:"transform"}}),(0,u.jsx)("span",{style:{fontWeight:700,fontSize:"13px",color:"#2c3e50",letterSpacing:"-0.01em"},children:a.name}),t<3&&(0,u.jsxs)("span",{onMouseEnter:e=>{e.currentTarget.style.transform="scale(1.1) rotateZ(-3deg)"},onMouseLeave:e=>{e.currentTarget.style.transform="scale(1) rotateZ(0deg)"},style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",padding:"4px 10px",borderRadius:"8px",fontSize:"11px",fontWeight:700,boxShadow:"0 4px 12px rgba(102, 126, 234, 0.4)",letterSpacing:"0.03em",transition:"all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)",willChange:"transform",animation:0===t?"pulse 2s ease-in-out infinite":"none"},children:["TOP ",t+1]})]}),"        ",(0,u.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"8px",marginTop:"8px",fontSize:"12px"},children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("span",{style:{color:"#6c757d"},children:"Licitaciones: "}),(0,u.jsx)("span",{style:{fontWeight:600,color:"#28a745"},children:a.count})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("span",{style:{color:"#6c757d"},children:"Porcentaje: "}),(0,u.jsxs)("span",{style:{fontWeight:600,color:"#667eea"},children:[a.value,"%"]})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("span",{style:{color:"#6c757d"},children:"Instituciones: "}),(0,u.jsx)("span",{style:{fontWeight:600,color:"#f39c12"},children:a.instituciones||"N/A"})]})]}),(0,u.jsxs)("div",{style:{marginTop:"8px",fontSize:"11px"},children:[(0,u.jsx)("span",{style:{color:"#6c757d"},children:"Monto Total: "}),(()=>{const e=ae(ee(a.monto_total||0),a.monto_total);return(0,u.jsx)("span",{title:e.title,style:{fontWeight:600,color:"#dc3545"},children:e.text})})(),(0,u.jsx)("span",{style:{color:"#6c757d",marginLeft:"8px"},children:"Promedio: "}),(()=>{const e=ae(ee(a.promedio_monto||0),a.promedio_monto);return(0,u.jsx)("span",{title:e.title,style:{fontWeight:600,color:"#17a2b8"},children:e.text})})()]})]})})]})},oe=e=>{let{alerts:a}=e;return(0,u.jsxs)("div",{onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-6px) translateZ(12px) rotateX(1deg)",e.currentTarget.style.boxShadow="\n        0 20px 60px rgba(0,0,0,0.18),\n        0 0 0 2px rgba(255,255,255,0.35) inset,\n        0 30px 80px rgba(102, 126, 234, 0.22)\n      "},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0) translateZ(0) rotateX(0deg)",e.currentTarget.style.boxShadow="\n        0 12px 40px rgba(0,0,0,0.12),\n        0 0 0 1px rgba(255,255,255,0.25) inset,\n        0 25px 70px rgba(102, 126, 234, 0.18)\n      "},style:{background:"linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.88) 100%)",backdropFilter:"blur(25px) saturate(180%)",WebkitBackdropFilter:"blur(25px) saturate(180%)",borderRadius:"28px",padding:"32px",boxShadow:"\n      0 12px 40px rgba(0,0,0,0.12),\n      0 0 0 1px rgba(255,255,255,0.25) inset,\n      0 25px 70px rgba(102, 126, 234, 0.18)\n    ",border:"2px solid rgba(255,255,255,0.35)",position:"relative",overflow:"hidden",transition:"all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",transform:"translateZ(0)",transformStyle:"preserve-3d",willChange:"transform, box-shadow"},children:[(0,u.jsx)("div",{style:{position:"absolute",top:"-50%",right:"-50%",width:"200%",height:"200%",background:"linear-gradient(45deg, transparent 30%, rgba(255, 193, 7, 0.08) 50%, transparent 70%)",backgroundSize:"500px 500px",animation:"shimmer 7s linear infinite",pointerEvents:"none"}}),(0,u.jsxs)("h3",{style:{margin:"0 0 20px 0",fontSize:"18px",fontWeight:700,display:"flex",alignItems:"center",gap:"8px",position:"relative",zIndex:1,letterSpacing:"-0.01em"},children:[(0,u.jsx)(R.A,{size:20,style:{color:"#f39c12",filter:"drop-shadow(0 2px 8px rgba(243, 156, 18, 0.4))",animation:"glow-pulse 2.5s ease-in-out infinite"}}),(0,u.jsxs)("span",{style:{background:"linear-gradient(135deg, #2c3e50 0%, #f39c12 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:["Alertas Inteligentes (",a.length,")"]})]}),(0,u.jsx)("div",{style:{maxHeight:"320px",overflowY:"auto",position:"relative",zIndex:1},children:a.map(e=>(0,u.jsxs)("div",{onMouseEnter:e=>{e.currentTarget.style.transform="translateX(8px) scale(1.02)",e.currentTarget.style.boxShadow="0 8px 24px rgba(0,0,0,0.15)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateX(0) scale(1)",e.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.08)"},style:{padding:"20px 22px",borderRadius:"16px",marginBottom:"14px",background:"error"===e.type?"linear-gradient(135deg, rgba(220, 53, 69, 0.12) 0%, rgba(220, 53, 69, 0.08) 100%)":"warning"===e.type?"linear-gradient(135deg, rgba(243, 156, 18, 0.12) 0%, rgba(243, 156, 18, 0.08) 100%)":"success"===e.type?"linear-gradient(135deg, rgba(40, 167, 69, 0.12) 0%, rgba(40, 167, 69, 0.08) 100%)":"linear-gradient(135deg, rgba(102, 126, 234, 0.12) 0%, rgba(102, 126, 234, 0.08) 100%)",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",border:"2px solid ".concat("error"===e.type?"rgba(220, 53, 69, 0.3)":"warning"===e.type?"rgba(243, 156, 18, 0.3)":"success"===e.type?"rgba(40, 167, 69, 0.3)":"rgba(102, 126, 234, 0.3)"),boxShadow:"0 4px 12px rgba(0,0,0,0.08)",transition:"all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)",willChange:"transform, box-shadow"},children:[(0,u.jsx)("div",{style:{fontWeight:700,fontSize:"13px",marginBottom:"6px",color:"#2c3e50",letterSpacing:"-0.01em"},children:e.title}),(0,u.jsx)("div",{style:{fontSize:"12px",color:"#495057",marginBottom:"10px",lineHeight:1.5,fontWeight:500},children:e.message}),(0,u.jsx)("div",{style:{fontSize:"12px",color:"#adb5bd",fontWeight:500},children:V()(e.timestamp).fromNow()})]},e.id))})]})},le=()=>{const{error:e,isLoaded:a}=(0,s.M)(),[t,o]=(0,i.useState)([]),[c,d]=(0,i.useState)([]),[p,h]=(0,i.useState)(""),[m,g]=(0,i.useState)({}),[f,j]=(0,i.useState)(!1),[w,T]=(0,i.useState)(!1),[z,P]=(0,i.useState)({}),[R,G]=(0,i.useState)({}),[Z,q]=(0,i.useState)({}),[K,X]=(0,i.useState)({});(0,i.useEffect)(()=>{w&&(q((0,r.A)({},z)),X((0,r.A)({},R)))},[w,z,R]),(0,i.useEffect)(()=>{const e=localStorage.getItem("sicop_custom_category_colors"),a=localStorage.getItem("sicop_custom_subcategory_colors");if(e)try{P(JSON.parse(e))}catch(t){console.error("Error al cargar colores personalizados:",t)}if(a)try{G(JSON.parse(a))}catch(t){console.error("Error al cargar colores de subcategor\xedas:",t)}},[]);const J=(0,i.useMemo)(()=>{var e;return(null===(e=n.M.getDashboardMetrics)||void 0===e?void 0:e.call(n.M,m))||te},[m]),Q=(0,i.useMemo)(()=>{var e;return(null===(e=n.M.getComplementaryDashboard)||void 0===e?void 0:e.call(n.M,m))||ie},[m]),$=(0,i.useMemo)(()=>{var e;return a&&(null===(e=n.M.getAvailableInstitutions)||void 0===e?void 0:e.call(n.M))||[]},[a]),le=(0,i.useMemo)(()=>{var e;return a&&(null===(e=n.M.getAvailableCategories)||void 0===e?void 0:e.call(n.M))||[]},[a]);(0,i.useEffect)(()=>{if(a)try{var e;const a=(null===Q||void 0===Q||null===(e=Q.tta_distribution)||void 0===e?void 0:e.length)||0,t=((null===Q||void 0===Q?void 0:Q.tta_distribution)||[]).reduce((e,a)=>e+(a.carteles||0),0);console.log("[ModernDashboard][TTA] complementData change:",{distLen:a,distribution:null===Q||void 0===Q?void 0:Q.tta_distribution,stats:null===Q||void 0===Q?void 0:Q.tta_stats,sumCarteles:t,filtersApplied:m})}catch(t){console.warn("[ModernDashboard][TTA] Logging error",t)}},[Q,m,a]),(0,i.useEffect)(()=>{const e=e=>{const a=e;console.log("\ud83d\udd04 Configuraci\xf3n de categor\xedas actualizada, forzando rec\xe1lculo de dashboard",a.detail),n.M.invalidarCacheSectores&&(console.log("[ModernDashboard] \ud83d\uddd1\ufe0f Invalidando cach\xe9 de sectores del DataManager..."),n.M.invalidarCacheSectores()),g(e=>(0,r.A)({},e)),console.log("\u2705 Dashboard actualizado con las nuevas categor\xedas")},a=e=>{const a=e;console.log("\ud83d\udd04 Categor\xeda manual actualizada, recalculando dashboard",a.detail),n.M.invalidarCacheSectores&&(console.log("[ModernDashboard] \ud83d\uddd1\ufe0f Invalidando cach\xe9 de sectores del DataManager..."),n.M.invalidarCacheSectores()),g(e=>(0,r.A)({},e));const t=a.detail;var i;null!==t&&void 0!==t&&t.isNew?console.log('\u2705 Nueva categor\xeda "'.concat(null===(i=t.category)||void 0===i?void 0:i.nombre,'" agregada. Dashboard actualizado.')):console.log("\u2705 Categor\xeda actualizada. Dashboard recalculado.")};return window.addEventListener("categoryConfigurationUpdated",e),window.addEventListener("manualCategoriesUpdated",a),()=>{window.removeEventListener("categoryConfigurationUpdated",e),window.removeEventListener("manualCategoriesUpdated",a)}},[]);const ce=(0,i.useMemo)(()=>{const e={"Mantenimiento, reparaci\xf3n y limpieza":"#3498db","Suministros de oficina y papeler\xeda":"#f39c12","Tecnolog\xeda y sistemas":"#9b59b6","Veh\xedculos, transporte y repuestos":"#16a085","Salud, medicina y laboratorio":"#e74c3c","Seguridad y vigilancia":"#8e44ad","Construcci\xf3n y materiales de obra":"#d35400","Alimentos y servicios de catering":"#27ae60","Servicios profesionales y consultor\xeda":"#1abc9c","Educaci\xf3n, cultura y recreaci\xf3n":"#e67e22","Log\xedstica y servicios generales":"#2ecc71","Herramientas industriales y electrodom\xe9sticos":"#c0392b",Otros:"#95a5a6"};return(J.sector_analysis||[]).map(a=>{const t=a.sector.replace("_"," "),i=z[t]||e[a.sector]||"#95a5a6";return{name:t,value:a.percentage,count:a.count,color:i,monto_total:a.total_monto,promedio_monto:a.promedio_monto,instituciones:a.instituciones_unicas}})},[J,z]);(0,i.useMemo)(()=>{const e=(J.sector_analysis||[]).map(e=>e.sector);return Array.from(new Set(e))},[J]);const de=(0,i.useMemo)(()=>{const e=["#82ca9d","#a0d8ef","#f7b267","#f79d84","#c3aed6","#a8e6cf","#ffd3b6","#ffaaa5"],a=J.subcategory_analysis||{},t=m.sector&&m.sector.length?m.sector:Object.keys(a),i={};return t.forEach(e=>{(a[e]||[]).forEach(e=>{i[e.subcategory]=(i[e.subcategory]||0)+(e.count||0)})}),Object.entries(i).sort((e,a)=>a[1]-e[1]).map((a,t)=>{let[i,s]=a;return{name:i,value:s,color:R[i]||e[t%e.length]}})},[J,m,R]),pe=(0,i.useMemo)(()=>{var e;const a=J.kpi_metrics;return{tasaConversion:(a.total_carteles?a.total_contratos/a.total_carteles*100:0).toFixed(1),eficienciaProveedores:(a.total_proveedores?a.total_ofertas/a.total_proveedores*100:0).toFixed(1),competenciaPromedio:(a.total_carteles?a.total_ofertas/a.total_carteles:0).toFixed(1),montoTotalEstimado:ce.reduce((e,a)=>e+a.monto_total,0),sectorMayor:(null===(e=ce[0])||void 0===e?void 0:e.name)||"N/A",proporcionServicios:ce.filter(e=>e.name.toLowerCase().includes("servicio")).reduce((e,a)=>e+a.value,0)}},[ce,J]),he=(0,i.useMemo)(()=>J.tendencias_diarias||[],[J]),me=(0,i.useMemo)(()=>Q.offers_histogram||[],[Q]),xe=(0,i.useMemo)(()=>Q.tta_distribution||[],[Q]),ge=(0,i.useMemo)(()=>Q.tta_stats||{n:0,mediana:0,p90:0},[Q]),ue=(0,i.useMemo)(()=>Q.top_instituciones||[],[Q]),fe=(0,i.useMemo)(()=>Q.top_proveedores||[],[Q]),be=(0,i.useMemo)(()=>Q.hhi_market||{hhi:0,top5Share:0},[Q]),ve=(0,i.useMemo)(()=>{var e,a,t;return[{id:"sector-dominante",type:"info",title:"Sector Dominante Detectado",message:"".concat(null===(e=ce[0])||void 0===e?void 0:e.name," representa el ").concat(null===(a=ce[0])||void 0===a?void 0:a.value,"% de las licitaciones (").concat(null===(t=ce[0])||void 0===t?void 0:t.count.toLocaleString()," procedimientos)"),timestamp:new Date},{id:"tasa-conversion",type:pe.tasaConversion>"100"?"warning":"success",title:"Tasa de Conversi\xf3n",message:"".concat(pe.tasaConversion,"% de conversi\xf3n carteles-contratos. ").concat(parseFloat(pe.tasaConversion)>100?"Algunos procedimientos generan m\xfaltiples contratos":"Ratio normal"),timestamp:V()().subtract(15,"minutes").toDate()},{id:"competencia",type:parseFloat(pe.competenciaPromedio)<5?"warning":"success",title:"Nivel de Competencia",message:"Promedio de ".concat(pe.competenciaPromedio," ofertas por cartel. ").concat(parseFloat(pe.competenciaPromedio)<5?"Competencia limitada":"Competencia saludable"),timestamp:V()().subtract(30,"minutes").toDate()},{id:"monto-total",type:"info",title:"Volumen Financiero",message:"Monto total: \u20a1".concat(((J.monto_total_contratos||0)/1e9).toFixed(1)," mil millones"),timestamp:V()().subtract(1,"hour").toDate()}]},[ce,pe,J]);if(!a)return(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"400px",fontSize:"18px",color:"#6c757d"},children:[(0,u.jsx)(L.A,{className:"animate-spin",size:24,style:{marginRight:"12px"}}),"Cargando dashboard..."]});if(e)return(0,u.jsxs)("div",{style:{background:"#fff5f5",border:"1px solid #feb2b2",borderRadius:"12px",padding:"20px",textAlign:"center"},children:[(0,u.jsx)(F.A,{size:48,color:"#e53e3e",style:{marginBottom:"12px"}}),(0,u.jsx)("h3",{style:{color:"#e53e3e",marginBottom:"8px"},children:"Error al cargar datos"}),(0,u.jsx)("p",{style:{color:"#a0aec0",margin:0},children:e})]});return(0,u.jsxs)(u.Fragment,{children:[(()=>{if(!w)return null;const e=ce.map(e=>e.name),a=de.map(e=>e.name);return(0,u.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",backdropFilter:"blur(8px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,padding:"20px"},onClick:()=>T(!1),children:(0,u.jsxs)("div",{style:{background:"linear-gradient(135deg, rgba(255,255,255,0.98) 0%, rgba(255,255,255,0.95) 100%)",borderRadius:"24px",padding:"32px",maxWidth:"900px",width:"100%",maxHeight:"85vh",overflowY:"auto",boxShadow:"0 20px 60px rgba(0,0,0,0.3)",position:"relative"},onClick:e=>e.stopPropagation(),children:[(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px",paddingBottom:"16px",borderBottom:"2px solid rgba(102, 126, 234, 0.2)"},children:[(0,u.jsxs)("h2",{style:{margin:0,fontSize:"24px",fontWeight:700,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",display:"flex",alignItems:"center",gap:"12px"},children:[(0,u.jsx)(D.A,{size:28}),"Configuraci\xf3n de Colores"]}),(0,u.jsx)("button",{onClick:()=>T(!1),style:{background:"transparent",border:"none",cursor:"pointer",padding:"8px",borderRadius:"8px",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"center"},onMouseEnter:e=>e.currentTarget.style.background="rgba(0,0,0,0.1)",onMouseLeave:e=>e.currentTarget.style.background="transparent",children:(0,u.jsx)(l.A,{size:24,color:"#2c3e50"})})]}),(0,u.jsxs)("div",{style:{marginBottom:"32px"},children:[(0,u.jsxs)("h3",{style:{fontSize:"18px",fontWeight:600,color:"#2c3e50",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:["\ud83d\udcca Categor\xedas (",e.length,")"]}),(0,u.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"12px"},children:e.map(e=>{var a;return(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px",background:"rgba(102, 126, 234, 0.08)",borderRadius:"12px",border:"1px solid rgba(102, 126, 234, 0.2)"},children:[(0,u.jsx)("input",{type:"color",value:Z[e]||(null===(a=ce.find(a=>a.name===e))||void 0===a?void 0:a.color)||"#95a5a6",onChange:a=>q((0,r.A)((0,r.A)({},Z),{},{[e]:a.target.value})),style:{width:"40px",height:"40px",border:"none",borderRadius:"8px",cursor:"pointer"}}),(0,u.jsx)("span",{style:{fontSize:"13px",fontWeight:500,color:"#2c3e50",flex:1},children:e})]},e)})})]}),(0,u.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,u.jsxs)("h3",{style:{fontSize:"18px",fontWeight:600,color:"#2c3e50",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:["\ud83d\udccb Subcategor\xedas (",a.length,")"]}),(0,u.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"10px",maxHeight:"300px",overflowY:"auto",padding:"4px"},children:a.map(e=>{var a;return(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"10px",background:"rgba(40, 167, 69, 0.08)",borderRadius:"10px",border:"1px solid rgba(40, 167, 69, 0.2)"},children:[(0,u.jsx)("input",{type:"color",value:K[e]||(null===(a=de.find(a=>a.name===e))||void 0===a?void 0:a.color)||"#82ca9d",onChange:a=>X((0,r.A)((0,r.A)({},K),{},{[e]:a.target.value})),style:{width:"36px",height:"36px",border:"none",borderRadius:"8px",cursor:"pointer"}}),(0,u.jsx)("span",{style:{fontSize:"12px",fontWeight:500,color:"#2c3e50",flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e})]},e)})})]}),(0,u.jsxs)("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end",paddingTop:"16px",borderTop:"2px solid rgba(102, 126, 234, 0.2)"},children:[(0,u.jsxs)("button",{onClick:()=>{localStorage.removeItem("sicop_custom_category_colors"),localStorage.removeItem("sicop_custom_subcategory_colors"),P({}),G({}),q({}),X({})},style:{padding:"12px 24px",background:"linear-gradient(135deg, #6c757d 0%, #495057 100%)",color:"white",border:"none",borderRadius:"12px",fontWeight:600,cursor:"pointer",transition:"all 0.3s",display:"flex",alignItems:"center",gap:"8px",fontSize:"14px"},onMouseEnter:e=>e.currentTarget.style.transform="scale(1.05)",onMouseLeave:e=>e.currentTarget.style.transform="scale(1)",children:[(0,u.jsx)(I.A,{size:16}),"Resetear"]}),(0,u.jsxs)("button",{onClick:()=>{var e,a;e=Z,a=K,localStorage.setItem("sicop_custom_category_colors",JSON.stringify(e)),localStorage.setItem("sicop_custom_subcategory_colors",JSON.stringify(a)),P(e),G(a),T(!1)},style:{padding:"12px 24px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",borderRadius:"12px",fontWeight:600,cursor:"pointer",transition:"all 0.3s",display:"flex",alignItems:"center",gap:"8px",fontSize:"14px",boxShadow:"0 4px 15px rgba(102, 126, 234, 0.4)"},onMouseEnter:e=>{e.currentTarget.style.transform="scale(1.05)",e.currentTarget.style.boxShadow="0 6px 20px rgba(102, 126, 234, 0.6)"},onMouseLeave:e=>{e.currentTarget.style.transform="scale(1)",e.currentTarget.style.boxShadow="0 4px 15px rgba(102, 126, 234, 0.4)"},children:[(0,u.jsx)(E.A,{size:16}),"Guardar Cambios"]})]})]})})})(),(0,u.jsxs)("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%)",padding:"70px 80px",position:"relative",overflow:"hidden",perspective:"2000px",maxWidth:"1800px",margin:"0 auto"},children:[(0,u.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden",pointerEvents:"none",zIndex:0},children:[...Array(15)].map((e,a)=>(0,u.jsx)("div",{style:{position:"absolute",width:"".concat(100*Math.random()+50,"px"),height:"".concat(100*Math.random()+50,"px"),background:"radial-gradient(circle, rgba(255,255,255,".concat(.3*Math.random()+.1,") 0%, transparent 70%)"),borderRadius:"50%",top:"".concat(100*Math.random(),"%"),left:"".concat(100*Math.random(),"%"),animation:"float".concat(a%3," ").concat(20*Math.random()+15,"s ease-in-out infinite"),filter:"blur(25px)",transform:"rotate(".concat(360*Math.random(),"deg)"),willChange:"transform"}},a))}),(0,u.jsx)("style",{children:"\n        @keyframes float0 {\n          0%, 100% { transform: translate(0, 0) rotate(0deg); opacity: 0.3; }\n          25% { transform: translate(100px, -100px) rotate(90deg); opacity: 0.6; }\n          50% { transform: translate(200px, -50px) rotate(180deg); opacity: 0.4; }\n          75% { transform: translate(100px, 50px) rotate(270deg); opacity: 0.7; }\n        }\n        @keyframes float1 {\n          0%, 100% { transform: translate(0, 0) rotate(360deg); opacity: 0.4; }\n          33% { transform: translate(-150px, 120px) rotate(240deg); opacity: 0.7; }\n          66% { transform: translate(-50px, -100px) rotate(120deg); opacity: 0.5; }\n        }\n        @keyframes float2 {\n          0%, 100% { transform: translate(0, 0) rotate(0deg) scale(1); opacity: 0.3; }\n          50% { transform: translate(120px, 150px) rotate(180deg) scale(1.3); opacity: 0.8; }\n        }\n        @keyframes pulse {\n          0%, 100% { transform: scale(1); opacity: 1; }\n          50% { transform: scale(1.05); opacity: 0.9; }\n        }\n        @keyframes shimmer {\n          0% { background-position: -1000px 0; }\n          100% { background-position: 1000px 0; }\n        }\n        @keyframes wiggle {\n          0%, 100% { transform: rotate(-3deg); }\n          50% { transform: rotate(3deg); }\n        }\n        @keyframes glow-pulse {\n          0%, 100% { filter: drop-shadow(0 0 8px rgba(102, 126, 234, 0.6)); }\n          50% { filter: drop-shadow(0 0 20px rgba(102, 126, 234, 1)); }\n        }\n        @keyframes card-float {\n          0%, 100% { transform: translateY(0px) rotateX(0deg); }\n          50% { transform: translateY(-8px) rotateX(2deg); }\n        }\n      "}),(0,u.jsxs)("div",{style:{background:"linear-gradient(135deg, rgba(255,255,255,0.25) 0%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.2) 100%)",backdropFilter:"blur(25px) saturate(180%)",WebkitBackdropFilter:"blur(25px) saturate(180%)",borderRadius:"28px",padding:"48px 56px",marginBottom:"42px",border:"2px solid rgba(255,255,255,0.3)",boxShadow:"\n          0 8px 32px rgba(0,0,0,0.15),\n          0 0 0 1px rgba(255,255,255,0.1) inset,\n          0 20px 60px rgba(102, 126, 234, 0.2)\n        ",position:"relative",overflow:"hidden",transform:"translateZ(0)",transformStyle:"preserve-3d",willChange:"transform",zIndex:1},children:[(0,u.jsx)("div",{style:{position:"absolute",top:"-50%",left:"-50%",width:"200%",height:"200%",background:"linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.15) 50%, transparent 70%)",backgroundSize:"1000px 1000px",animation:"shimmer 6s linear infinite",pointerEvents:"none"}}),(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",position:"relative",zIndex:1},children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("h1",{style:{margin:"0 0 12px 0",fontSize:"3.2em",fontWeight:800,color:"#ffffff",letterSpacing:"-0.02em",lineHeight:1.1,textShadow:"\n                0 2px 10px rgba(0,0,0,0.3),\n                0 4px 20px rgba(102, 126, 234, 0.4),\n                0 0 40px rgba(102, 126, 234, 0.2)\n              ",transform:"translateZ(20px)",perspective:"1500px",filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.2))"},children:"\ud83c\udfdb\ufe0f SICOP Analytics Pro"}),(0,u.jsxs)("p",{style:{margin:0,color:"#ffffff",fontSize:"1.1em",fontWeight:600,textShadow:"\n                0 2px 8px rgba(0,0,0,0.4),\n                0 1px 3px rgba(0,0,0,0.3)\n              ",letterSpacing:"0.01em",transform:"translateZ(10px)",opacity:.98},children:["An\xe1lisis Avanzado de Contrataci\xf3n P\xfablica \u2022 ",J.kpi_metrics.total_carteles.toLocaleString()," licitaciones \u2022 ",ce.length," sectores"]})]}),(0,u.jsxs)("div",{style:{display:"flex",gap:"16px",alignItems:"center",transform:"translateZ(15px)"},children:[(0,u.jsxs)("button",{onClick:()=>alert("Download functionality moved to separate component"),onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-4px) scale(1.05) rotateY(5deg)",e.currentTarget.style.boxShadow="0 12px 32px rgba(108, 92, 231, 0.4), 0 0 0 3px rgba(255,255,255,0.2)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0) scale(1) rotateY(0deg)",e.currentTarget.style.boxShadow="0 8px 24px rgba(0,0,0,0.2), 0 0 40px rgba(108, 92, 231, 0.3)"},style:{display:"flex",alignItems:"center",gap:"8px",background:"linear-gradient(135deg, #6c5ce7 0%, #a29bfe 50%, #00cec9 100%)",color:"white",border:"none",padding:"10px 18px",borderRadius:"14px",fontWeight:700,fontSize:"13px",cursor:"pointer",boxShadow:"0 8px 24px rgba(0,0,0,0.2), 0 0 40px rgba(108, 92, 231, 0.3)",transition:"all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1)",position:"relative",overflow:"hidden",letterSpacing:"0.02em",willChange:"transform"},title:"Download moved to separate component",children:[(0,u.jsx)("span",{style:{position:"relative",zIndex:1},children:"\ud83d\udcca Info"}),(0,u.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",width:"500px",height:"500px",background:"radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%)",transform:"translate(-50%, -50%) scale(0)",transition:"transform 0.6s ease-out",borderRadius:"50%",pointerEvents:"none"}})]}),(0,u.jsxs)("div",{onMouseEnter:e=>{e.currentTarget.style.transform="scale(1.08) rotateZ(2deg)"},onMouseLeave:e=>{e.currentTarget.style.transform="scale(1) rotateZ(0deg)"},style:{background:"linear-gradient(135deg, #28a745 0%, #20c997 50%, #00b894 100%)",color:"white",padding:"8px 16px",borderRadius:"14px",fontSize:"13px",fontWeight:700,display:"flex",alignItems:"center",gap:"6px",boxShadow:"0 8px 24px rgba(40, 167, 69, 0.3), 0 0 0 1px rgba(255,255,255,0.2) inset",transition:"all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)",animation:"pulse 3s ease-in-out infinite",letterSpacing:"0.03em",willChange:"transform"},children:[(0,u.jsx)(W.A,{size:18,style:{animation:"glow-pulse 2s ease-in-out infinite"}}),"Datos Reales"]})]})]})]}),(0,u.jsx)(b,{institutions:$,categories:le,selectedInstitutions:t,selectedCategories:c,searchKeywords:p,onInstitutionsChange:o,onCategoriesChange:d,onSearchKeywordsChange:h,onApplyFilters:async()=>{j(!0);try{const e=p.trim()?p.split(/\s+/).filter(e=>e.length>0):[];g((0,r.A)((0,r.A)((0,r.A)({},t.length>0?{institucion:t}:{}),c.length>0?{sector:c}:{}),e.length>0?{keywords:e}:{}))}finally{setTimeout(()=>j(!1),500)}},onClearFilters:()=>{o([]),d([]),h(""),g({})},isLoading:f}),(0,u.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(340px, 1fr))",gap:"28px",marginBottom:"48px",perspective:"2000px",transformStyle:"preserve-3d"},children:[(0,u.jsx)(se,{title:"Total Carteles",value:J.kpi_metrics.total_carteles,subtitle:"Procedimientos de licitaci\xf3n",trend:"stable",trendValue:"Datos oficiales SICOP",icon:(0,u.jsx)(B.A,{size:24}),color:"#3498db",badge:"REAL"}),(0,u.jsx)(se,{title:"Contratos Generados",value:J.kpi_metrics.total_contratos,subtitle:"Tasa conversi\xf3n: ".concat(pe.tasaConversion,"%"),trend:parseFloat(pe.tasaConversion)>100?"up":"stable",trendValue:parseFloat(pe.tasaConversion)>100?"M\xfaltiples contratos/cartel":"1:1 ratio",icon:(0,u.jsx)(O.A,{size:24}),color:"#27ae60",badge:"REAL"}),(0,u.jsx)(se,{title:"Proveedores Activos",value:J.kpi_metrics.total_proveedores,subtitle:"Eficiencia: ".concat(pe.eficienciaProveedores,"%"),trend:"up",trendValue:"Base amplia de proveedores",icon:(0,u.jsx)(H.A,{size:24}),color:"#f39c12",badge:"REAL"}),(0,u.jsx)(se,{title:"Ofertas Recibidas",value:J.kpi_metrics.total_ofertas,subtitle:"Promedio: ".concat(pe.competenciaPromedio," ofertas/cartel"),trend:parseFloat(pe.competenciaPromedio)>5?"up":"down",trendValue:parseFloat(pe.competenciaPromedio)>5?"Competencia alta":"Competencia limitada",icon:(0,u.jsx)(Y.A,{size:24}),color:"#9b59b6",badge:"REAL"}),(0,u.jsx)(se,{title:"Monto Total",value:ee(J.monto_total_contratos||0),subtitle:"Miles de millones de colones",trend:"up",trendValue:"Volumen alto de contrataci\xf3n",icon:(0,u.jsx)(U.A,{size:24}),color:"#e74c3c",badge:"REAL"}),(0,u.jsx)(se,{title:"Total L\xedneas",value:J.kpi_metrics.total_lineas,subtitle:"Promedio: ".concat(J.kpi_metrics.promedio_lineas_por_cartel," l\xedneas/cartel"),trend:J.kpi_metrics.promedio_lineas_por_cartel>5?"up":"stable",trendValue:J.kpi_metrics.promedio_lineas_por_cartel>5?"Carteles complejos":"Carteles simples",icon:(0,u.jsx)(B.A,{size:24}),color:"#16a085",badge:"REAL"}),(0,u.jsx)(se,{title:"Sectores Activos",value:ce.length,subtitle:"Dominante: ".concat(pe.sectorMayor),trend:"stable",trendValue:"".concat(pe.proporcionServicios.toFixed(1),"% servicios"),icon:(0,u.jsx)(x.A,{size:24}),color:"#17a2b8",badge:"CALC"})]}),(0,u.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"32px",marginBottom:"36px",perspective:"2000px",transformStyle:"preserve-3d"},children:[(0,u.jsxs)("div",{onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-8px) translateZ(15px) rotateX(2deg)",e.currentTarget.style.boxShadow="\n              0 25px 70px rgba(0,0,0,0.2),\n              0 0 0 2px rgba(255,255,255,0.4) inset,\n              0 35px 100px rgba(102, 126, 234, 0.25)\n            "},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0) translateZ(0) rotateX(0deg)",e.currentTarget.style.boxShadow="\n              0 12px 40px rgba(0,0,0,0.12),\n              0 0 0 1px rgba(255,255,255,0.25) inset,\n              0 25px 70px rgba(102, 126, 234, 0.18)\n            "},style:{background:"linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.88) 100%)",backdropFilter:"blur(25px) saturate(180%)",WebkitBackdropFilter:"blur(25px) saturate(180%)",borderRadius:"28px",padding:"36px",boxShadow:"\n            0 12px 40px rgba(0,0,0,0.12),\n            0 0 0 1px rgba(255,255,255,0.25) inset,\n            0 25px 70px rgba(102, 126, 234, 0.18)\n          ",border:"2px solid rgba(255,255,255,0.35)",position:"relative",overflow:"hidden",transition:"all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",transform:"translateZ(0)",transformStyle:"preserve-3d",willChange:"transform, box-shadow"},children:[(0,u.jsx)("div",{style:{position:"absolute",top:"-50%",right:"-50%",width:"200%",height:"200%",background:"linear-gradient(45deg, transparent 30%, rgba(102, 126, 234, 0.1) 50%, transparent 70%)",backgroundSize:"600px 600px",animation:"shimmer 8s linear infinite",pointerEvents:"none"}}),(0,u.jsxs)("h3",{style:{margin:"0 0 20px 0",fontSize:"18px",fontWeight:700,display:"flex",alignItems:"center",gap:"10px",position:"relative",zIndex:1,letterSpacing:"-0.01em"},children:[(0,u.jsx)("span",{style:{fontSize:"22px",animation:"glow-pulse 2.5s ease-in-out infinite"},children:"\ud83d\udcca"}),(0,u.jsx)("span",{style:{background:"linear-gradient(135deg, #2c3e50 0%, #667eea 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"Distribuci\xf3n por Sectores"}),(0,u.jsx)("span",{style:{background:"linear-gradient(135deg, #28a745 0%, #20c997 100%)",color:"white",padding:"5px 12px",borderRadius:"8px",fontSize:"11px",fontWeight:700,boxShadow:"0 4px 15px rgba(40, 167, 69, 0.3)",letterSpacing:"0.03em",animation:"pulse 2s ease-in-out infinite"},children:"DATOS REALES"}),(0,u.jsx)("button",{onClick:()=>T(!0),onMouseEnter:e=>{e.currentTarget.style.transform="scale(1.1) rotate(90deg)",e.currentTarget.style.boxShadow="0 4px 12px rgba(102, 126, 234, 0.5)"},onMouseLeave:e=>{e.currentTarget.style.transform="scale(1) rotate(0deg)",e.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.1)"},style:{marginLeft:"auto",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",borderRadius:"10px",width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",transition:"all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)",color:"white"},title:"Configurar colores de categor\xedas",children:(0,u.jsx)(D.A,{size:18})})]}),(0,u.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"300px 300px 1fr",gap:"24px",alignItems:"center"},children:[(0,u.jsx)(v.u,{width:"100%",height:280,children:(0,u.jsxs)(k.r,{children:[(0,u.jsx)(S.F,{data:ce,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:2,dataKey:"value",children:ce.map((e,a)=>(0,u.jsx)(M.f,{fill:e.color,onClick:()=>{d([e.name])}},"cell-".concat(a)))}),(0,u.jsx)(C.m,{formatter:(e,a,t)=>["".concat(e,"% (").concat(t.payload.count.toLocaleString()," licitaciones)"),t.payload.name]})]})}),(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{style:{fontSize:13,color:"#6c757d",marginBottom:8},children:m.sector&&m.sector.length?(0,u.jsxs)(u.Fragment,{children:["Subcategor\xedas de: ",(0,u.jsx)("strong",{children:m.sector.join(", ")})]}):(0,u.jsxs)(u.Fragment,{children:["Subcategor\xedas de: ",(0,u.jsx)("strong",{children:"Todos los sectores"})]})}),(0,u.jsx)(v.u,{width:"100%",height:280,children:(0,u.jsxs)(k.r,{children:[(0,u.jsx)(S.F,{data:de,cx:"50%",cy:"50%",innerRadius:50,outerRadius:90,paddingAngle:2,dataKey:"value",children:de.map((e,a)=>(0,u.jsx)(M.f,{fill:e.color},"subcell-".concat(a)))}),(0,u.jsx)(C.m,{formatter:(e,a)=>["".concat(e.toLocaleString()," carteles"),a]})]})})]}),(0,u.jsx)("div",{style:{maxHeight:"280px",overflowY:"auto"},children:ce.map((e,a)=>(0,u.jsx)(ne,{sector:e,index:a},e.name))})]})]}),(0,u.jsx)(oe,{alerts:ve})]}),(0,u.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"32px",marginTop:"36px",perspective:"2000px",transformStyle:"preserve-3d"},children:[(0,u.jsx)(re,{data:he,title:"Tendencias Mensual",height:280}),(0,u.jsxs)("div",{onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-6px) translateZ(12px) rotateX(1deg)",e.currentTarget.style.boxShadow="\n              0 20px 60px rgba(0,0,0,0.18),\n              0 0 0 2px rgba(255,255,255,0.35) inset,\n              0 30px 80px rgba(102, 126, 234, 0.22)\n            "},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0) translateZ(0) rotateX(0deg)",e.currentTarget.style.boxShadow="\n              0 12px 40px rgba(0,0,0,0.12),\n              0 0 0 1px rgba(255,255,255,0.25) inset,\n              0 25px 70px rgba(102, 126, 234, 0.18)\n            "},style:{background:"linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.88) 100%)",backdropFilter:"blur(25px) saturate(180%)",WebkitBackdropFilter:"blur(25px) saturate(180%)",borderRadius:"28px",padding:"32px",boxShadow:"\n            0 12px 40px rgba(0,0,0,0.12),\n            0 0 0 1px rgba(255,255,255,0.25) inset,\n            0 25px 70px rgba(102, 126, 234, 0.18)\n          ",border:"2px solid rgba(255,255,255,0.35)",position:"relative",overflow:"hidden",transition:"all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",transform:"translateZ(0)",transformStyle:"preserve-3d",willChange:"transform, box-shadow"},children:[(0,u.jsx)("div",{style:{position:"absolute",top:"-50%",left:"-50%",width:"200%",height:"200%",background:"linear-gradient(45deg, transparent 30%, rgba(243, 156, 18, 0.08) 50%, transparent 70%)",backgroundSize:"500px 500px",animation:"shimmer 6s linear infinite",pointerEvents:"none"}}),(0,u.jsxs)("h3",{style:{margin:"0 0 24px 0",fontSize:"22px",fontWeight:700,display:"flex",alignItems:"center",gap:"10px",position:"relative",zIndex:1,letterSpacing:"-0.01em"},children:[(0,u.jsx)("span",{style:{fontSize:"26px",animation:"glow-pulse 2.5s ease-in-out infinite"},children:"\u26a1"}),(0,u.jsx)("span",{style:{background:"linear-gradient(135deg, #2c3e50 0%, #f39c12 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"M\xe9tricas de Eficiencia"})]}),(0,u.jsxs)("div",{style:{display:"grid",gap:"18px",position:"relative",zIndex:1},children:[(0,u.jsxs)("div",{onMouseEnter:e=>{e.currentTarget.style.transform="translateX(8px) scale(1.03)",e.currentTarget.style.boxShadow="0 12px 32px rgba(52, 152, 219, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateX(0) scale(1)",e.currentTarget.style.boxShadow="0 6px 20px rgba(52, 152, 219, 0.15)"},style:{padding:"20px 24px",background:"linear-gradient(135deg, rgba(52, 152, 219, 0.15) 0%, rgba(52, 152, 219, 0.08) 100%)",backdropFilter:"blur(10px)",borderRadius:"18px",border:"2px solid rgba(52, 152, 219, 0.3)",boxShadow:"0 6px 20px rgba(52, 152, 219, 0.15)",transition:"all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1)",willChange:"transform, box-shadow"},children:[(0,u.jsx)("div",{style:{fontWeight:700,color:"#2c3e50",fontSize:"12px",marginBottom:"8px",letterSpacing:"0.02em"},children:"Tasa de Conversi\xf3n"}),(0,u.jsxs)("div",{style:{fontSize:"32px",fontWeight:800,color:"#3498db",lineHeight:1,marginBottom:"6px",letterSpacing:"-0.02em"},children:[pe.tasaConversion,"%"]}),(0,u.jsx)("div",{style:{fontSize:"11px",color:"#6c757d",fontWeight:500},children:"Carteles \u2192 Contratos"})]}),(0,u.jsxs)("div",{onMouseEnter:e=>{e.currentTarget.style.transform="translateX(8px) scale(1.03)",e.currentTarget.style.boxShadow="0 12px 32px rgba(39, 174, 96, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateX(0) scale(1)",e.currentTarget.style.boxShadow="0 6px 20px rgba(39, 174, 96, 0.15)"},style:{padding:"20px 24px",background:"linear-gradient(135deg, rgba(39, 174, 96, 0.15) 0%, rgba(39, 174, 96, 0.08) 100%)",backdropFilter:"blur(10px)",borderRadius:"18px",border:"2px solid rgba(39, 174, 96, 0.3)",boxShadow:"0 6px 20px rgba(39, 174, 96, 0.15)",transition:"all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1)",willChange:"transform, box-shadow"},children:[(0,u.jsx)("div",{style:{fontWeight:700,color:"#2c3e50",fontSize:"12px",marginBottom:"8px",letterSpacing:"0.02em"},children:"Competencia Promedio"}),(0,u.jsx)("div",{style:{fontSize:"32px",fontWeight:800,color:"#27ae60",lineHeight:1,marginBottom:"6px",letterSpacing:"-0.02em"},children:pe.competenciaPromedio}),(0,u.jsx)("div",{style:{fontSize:"11px",color:"#6c757d",fontWeight:500},children:"Ofertas por cartel"})]}),(0,u.jsxs)("div",{onMouseEnter:e=>{e.currentTarget.style.transform="translateX(8px) scale(1.03)",e.currentTarget.style.boxShadow="0 12px 32px rgba(243, 156, 18, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateX(0) scale(1)",e.currentTarget.style.boxShadow="0 6px 20px rgba(243, 156, 18, 0.15)"},style:{padding:"20px 24px",background:"linear-gradient(135deg, rgba(243, 156, 18, 0.15) 0%, rgba(243, 156, 18, 0.08) 100%)",backdropFilter:"blur(10px)",borderRadius:"18px",border:"2px solid rgba(243, 156, 18, 0.3)",boxShadow:"0 6px 20px rgba(243, 156, 18, 0.15)",transition:"all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1)",willChange:"transform, box-shadow"},children:[(0,u.jsx)("div",{style:{fontWeight:700,color:"#2c3e50",fontSize:"12px",marginBottom:"8px",letterSpacing:"0.02em"},children:"Participaci\xf3n Proveedores"}),(0,u.jsxs)("div",{style:{fontSize:"32px",fontWeight:800,color:"#f39c12",lineHeight:1,marginBottom:"6px",letterSpacing:"-0.02em"},children:[pe.eficienciaProveedores,"%"]}),(0,u.jsx)("div",{style:{fontSize:"11px",color:"#6c757d",fontWeight:500},children:"Eficiencia del mercado"})]})]})]})]}),(0,u.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"32px",marginTop:"36px",perspective:"2000px",transformStyle:"preserve-3d"},children:[(0,u.jsxs)("div",{onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-6px) translateZ(12px) rotateX(1deg)",e.currentTarget.style.boxShadow="\n              0 20px 60px rgba(0,0,0,0.18),\n              0 0 0 2px rgba(255,255,255,0.35) inset,\n              0 30px 80px rgba(102, 126, 234, 0.22)\n            "},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0) translateZ(0) rotateX(0deg)",e.currentTarget.style.boxShadow="\n              0 12px 40px rgba(0,0,0,0.12),\n              0 0 0 1px rgba(255,255,255,0.25) inset,\n              0 25px 70px rgba(102, 126, 234, 0.18)\n            "},style:{background:"linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.88) 100%)",backdropFilter:"blur(25px) saturate(180%)",WebkitBackdropFilter:"blur(25px) saturate(180%)",borderRadius:"28px",padding:"32px",boxShadow:"\n            0 12px 40px rgba(0,0,0,0.12),\n            0 0 0 1px rgba(255,255,255,0.25) inset,\n            0 25px 70px rgba(102, 126, 234, 0.18)\n          ",border:"2px solid rgba(255,255,255,0.35)",position:"relative",overflow:"hidden",transition:"all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",transform:"translateZ(0)",transformStyle:"preserve-3d",willChange:"transform, box-shadow"},children:[(0,u.jsx)("div",{style:{position:"absolute",top:"-50%",right:"-50%",width:"200%",height:"200%",background:"linear-gradient(45deg, transparent 30%, rgba(23, 162, 184, 0.08) 50%, transparent 70%)",backgroundSize:"600px 600px",animation:"shimmer 7s linear infinite",pointerEvents:"none"}}),(0,u.jsxs)("h3",{style:{margin:"0 0 24px 0",fontSize:"22px",fontWeight:700,position:"relative",zIndex:1,letterSpacing:"-0.01em"},children:[(0,u.jsx)("span",{style:{fontSize:"26px",marginRight:"10px",animation:"glow-pulse 2.5s ease-in-out infinite"},children:"\ud83c\udfe2"}),(0,u.jsx)("span",{style:{background:"linear-gradient(135deg, #2c3e50 0%, #17a2b8 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"Top 10 Instituciones por Monto"})]}),(0,u.jsx)("div",{style:{maxHeight:400,overflowY:"auto",display:"grid",gap:12,position:"relative",zIndex:1},children:ue.map((e,a)=>(0,u.jsxs)("div",{onMouseEnter:e=>{e.currentTarget.style.transform="translateX(10px) scale(1.02)",e.currentTarget.style.boxShadow="0 8px 28px rgba(23, 162, 184, 0.25)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateX(0) scale(1)",e.currentTarget.style.boxShadow="0 4px 16px rgba(0,0,0,0.08)"},style:{display:"grid",gridTemplateColumns:"1fr auto auto",gap:14,alignItems:"center",padding:"14px 18px",borderRadius:14,background:"linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.7) 100%)",backdropFilter:"blur(10px)",border:"2px solid rgba(233, 236, 239, 0.6)",boxShadow:"0 4px 16px rgba(0,0,0,0.08)",transition:"all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)",willChange:"transform, box-shadow"},children:[(0,u.jsxs)("div",{style:{fontWeight:700,color:"#2c3e50",fontSize:"15px",letterSpacing:"-0.01em"},children:[a+1,". ",e.nombre,e.nombre!==e.codigo&&(0,u.jsxs)("span",{style:{marginLeft:10,color:"#999",fontWeight:500,fontSize:"13px"},children:["(",e.codigo,")"]})]}),(0,u.jsxs)("div",{style:{color:"#6c757d",fontWeight:600,fontSize:"13px"},children:[e.carteles.toLocaleString()," carteles"]}),(()=>{const a=ae(ee(e.monto||0),e.monto);return(0,u.jsx)("div",{title:a.title,style:{fontWeight:800,color:"#e74c3c",fontSize:"15px"},children:a.text})})()]},e.codigo))})]}),(0,u.jsxs)("div",{onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-6px) translateZ(12px) rotateX(1deg)",e.currentTarget.style.boxShadow="\n              0 20px 60px rgba(0,0,0,0.18),\n              0 0 0 2px rgba(255,255,255,0.35) inset,\n              0 30px 80px rgba(102, 126, 234, 0.22)\n            "},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0) translateZ(0) rotateX(0deg)",e.currentTarget.style.boxShadow="\n              0 12px 40px rgba(0,0,0,0.12),\n              0 0 0 1px rgba(255,255,255,0.25) inset,\n              0 25px 70px rgba(102, 126, 234, 0.18)\n            "},style:{background:"linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.88) 100%)",backdropFilter:"blur(25px) saturate(180%)",WebkitBackdropFilter:"blur(25px) saturate(180%)",borderRadius:"28px",padding:"32px",boxShadow:"\n            0 12px 40px rgba(0,0,0,0.12),\n            0 0 0 1px rgba(255,255,255,0.25) inset,\n            0 25px 70px rgba(102, 126, 234, 0.18)\n          ",border:"2px solid rgba(255,255,255,0.35)",position:"relative",overflow:"hidden",transition:"all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",transform:"translateZ(0)",transformStyle:"preserve-3d",willChange:"transform, box-shadow"},children:[(0,u.jsx)("div",{style:{position:"absolute",top:"-50%",left:"-50%",width:"200%",height:"200%",background:"linear-gradient(45deg, transparent 30%, rgba(102, 126, 234, 0.08) 50%, transparent 70%)",backgroundSize:"600px 600px",animation:"shimmer 7s linear infinite",pointerEvents:"none"}}),(0,u.jsxs)("h3",{style:{margin:"0 0 24px 0",fontSize:"22px",fontWeight:700,display:"flex",alignItems:"center",gap:"10px",position:"relative",zIndex:1,letterSpacing:"-0.01em"},children:[(0,u.jsx)("span",{style:{fontSize:"26px",animation:"glow-pulse 2.5s ease-in-out infinite"},children:"\ud83d\udc77"}),(0,u.jsx)("span",{style:{background:"linear-gradient(135deg, #2c3e50 0%, #667eea 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"Top 10 Proveedores por Monto"}),(0,u.jsx)("span",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",padding:"6px 12px",borderRadius:"10px",fontSize:"12px",fontWeight:700,boxShadow:"0 4px 15px rgba(102, 126, 234, 0.3)",letterSpacing:"0.03em",animation:"pulse 2.5s ease-in-out infinite"},children:"NUEVO"})]}),(0,u.jsx)("div",{style:{maxHeight:360,overflowY:"auto",display:"grid",gap:8},children:(()=>{const e=fe||[];return 0===e.length?(0,u.jsxs)("div",{style:{padding:"20px",border:"2px dashed #e9ecef",borderRadius:12,textAlign:"center",color:"#6c757d",fontSize:14},children:[(0,u.jsx)("div",{style:{fontSize:16,marginBottom:8},children:"\ud83d\udcca"}),(0,u.jsx)("div",{style:{fontWeight:600,marginBottom:4},children:"Sin datos de proveedores"}),(0,u.jsx)("div",{style:{fontSize:12},children:"Verifique que los datos CSV est\xe9n cargados correctamente"})]}):e.map((e,a)=>{const t=a+1,i=t<=3,s=ae(ee(e.monto||0),e.monto);return(0,u.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr auto auto",gap:12,alignItems:"center",padding:"12px 16px",borderRadius:12,border:i?"2px solid #667eea":"1px solid #e9ecef",background:i?"linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%)":"white",transition:"all 0.2s ease",cursor:"default"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none"},children:[(0,u.jsx)("div",{style:{width:32,height:32,borderRadius:"50%",background:i?"linear-gradient(135deg, #667eea 0%, #764ba2 100%)":"#f8f9fa",color:i?"white":"#6c757d",display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:700},children:t}),(0,u.jsxs)("div",{style:{minWidth:0},children:[(0,u.jsx)("div",{style:{fontWeight:600,color:"#2c3e50",fontSize:14,marginBottom:2,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.nombre}),(0,u.jsxs)("div",{style:{fontSize:11,color:"#6c757d",display:"flex",alignItems:"center",gap:8},children:[(0,u.jsxs)("span",{children:["ID: ",e.cedula]}),e.lineas&&(0,u.jsxs)("span",{children:["\u2022 ",e.lineas," l\xedneas"]})]})]}),i&&(0,u.jsx)("div",{style:{background:1===t?"#ffd700":2===t?"#c0c0c0":"#cd7f32",color:1===t?"#8b6914":2===t?"#4a4a4a":"#5c3e1a",padding:"4px 8px",borderRadius:6,fontSize:10,fontWeight:700,whiteSpace:"nowrap"},children:1===t?"\ud83e\udd47 L\xcdDER":2===t?"\ud83e\udd48 2DO":"\ud83e\udd49 3RO"}),(0,u.jsx)("div",{title:s.title,style:{fontWeight:700,color:i?"#667eea":"#27ae60",fontSize:i?15:14,textAlign:"right",whiteSpace:"nowrap"},children:s.text})]},e.id||e.cedula)})})()}),fe&&fe.length>0&&(0,u.jsx)("div",{style:{marginTop:16,padding:"12px 16px",background:"linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%)",borderRadius:8,border:"1px solid #dee2e6"},children:(0,u.jsxs)("div",{style:{fontSize:11,color:"#6c757d",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:8,textAlign:"center"},children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{style:{fontWeight:600,color:"#495057"},children:ae(ee(fe.reduce((e,a)=>e+(a.monto||0),0)),fe.reduce((e,a)=>e+(a.monto||0),0)).text}),(0,u.jsx)("div",{children:"Total Top 10"})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{style:{fontWeight:600,color:"#495057"},children:fe.reduce((e,a)=>e+(a.lineas||0),0).toLocaleString()}),(0,u.jsx)("div",{children:"L\xedneas Totales"})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{style:{fontWeight:600,color:"#495057"},children:(fe.reduce((e,a)=>e+(a.lineas||0),0)/fe.length).toFixed(1)}),(0,u.jsx)("div",{children:"L\xedneas/Proveedor"})]})]})})]})]}),(0,u.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"24px",marginTop:"24px"},children:[(0,u.jsxs)("div",{style:{background:"white",borderRadius:"16px",padding:"24px",boxShadow:"0 4px 12px rgba(0,0,0,0.05)",border:"1px solid #e9ecef"},children:[(0,u.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600},children:"\ud83d\udce6 Ofertas por cartel (histograma)"}),(0,u.jsx)(v.u,{width:"100%",height:260,children:(0,u.jsxs)(_.E,{data:me,children:[(0,u.jsx)(y.W,{dataKey:"ofertas"}),(0,u.jsx)(N.h,{}),(0,u.jsx)(C.m,{formatter:e=>["".concat(e.toLocaleString()," carteles"),"Cantidad"]}),(0,u.jsx)(A.y,{dataKey:"carteles",fill:"#667eea"})]})}),(0,u.jsx)("div",{style:{marginTop:8,fontSize:12,color:"#6c757d"},children:"Distribuci\xf3n de n\xfamero de oferentes por cartel"})]}),(0,u.jsxs)("div",{style:{background:"white",borderRadius:"16px",padding:"24px",boxShadow:"0 4px 12px rgba(0,0,0,0.05)",border:"1px solid #e9ecef"},children:[(0,u.jsxs)("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,display:"flex",alignItems:"center",gap:8},children:["\u23f1\ufe0f Velocidad de Adjudicaci\xf3n",ge.n>0&&(0,u.jsxs)("span",{style:{background:"#27ae60",color:"white",padding:"2px 8px",borderRadius:6,fontSize:11,fontWeight:600},children:["n=",ge.n]})]}),(()=>{const e=ge.n||0,a={};(xe||[]).forEach(e=>{a[e.rango]=e.carteles});const t=["0-15","16-30","31-60","61-90",">90"].map(t=>({rango:t,valor:a[t]||0,pct:e?100*(a[t]||0)/e:0})),i=t.filter(e=>e.valor>0).length,s=t[0].pct,r=t[1].pct,n=s>=70?"Muy r\xe1pida":s>=50?"R\xe1pida":s>=30?"Media":"Lenta",o=e?i<=2&&s>80?"La gran mayor\xeda de los procesos se adjudican en las primeras dos semanas.":s>60&&r>20?"Predominio de adjudicaciones tempranas con una segunda cola moderada.":i>=4?"Distribuci\xf3n m\xe1s dispersa: revisar cuellos de botella en rangos altos.":"Distribuci\xf3n concentrada en tramos cortos.":"Sin datos de adjudicaci\xf3n firme disponibles.";return(0,u.jsx)(u.Fragment,{children:(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[(0,u.jsx)("div",{style:{display:"flex",height:40,borderRadius:12,overflow:"hidden",border:"1px solid #e9ecef",background:"#f8f9fa"},children:t.map((e,a)=>(0,u.jsx)("div",{style:{flex:e.pct||0,background:0===e.valor?"transparent":["#27ae60","#52be80","#f1c40f","#e67e22","#c0392b"][a],display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,color:0===e.valor?"#adb5bd":"white",fontWeight:600,transition:"flex 0.4s ease"},title:"".concat(e.rango," d\xedas: ").concat(e.valor.toLocaleString()," (").concat(e.pct.toFixed(1),"%)"),children:e.pct>=6?"".concat(e.rango," (").concat(e.pct.toFixed(0),"%)"):e.valor>0?e.rango:""},e.rango))}),(0,u.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(120px,1fr))",gap:12},children:[(0,u.jsxs)("div",{style:{padding:"10px 12px",background:"#f8f9fa",borderRadius:10,border:"1px solid #e9ecef"},children:[(0,u.jsx)("div",{style:{fontSize:11,color:"#6c757d"},children:"Mediana"}),(0,u.jsxs)("div",{style:{fontWeight:700,color:"#2c3e50",fontSize:16},children:[ge.mediana||0," d"]})]}),(0,u.jsxs)("div",{style:{padding:"10px 12px",background:"#f8f9fa",borderRadius:10,border:"1px solid #e9ecef"},children:[(0,u.jsx)("div",{style:{fontSize:11,color:"#6c757d"},children:"P90"}),(0,u.jsxs)("div",{style:{fontWeight:700,color:"#2c3e50",fontSize:16},children:[ge.p90||0," d"]})]}),(0,u.jsxs)("div",{style:{padding:"10px 12px",background:"#f8f9fa",borderRadius:10,border:"1px solid #e9ecef"},children:[(0,u.jsx)("div",{style:{fontSize:11,color:"#6c757d"},children:"\u226415 d\xedas"}),(0,u.jsxs)("div",{style:{fontWeight:700,color:"#27ae60",fontSize:16},children:[s.toFixed(1),"%"]})]}),(0,u.jsxs)("div",{style:{padding:"10px 12px",background:"#f8f9fa",borderRadius:10,border:"1px solid #e9ecef"},children:[(0,u.jsx)("div",{style:{fontSize:11,color:"#6c757d"},children:"Tramos activos"}),(0,u.jsx)("div",{style:{fontWeight:700,color:"#2c3e50",fontSize:16},children:i})]}),(0,u.jsxs)("div",{style:{padding:"10px 12px",background:"linear-gradient(135deg,#27ae6015,#27ae6030)",borderRadius:10,border:"1px solid #27ae60"},children:[(0,u.jsx)("div",{style:{fontSize:11,color:"#2c3e50"},children:"Velocidad"}),(0,u.jsx)("div",{style:{fontWeight:700,color:"#27ae60",fontSize:16},children:n})]})]}),(0,u.jsxs)("div",{style:{fontSize:12,lineHeight:1.5,color:"#495057",background:"#f8f9fa",padding:"12px 14px",borderRadius:10,border:"1px solid #e9ecef"},children:[o,e>0&&" \u2022 P90=".concat(ge.p90," d\xedas \u2022 Concentraci\xf3n ").concat((s+r).toFixed(1),"% en \u226430 d\xedas.")]}),(0,u.jsx)("div",{style:{fontSize:11,color:"#adb5bd"},children:"Distribuci\xf3n construida sobre adjudicaciones firmes v\xe1lidas (excluye casos sin fecha v\xe1lida o tiempo \u22640)."})]})})})(),(0,u.jsxs)("div",{style:{marginTop:16,fontSize:11,color:"#6c757d"},children:["HHI mercado=",(be.hhi||0).toFixed(3)," \u2022 Top5=",(100*be.top5Share).toFixed(1),"%"]})]})]})]})]})};var ce=t(3986),de=t(7628),pe=t(1876),he=t(8766),me=t(1758);const xe={institucion:"",anioDesde:"",anioHasta:"",procedimientos:"",categoria:"",estado:"",searchInst:"",keyword:"",dateRange:{},selectedSectors:[],selectedProviders:[],pinned:[],compareModeActive:!1},ge={layout:"default",filtersPanelCollapsed:!1,selectedKPI:null,drilldownPath:[],timelineVisible:!0,bookmarks:(()=>{try{const e=JSON.parse(localStorage.getItem("sicop-bookmarks")||"[]");return Array.isArray(e)?e.map(e=>({name:String(e.name),filters:e.filters||{},timestamp:new Date(e.timestamp)})):[]}catch(e){return[]}})()},ue=(0,he.v)()((0,me.lt)((0,me.eh)((e,a)=>({filters:xe,view:ge,setInstitucion:t=>{e(e=>({filters:(0,r.A)((0,r.A)({},e.filters),{},{institucion:t}),view:(0,r.A)((0,r.A)({},e.view),{},{drilldownPath:[]})})),a().syncToURL()},setDateRange:t=>{e(e=>({filters:(0,r.A)((0,r.A)({},e.filters),{},{dateRange:t})})),a().syncToURL()},setAnioDesde:t=>{e(e=>({filters:(0,r.A)((0,r.A)({},e.filters),{},{anioDesde:t})})),a().syncToURL()},setAnioHasta:t=>{e(e=>({filters:(0,r.A)((0,r.A)({},e.filters),{},{anioHasta:t})})),a().syncToURL()},setProcedimientos:t=>{e(e=>({filters:(0,r.A)((0,r.A)({},e.filters),{},{procedimientos:t})})),a().syncToURL()},setCategoria:t=>{e(e=>({filters:(0,r.A)((0,r.A)({},e.filters),{},{categoria:t})})),a().syncToURL()},setEstado:t=>{e(e=>({filters:(0,r.A)((0,r.A)({},e.filters),{},{estado:t})})),a().syncToURL()},setSearchInst:a=>{e(e=>({filters:(0,r.A)((0,r.A)({},e.filters),{},{searchInst:a})}))},setKeyword:t=>{e(e=>({filters:(0,r.A)((0,r.A)({},e.filters),{},{keyword:t})})),a().syncToURL()},setSectors:t=>{e(e=>({filters:(0,r.A)((0,r.A)({},e.filters),{},{selectedSectors:t})})),a().syncToURL()},setProviders:t=>{e(e=>({filters:(0,r.A)((0,r.A)({},e.filters),{},{selectedProviders:t})})),a().syncToURL()},clearFilters:()=>{e(e=>({filters:(0,r.A)((0,r.A)({},xe),{},{institucion:e.filters.institucion}),view:(0,r.A)((0,r.A)({},e.view),{},{drilldownPath:[],selectedKPI:null})})),a().syncToURL()},setFiltersPanelCollapsed:a=>{e(e=>({view:(0,r.A)((0,r.A)({},e.view),{},{filtersPanelCollapsed:a})}))},setSelectedKPI:a=>{e(e=>({view:(0,r.A)((0,r.A)({},e.view),{},{selectedKPI:a})}))},pushDrilldown:a=>{e(e=>({view:(0,r.A)((0,r.A)({},e.view),{},{drilldownPath:[...e.view.drilldownPath,a]})}))},popDrilldown:()=>{e(e=>({view:(0,r.A)((0,r.A)({},e.view),{},{drilldownPath:e.view.drilldownPath.slice(0,-1)})}))},clearDrilldown:()=>{e(e=>({view:(0,r.A)((0,r.A)({},e.view),{},{drilldownPath:[]})}))},toggleTimeline:()=>{e(e=>({view:(0,r.A)((0,r.A)({},e.view),{},{timelineVisible:!e.view.timelineVisible})}))},pinSelection:a=>{e(e=>({filters:(0,r.A)((0,r.A)({},e.filters),{},{pinned:[...e.filters.pinned,(0,r.A)((0,r.A)({},a),{},{pinnedAt:new Date})]})}))},removePinned:a=>{e(e=>({filters:(0,r.A)((0,r.A)({},e.filters),{},{pinned:e.filters.pinned.filter((e,t)=>t!==a)})}))},toggleCompareMode:()=>{e(e=>({filters:(0,r.A)((0,r.A)({},e.filters),{},{compareModeActive:!e.filters.compareModeActive})}))},saveBookmark:t=>{const{filters:i}=a(),s={name:t,filters:(0,r.A)({},i),timestamp:new Date};e(e=>({view:(0,r.A)((0,r.A)({},e.view),{},{bookmarks:[...e.view.bookmarks,s]})})),localStorage.setItem("sicop-bookmarks",JSON.stringify(a().view.bookmarks))},loadBookmark:t=>{e(e=>({filters:(0,r.A)((0,r.A)({},e.filters),t.filters),view:(0,r.A)((0,r.A)({},e.view),{},{drilldownPath:[]})})),a().syncToURL()},removeBookmark:t=>{e(e=>({view:(0,r.A)((0,r.A)({},e.view),{},{bookmarks:e.view.bookmarks.filter((e,a)=>a!==t)})})),localStorage.setItem("sicop-bookmarks",JSON.stringify(a().view.bookmarks))},syncFromURL:()=>{const a=new URLSearchParams(window.location.search),t={};a.get("inst")&&(t.institucion=a.get("inst")),a.get("sector")&&(t.selectedSectors=a.get("sector").split(",")),a.get("desde")&&(t.anioDesde=a.get("desde")),a.get("hasta")&&(t.anioHasta=a.get("hasta")),a.get("proc")&&(t.procedimientos=a.get("proc")),a.get("cat")&&(t.categoria=a.get("cat")),a.get("kw")&&(t.keyword=a.get("kw")),e(e=>({filters:(0,r.A)((0,r.A)({},e.filters),t)}))},syncToURL:()=>{const{filters:e}=a(),t=new URLSearchParams;e.institucion&&t.set("inst",e.institucion),e.selectedSectors.length&&t.set("sector",e.selectedSectors.join(",")),e.anioDesde&&t.set("desde",e.anioDesde),e.anioHasta&&t.set("hasta",e.anioHasta),e.procedimientos&&t.set("proc",e.procedimientos),e.categoria&&t.set("cat",e.categoria),e.keyword&&t.set("kw",e.keyword);const i="".concat(window.location.pathname).concat(t.toString()?"?"+t.toString():"");window.history.replaceState({},"",i)}}))));"undefined"!==typeof window&&ue.getState().syncFromURL();const fe=e=>{let{title:a,value:t,format:s,isClickable:r=!1,onClick:n,dataset:o=[],previousValue:l,trend:c,size:d="medium",icon:p,subtitle:h,isSelected:m=!1,loading:x=!1,sparklineData:g=[],comparison:f}=e;const[b,v]=(0,i.useState)(!1),j=(0,i.useMemo)(()=>{if(x)return"\u2014";switch(s){case"currency":return K(t,{compact:!0});case"percentage":return X(t);default:return q(t,{compact:!0})}},[t,s,x]),y=(0,i.useMemo)(()=>t&&o.length?Q(t,o,l):[],[t,o,l,a]),N=(0,i.useMemo)(()=>{return a.toLowerCase().includes("concentraci\xf3n")&&t?(e=t)<1500?{level:"Bajo",color:"#10b981",description:"Mercado diversificado con muchos proveedores"}:e<2500?{level:"Medio",color:"#f59e0b",description:"Concentraci\xf3n moderada en pocos proveedores"}:{level:"Alto",color:"#ef4444",description:"Alta concentraci\xf3n en muy pocos proveedores"}:null;var e},[a,t]),C=(0,i.useMemo)(()=>{if(!c)return null;return(0,u.jsx)("span",{style:{color:{up:"#10b981",down:"#ef4444",stable:"#6b7280"}[c],fontSize:"14px",marginLeft:"4px"},children:{up:"\u2197\ufe0f",down:"\u2198\ufe0f",stable:"\u2192"}[c]})},[c]),w=(0,i.useMemo)(()=>{if(!g.length)return null;const e=Math.max(...g),a=Math.min(...g),t=e-a;if(0===t)return null;const i=g.map((e,i)=>{const s=i/(g.length-1)*40,r=20-(e-a)/t*16;return"".concat(s,",").concat(r)}).join(" ");return(0,u.jsx)("svg",{width:"44",height:"24",className:"kpi-sparkline",children:(0,u.jsx)("polyline",{points:i,fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.6"})})},[g]),k=()=>{r&&n&&n()};return(0,u.jsxs)("div",{className:"kpi-card ".concat(d," ").concat(r?"clickable":""," ").concat(m?"selected":""," ").concat(x?"loading":""),onClick:k,onKeyDown:e=>{!r||"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),k())},tabIndex:r?0:-1,role:r?"button":"article","aria-label":"".concat(a,": ").concat(j).concat(r?". Haga clic para filtrar.":""),onMouseEnter:()=>v(!0),onMouseLeave:()=>v(!1),children:[(0,u.jsxs)("div",{className:"kpi-card__header",children:[(0,u.jsxs)("div",{className:"kpi-card__title-section",children:[p&&(0,u.jsx)("div",{className:"kpi-card__icon",children:p}),(0,u.jsxs)("div",{children:[(0,u.jsx)("h3",{className:"kpi-card__title",children:a}),h&&(0,u.jsx)("p",{className:"kpi-card__subtitle",children:h})]})]}),w&&(0,u.jsx)("div",{className:"kpi-card__sparkline",children:w})]}),(0,u.jsxs)("div",{className:"kpi-card__value-section",children:[(0,u.jsx)("div",{className:"kpi-card__main-value",children:x?(0,u.jsx)("div",{className:"kpi-card__skeleton"}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("span",{className:"kpi-card__value",children:j}),C]})}),N&&(0,u.jsxs)("div",{className:"kpi-card__concentration",children:[(0,u.jsx)("span",{className:"kpi-card__concentration-badge",style:{backgroundColor:N.color},children:N.level}),(0,u.jsx)("span",{className:"kpi-card__concentration-desc",children:N.description})]}),f&&(0,u.jsxs)("div",{className:"kpi-card__comparison",children:[(0,u.jsxs)("span",{className:"kpi-card__comparison-label",children:[f.label,":"]}),(0,u.jsx)("span",{className:"kpi-card__comparison-value",children:q(f.value,{compact:!0,showSign:!0})}),(0,u.jsxs)("span",{className:"kpi-card__comparison-benchmark",children:["vs ",f.benchmark]})]})]}),b&&y.length>0&&(0,u.jsxs)("div",{className:"kpi-card__tooltip",role:"tooltip",children:[(0,u.jsx)("div",{className:"kpi-card__tooltip-content",children:y.map((e,a)=>(0,u.jsxs)("div",{className:"kpi-card__insight ".concat(e.sentiment),children:[(0,u.jsx)("span",{className:"kpi-card__insight-value",children:e.value}),(0,u.jsx)("span",{className:"kpi-card__insight-context",children:e.context})]},a))}),(0,u.jsx)("div",{className:"kpi-card__tooltip-arrow"})]}),r&&(0,u.jsx)("div",{className:"kpi-card__click-indicator","aria-hidden":"true",children:"\ud83d\udc46"})]})};var be=t(2847),ve=t(5400),je=t(4980),ye=t(647);const Ne=e=>{let{data:a=[],title:t,valueFormat:s,height:n=200,showBrush:o=!0,showEvents:l=!1,onRangeChange:c,loading:d=!1}=e;const{filters:p,setDateRange:h}=ue(),m=(0,i.useMemo)(()=>a.map((e,a)=>(0,r.A)((0,r.A)({},e),{},{index:a,formattedDate:J(e.date,{format:"short"}),formattedValue:"currency"===s?K(e.value,{compact:!0}):e.value.toLocaleString("es-CR")})),[a,s]),x=(0,i.useCallback)(e=>{var a,t;if(!e||!m.length)return;const{startIndex:i,endIndex:s}=e,r=new Date(null===(a=m[i])||void 0===a?void 0:a.date),n=new Date(null===(t=m[s])||void 0===t?void 0:t.date);r&&n&&(h({start:r,end:n}),null===c||void 0===c||c(i,s))},[m,h,c]),g=(0,i.useMemo)(()=>l&&a.length?a.filter(e=>e.eventos&&e.eventos.length>0).map(e=>({date:e.date,eventos:e.eventos})):[],[a,l]),f=(0,i.useCallback)(e=>{let{active:a,payload:t,label:i}=e;if(!a||!t||!t.length)return null;const s=t[0].payload,r=s.eventos||[];return(0,u.jsxs)("div",{className:"timeline-tooltip",children:[(0,u.jsx)("div",{className:"timeline-tooltip__header",children:(0,u.jsx)("span",{className:"timeline-tooltip__date",children:J(i,{format:"medium"})})}),(0,u.jsxs)("div",{className:"timeline-tooltip__content",children:[(0,u.jsxs)("div",{className:"timeline-tooltip__value",children:[(0,u.jsx)("span",{className:"timeline-tooltip__label",children:"Valor:"}),(0,u.jsx)("span",{className:"timeline-tooltip__amount",children:s.formattedValue})]}),r.length>0&&(0,u.jsxs)("div",{className:"timeline-tooltip__events",children:[(0,u.jsx)("span",{className:"timeline-tooltip__events-label",children:"Eventos:"}),r.map((e,a)=>(0,u.jsxs)("div",{className:"timeline-tooltip__event",children:[(0,u.jsxs)("span",{className:"timeline-tooltip__event-type",children:[e.tipo,":"]}),(0,u.jsx)("span",{className:"timeline-tooltip__event-desc",children:e.descripcion})]},a))]})]})]})},[]);return d?(0,u.jsxs)("div",{className:"timeline-container loading",children:[(0,u.jsx)("div",{className:"timeline-header",children:(0,u.jsx)("h3",{className:"timeline-title",children:t})}),(0,u.jsx)("div",{className:"timeline-skeleton",style:{height:n}})]}):m.length?(0,u.jsxs)("div",{className:"timeline-container",children:[(0,u.jsxs)("div",{className:"timeline-header",children:[(0,u.jsx)("h3",{className:"timeline-title",children:t}),(0,u.jsx)("div",{className:"timeline-controls",children:(0,u.jsx)("button",{className:"timeline-btn timeline-btn--reset",onClick:()=>h({}),disabled:!p.dateRange.start&&!p.dateRange.end,"aria-label":"Limpiar selecci\xf3n de fechas",children:"\ud83d\udd04 Limpiar"})})]}),(0,u.jsx)("div",{className:"timeline-chart",children:(0,u.jsx)(v.u,{width:"100%",height:n,children:(0,u.jsxs)(be.b,{data:m,margin:{top:20,right:30,left:20,bottom:o?60:20},children:[(0,u.jsx)(y.W,{dataKey:"formattedDate",tick:{fontSize:11},tickLine:!1,axisLine:!1}),(0,u.jsx)(N.h,{tick:{fontSize:11},tickLine:!1,axisLine:!1,tickFormatter:e=>"currency"===s?K(e,{compact:!0}):e.toLocaleString("es-CR",{notation:"compact"})}),g.map((e,a)=>(0,u.jsx)(ve.e,{x:e.date,stroke:"#f59e0b",strokeDasharray:"5 5",strokeOpacity:.6},a)),(0,u.jsx)(je.N,{type:"monotone",dataKey:"value",stroke:"#2c7be5",strokeWidth:2,dot:{fill:"#2c7be5",strokeWidth:0,r:3},activeDot:{r:5,stroke:"#2c7be5",strokeWidth:2,fill:"#fff"},connectNulls:!1}),o&&(0,u.jsx)(ye.v,{dataKey:"formattedDate",height:30,stroke:"#2c7be5",fill:"rgba(44, 123, 229, 0.1)",onChange:x,tickFormatter:(e,a)=>{const t=m[a];return t?J(t.date,{format:"short"}):""}}),(0,u.jsx)(C.m,{content:f,cursor:{stroke:"rgba(44, 123, 229, 0.2)",strokeWidth:1,strokeDasharray:"5 5"}})]})})}),(p.dateRange.start||p.dateRange.end)&&(0,u.jsxs)("div",{className:"timeline-range",children:[(0,u.jsx)("span",{className:"timeline-range__label",children:"Rango seleccionado:"}),(0,u.jsxs)("span",{className:"timeline-range__dates",children:[J(p.dateRange.start)," - ",J(p.dateRange.end)]})]})]}):(0,u.jsxs)("div",{className:"timeline-container empty",children:[(0,u.jsx)("div",{className:"timeline-header",children:(0,u.jsx)("h3",{className:"timeline-title",children:t})}),(0,u.jsx)("div",{className:"timeline-empty",style:{height:n},children:(0,u.jsxs)("div",{className:"timeline-empty__content",children:[(0,u.jsx)("span",{className:"timeline-empty__icon",children:"\ud83d\udcc8"}),(0,u.jsx)("span",{className:"timeline-empty__text",children:"No hay datos temporales para mostrar"})]})})]})};var Ce=t(8366),we=t(3291),ke=t(9957);const Se=e=>{let{isCollapsed:a,onToggle:t}=e;const{isLoaded:r}=(0,s.M)(),o=(0,i.useRef)(null),{filters:l,view:c,setInstitucion:d,setAnioDesde:p,setAnioHasta:h,setProcedimientos:m,setCategoria:x,setEstado:g,setSearchInst:f,setKeyword:b,clearFilters:v,saveBookmark:j,loadBookmark:y,removeBookmark:N}=ue(),[C,w]=(0,i.useState)(""),[k,S]=(0,i.useState)(!1),[M,_]=(0,i.useState)([]),[A,T]=(0,i.useState)(!1),z=(0,Ce.I)(),L=(0,i.useMemo)(()=>{if(!r)return[];try{return n.M.getInstitucionesList()}catch(e){return console.error("\u274c Error obteniendo lista de instituciones:",e),[]}},[r]),P=(0,i.useMemo)(()=>{if(!l.searchInst)return L;const e=l.searchInst.toLowerCase();return L.filter(a=>(a.nombre||"").toLowerCase().includes(e)||(a.siglas||"").toLowerCase().includes(e)||String(a.codigoInstitucion||"").includes(l.searchInst))},[L,l.searchInst]),R=(0,i.useMemo)(()=>{if(!r)return{anios:[],procedimientos:[],categorias:[],estados:[]};try{return n.M.getInstitucionFilters()||{anios:[],procedimientos:[],categorias:[],estados:[]}}catch(e){return console.error("\u274c Error obteniendo filtros disponibles:",e),{anios:[],procedimientos:[],categorias:[],estados:[]}}},[r]),F=(0,i.useMemo)(()=>{const e=new Map;return L.forEach(a=>{null!==a&&void 0!==a&&a.codigoInstitucion&&e.set(a.codigoInstitucion,a)}),e},[L]),D=(0,i.useMemo)(()=>(l.searchInst?P:L).slice(0,6),[l.searchInst,P,L]),I=l.institucion?F.get(l.institucion):void 0,E=(0,i.useMemo)(()=>{const e=[];if(l.institucion){const a=F.get(l.institucion);e.push({keys:["institucion"],label:a?"".concat(a.siglas?"".concat(a.siglas," \xb7 "):"").concat(a.nombre):l.institucion,icon:"\ud83c\udfdb\ufe0f",tone:"primary"})}if(l.anioDesde||l.anioHasta){const a=l.anioDesde&&l.anioHasta?"A\xf1os ".concat(l.anioDesde," \u2013 ").concat(l.anioHasta):l.anioDesde?"Desde ".concat(l.anioDesde):"Hasta ".concat(l.anioHasta);e.push({keys:["anioDesde","anioHasta"],label:a,icon:"\ud83d\uddd3\ufe0f"})}return l.procedimientos&&e.push({keys:["procedimientos"],label:l.procedimientos,icon:"\ud83d\udcc4",tone:"neutral"}),l.categoria&&e.push({keys:["categoria"],label:l.categoria,icon:"\ud83e\udde9",tone:"neutral"}),l.estado&&e.push({keys:["estado"],label:l.estado,icon:"\u26a1",tone:"warning"}),l.keyword&&e.push({keys:["keyword"],label:"\u201c".concat(l.keyword,"\u201d"),icon:"\ud83d\udd0e",tone:"success"}),e},[l,F]),W=P.length,B={hidden:{opacity:0,y:12},visible:{opacity:1,y:0}},O=function(e){return z?{duration:0}:{duration:e,ease:arguments.length>1&&void 0!==arguments[1]?arguments[1]:[.4,0,.2,1]}},H=O(.32,[.22,1,.36,1]),Y=we.N,U=e=>{e.forEach(e=>{switch(e){case"institucion":d(""),f("");break;case"anioDesde":p("");break;case"anioHasta":h("");break;case"procedimientos":m("");break;case"categoria":x("");break;case"estado":g("");break;case"keyword":b("")}})};(0,i.useEffect)(()=>{if(l.keyword&&l.keyword.length>=2){const e=["medicamentos","equipos m\xe9dicos","servicios profesionales","mantenimiento","combustible","papeler\xeda","servicios de limpieza","alimentos","transporte","seguridad","tecnolog\xeda","construcci\xf3n"].filter(e=>e.toLowerCase().includes(l.keyword.toLowerCase()));_(e),T(!0)}else T(!1)},[l.keyword]);const G=()=>{C.trim()&&(j(C.trim()),w(""),S(!1))},V=(0,i.useMemo)(()=>{let e=0;return l.anioDesde&&e++,l.anioHasta&&e++,l.procedimientos&&e++,l.categoria&&e++,l.estado&&e++,l.keyword&&e++,e},[l]);return(0,u.jsxs)("aside",{className:"filters-panel ".concat(a?"collapsed":"expanded"),"aria-label":"Panel de filtros",children:[(0,u.jsxs)("div",{className:"filters-panel__header",children:[(0,u.jsxs)("button",{className:"filters-panel__toggle",onClick:t,"aria-label":a?"Expandir filtros":"Colapsar filtros","aria-expanded":!a,children:[(0,u.jsx)("span",{className:"filters-panel__toggle-icon",children:a?"\u2699\ufe0f":"\u2715"}),!a&&(0,u.jsx)("span",{className:"filters-panel__toggle-text",children:"Filtros"})]}),!a&&V>0&&(0,u.jsx)("div",{className:"filters-panel__badge",children:V})]}),!a&&(0,u.jsxs)("div",{className:"filters-panel__content",children:[(0,u.jsxs)(ke.P.div,{className:"filters-panel__summary",initial:{opacity:0,y:-8},animate:{opacity:1,y:0},transition:O(.35,[.22,1,.36,1]),children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("span",{className:"filters-panel__summary-eyebrow",children:"Panel institucional"}),(0,u.jsx)("h2",{className:"filters-panel__summary-title",children:"Explora instituciones"}),(0,u.jsx)("p",{className:"filters-panel__summary-subtitle",children:"Combina b\xfasquedas sem\xe1nticas con filtros precisos para descubrir oportunidades."})]}),(0,u.jsxs)("div",{className:"filters-panel__summary-metric","aria-live":"polite",children:[(0,u.jsx)("span",{className:"filters-panel__summary-count",children:W}),(0,u.jsx)("span",{className:"filters-panel__summary-label",children:"coincidencias"})]})]}),E.length>0&&(0,u.jsx)(ke.P.div,{className:"filters-panel__active-chips",initial:{opacity:0,y:-6},animate:{opacity:1,y:0},transition:O(.25),role:"list","aria-label":"Filtros activos",children:E.map(e=>{var a;return(0,u.jsxs)("button",{type:"button",className:"filter-chip filter-chip--".concat(null!==(a=e.tone)&&void 0!==a?a:"neutral"),onClick:()=>U(e.keys),children:[e.icon&&(0,u.jsx)("span",{className:"filter-chip__icon","aria-hidden":!0,children:e.icon}),(0,u.jsx)("span",{className:"filter-chip__label",children:e.label}),(0,u.jsx)("span",{className:"filter-chip__remove","aria-hidden":!0,children:"\xd7"}),(0,u.jsxs)("span",{className:"sr-only",children:["Quitar filtro ",e.label]})]},e.keys.join("-"))})}),(0,u.jsx)(Y,{children:I&&(0,u.jsxs)(ke.P.div,{className:"filters-panel__selection-card",initial:{opacity:0,y:-6},animate:{opacity:1,y:0},exit:{opacity:0,y:-6},transition:O(.25),children:[(0,u.jsx)("div",{className:"selection-card__icon","aria-hidden":!0,children:"\ud83c\udfdb\ufe0f"}),(0,u.jsxs)("div",{className:"selection-card__details",children:[(0,u.jsx)("span",{className:"selection-card__label",children:"Instituci\xf3n seleccionada"}),(0,u.jsxs)("strong",{className:"selection-card__name",children:[I.siglas?"".concat(I.siglas," \xb7 "):"",I.nombre]}),(0,u.jsxs)("span",{className:"selection-card__code",children:["C\xf3digo ",l.institucion]})]}),(0,u.jsx)("button",{type:"button",className:"selection-card__clear",onClick:()=>U(["institucion"]),children:"Cambiar"})]})}),D.length>0&&(0,u.jsxs)(ke.P.section,{className:"filter-card filter-card--compact",variants:B,initial:"hidden",animate:"visible",transition:H,children:[(0,u.jsxs)("div",{className:"filter-card__header",children:[(0,u.jsx)("span",{className:"filter-card__eyebrow",children:"Sugerencias r\xe1pidas"}),(0,u.jsx)("h3",{className:"filter-card__title",children:"Instituciones destacadas"}),(0,u.jsx)("p",{className:"filter-card__description",children:"Accede a instituciones frecuentes con un solo toque."})]}),(0,u.jsx)("div",{className:"filters-panel__chips",children:D.map(e=>(0,u.jsx)("button",{type:"button",className:"filter-chip filter-chip--ghost ".concat(l.institucion===e.codigoInstitucion?"filter-chip--active":""),onClick:()=>(e=>{null!==e&&void 0!==e&&e.codigoInstitucion&&(d(e.codigoInstitucion),f(e.siglas||e.nombre||""))})(e),children:(0,u.jsx)("span",{className:"filter-chip__label",children:e.siglas?"".concat(e.siglas):e.nombre})},e.codigoInstitucion))})]}),(0,u.jsxs)(ke.P.section,{className:"filter-group filter-card",variants:B,initial:"hidden",animate:"visible",transition:H,children:[(0,u.jsxs)("div",{className:"filter-card__header",children:[(0,u.jsx)("span",{className:"filter-card__eyebrow",children:"Exploraci\xf3n avanzada"}),(0,u.jsx)("h3",{className:"filter-card__title",children:"Buscar instituci\xf3n"}),(0,u.jsx)("p",{className:"filter-card__description",children:"Escribe para filtrar y luego selecciona la instituci\xf3n espec\xedfica."})]}),(0,u.jsxs)("div",{className:"filter-card__body",children:[(0,u.jsx)("label",{className:"filter-label",htmlFor:"search-inst",children:"B\xfasqueda r\xe1pida"}),(0,u.jsxs)("div",{className:"filter-input-wrapper",children:[(0,u.jsx)("span",{className:"filter-input__icon","aria-hidden":!0,children:"\ud83d\udd0d"}),(0,u.jsx)("input",{id:"search-inst",type:"text",placeholder:"Nombre, siglas o c\xf3digo...",value:l.searchInst,onChange:e=>f(e.target.value),className:"filter-input","aria-describedby":"search-inst-help"})]}),(0,u.jsx)("small",{id:"search-inst-help",className:"filter-help",children:"Busque por nombre, siglas o c\xf3digo de instituci\xf3n"}),(0,u.jsxs)("label",{className:"filter-label filter-label--select",htmlFor:"institucion-select",children:["Resultados (",W,")"]}),(0,u.jsxs)("select",{id:"institucion-select",value:l.institucion,onChange:e=>d(e.target.value),className:"filter-select","aria-label":"Seleccionar instituci\xf3n",children:[(0,u.jsx)("option",{value:"",children:"Seleccione instituci\xf3n\u2026"}),P.map(e=>(0,u.jsx)("option",{value:e.codigoInstitucion,children:e.siglas?"".concat(e.siglas," - ").concat(e.nombre):e.nombre},e.codigoInstitucion))]})]})]}),(0,u.jsxs)(ke.P.section,{className:"filter-group filter-card",variants:B,initial:"hidden",animate:"visible",transition:H,children:[(0,u.jsxs)("div",{className:"filter-card__header",children:[(0,u.jsx)("span",{className:"filter-card__eyebrow",children:"Periodo"}),(0,u.jsx)("h3",{className:"filter-card__title",children:"Rango de a\xf1os"}),(0,u.jsx)("p",{className:"filter-card__description",children:"Limita los resultados al rango temporal relevante."})]}),(0,u.jsx)("div",{className:"filter-card__body",children:(0,u.jsxs)("div",{className:"filter-row",children:[(0,u.jsxs)("div",{className:"filter-col",children:[(0,u.jsx)("label",{htmlFor:"anio-desde",className:"filter-sublabel",children:"Desde"}),(0,u.jsxs)("select",{id:"anio-desde",value:l.anioDesde,onChange:e=>p(e.target.value),className:"filter-select",children:[(0,u.jsx)("option",{value:"",children:"Todos"}),R.anios.map(e=>(0,u.jsx)("option",{value:String(e),children:e},e))]})]}),(0,u.jsxs)("div",{className:"filter-col",children:[(0,u.jsx)("label",{htmlFor:"anio-hasta",className:"filter-sublabel",children:"Hasta"}),(0,u.jsxs)("select",{id:"anio-hasta",value:l.anioHasta,onChange:e=>h(e.target.value),className:"filter-select",children:[(0,u.jsx)("option",{value:"",children:"Todos"}),R.anios.map(e=>(0,u.jsx)("option",{value:String(e),children:e},e))]})]})]})})]}),(0,u.jsxs)(ke.P.section,{className:"filter-group filter-card",variants:B,initial:"hidden",animate:"visible",transition:H,children:[(0,u.jsxs)("div",{className:"filter-card__header",children:[(0,u.jsx)("span",{className:"filter-card__eyebrow",children:"Modalidad"}),(0,u.jsx)("h3",{className:"filter-card__title",children:"Tipo de procedimiento"}),(0,u.jsx)("p",{className:"filter-card__description",children:"Identifica el tipo de proceso de compra que deseas analizar."})]}),(0,u.jsx)("div",{className:"filter-card__body",children:(0,u.jsxs)("select",{id:"procedimientos",value:l.procedimientos,onChange:e=>m(e.target.value),className:"filter-select","aria-label":"Tipo de procedimiento",children:[(0,u.jsx)("option",{value:"",children:"Todos"}),R.procedimientos.map(e=>(0,u.jsx)("option",{value:e,children:e},e))]})})]}),(0,u.jsxs)(ke.P.section,{className:"filter-group filter-card",variants:B,initial:"hidden",animate:"visible",transition:H,children:[(0,u.jsxs)("div",{className:"filter-card__header",children:[(0,u.jsx)("span",{className:"filter-card__eyebrow",children:"Clasificaci\xf3n"}),(0,u.jsx)("h3",{className:"filter-card__title",children:"Categor\xeda"}),(0,u.jsx)("p",{className:"filter-card__description",children:"Centra el an\xe1lisis en categor\xedas estrat\xe9gicas."})]}),(0,u.jsx)("div",{className:"filter-card__body",children:(0,u.jsxs)("select",{id:"categoria",value:l.categoria,onChange:e=>x(e.target.value),className:"filter-select","aria-label":"Categor\xeda",children:[(0,u.jsx)("option",{value:"",children:"Todas"}),R.categorias.map(e=>(0,u.jsx)("option",{value:e,children:e},e))]})})]}),(0,u.jsxs)(ke.P.section,{className:"filter-group filter-card",variants:B,initial:"hidden",animate:"visible",transition:H,children:[(0,u.jsxs)("div",{className:"filter-card__header",children:[(0,u.jsx)("span",{className:"filter-card__eyebrow",children:"Seguimiento"}),(0,u.jsx)("h3",{className:"filter-card__title",children:"Estado"}),(0,u.jsx)("p",{className:"filter-card__description",children:"Filtra por el estado actual del procedimiento o contrato."})]}),(0,u.jsx)("div",{className:"filter-card__body",children:(0,u.jsxs)("select",{id:"estado",value:l.estado,onChange:e=>g(e.target.value),className:"filter-select","aria-label":"Estado",children:[(0,u.jsx)("option",{value:"",children:"Todos"}),R.estados.map(e=>(0,u.jsx)("option",{value:e,children:e},e))]})})]}),(0,u.jsxs)(ke.P.section,{className:"filter-group filter-card",variants:B,initial:"hidden",animate:"visible",transition:H,children:[(0,u.jsxs)("div",{className:"filter-card__header",children:[(0,u.jsx)("span",{className:"filter-card__eyebrow",children:"Descubrimiento sem\xe1ntico"}),(0,u.jsx)("h3",{className:"filter-card__title",children:"B\xfasqueda inteligente"}),(0,u.jsx)("p",{className:"filter-card__description",children:"Encuentra coincidencias por palabras clave dentro de las descripciones."})]}),(0,u.jsx)("div",{className:"filter-card__body",children:(0,u.jsxs)("div",{className:"filter-search-container",children:[(0,u.jsxs)("div",{className:"filter-input-wrapper",children:[(0,u.jsx)("span",{className:"filter-input__icon","aria-hidden":!0,children:"\u2728"}),(0,u.jsx)("input",{id:"keyword-search",ref:o,type:"text",placeholder:"Ej: medicamentos, servicios profesionales...",value:l.keyword,onChange:e=>b(e.target.value),className:"filter-input","aria-describedby":"keyword-help",onFocus:()=>l.keyword.length>=2&&T(!0),onBlur:()=>setTimeout(()=>T(!1),200)})]}),(0,u.jsx)("small",{id:"keyword-help",className:"filter-help",children:"Busque por palabras clave en las descripciones"}),(0,u.jsx)(Y,{children:A&&M.length>0&&(0,u.jsx)(ke.P.div,{className:"filter-suggestions",initial:{opacity:0,y:-6},animate:{opacity:1,y:0},exit:{opacity:0,y:-6},transition:O(.2),children:M.map((e,a)=>(0,u.jsx)("button",{className:"filter-suggestion",onClick:()=>(b(e),void T(!1)),type:"button",children:e},a))})})]})})]}),(0,u.jsx)(ke.P.section,{className:"filter-card filter-card--actions",variants:B,initial:"hidden",animate:"visible",transition:H,children:(0,u.jsxs)("div",{className:"filter-actions",children:[(0,u.jsx)("button",{className:"filter-btn filter-btn--clear",onClick:()=>{v(),d(""),f(""),b("")},disabled:0===V,"aria-label":"Limpiar todos los filtros",children:"\ud83d\uddd1\ufe0f Limpiar filtros"}),(0,u.jsx)("button",{className:"filter-btn filter-btn--bookmark",onClick:()=>S(!k),disabled:!l.institucion,"aria-label":"Guardar filtros como favorito",children:"\u2b50 Guardar"})]})}),(0,u.jsx)(Y,{children:k&&(0,u.jsx)(ke.P.div,{className:"filter-card filter-card--bookmark",initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:O(.25),children:(0,u.jsxs)("div",{className:"filter-bookmark-input",children:[(0,u.jsx)("input",{type:"text",placeholder:"Nombre del favorito...",value:C,onChange:e=>w(e.target.value),className:"filter-input",onKeyDown:e=>"Enter"===e.key&&G(),autoFocus:!0}),(0,u.jsxs)("div",{className:"filter-bookmark-actions",children:[(0,u.jsx)("button",{className:"filter-btn filter-btn--save",onClick:G,disabled:!C.trim(),children:"Guardar"}),(0,u.jsx)("button",{className:"filter-btn filter-btn--cancel",onClick:()=>{S(!1),w("")},children:"Cancelar"})]})]})})}),c.bookmarks.length>0&&(0,u.jsx)(ke.P.section,{className:"filter-card filter-card--bookmark-list",variants:B,initial:"hidden",animate:"visible",transition:H,children:(0,u.jsxs)("div",{className:"filter-bookmarks",children:[(0,u.jsx)("h4",{className:"filter-bookmarks__title",children:"Favoritos guardados"}),(0,u.jsx)("div",{className:"filter-bookmarks__list",children:c.bookmarks.map((e,a)=>(0,u.jsxs)(ke.P.div,{className:"filter-bookmark",initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:z?{duration:0}:{duration:.2,delay:.03*a},children:[(0,u.jsxs)("button",{className:"filter-bookmark__load",onClick:()=>y(e),title:"Aplicar filtros guardados: ".concat(e.name),children:["\ud83d\udccc ",e.name]}),(0,u.jsx)("button",{className:"filter-bookmark__remove",onClick:()=>N(a),"aria-label":"Eliminar favorito ".concat(e.name),children:"\u2715"})]},a))})]})})]})]})},Me=()=>{var e;const a="true"===String(null!==(e={NODE_ENV:"production",PUBLIC_URL:"https://jeyrellt.github.io/SicoApp",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production",REACT_APP_PROFILER:"false",REACT_APP_PWA_ENABLED:"true"}.REACT_APP_SHOW_DEBUG)&&void 0!==e?e:"").toLowerCase(),{instituciones:t,keywordsComunes:r,error:o,isLoaded:l}=(0,s.M)(),c=(0,i.useMemo)(()=>{var e,t,i,s,r;if(!a||!l)return null;const o=n.M,c=e=>{var a;return(null===(a=o.obtenerDatos)||void 0===a?void 0:a.call(o,e))||[]},d=(null===(e=o.getDiagnostics)||void 0===e?void 0:e.call(o))||{},p=c("DetalleCarteles"),h=c("Contratos"),m=c("LineasAdjudicadas"),x=c("Proveedores"),g=new Set(p.map(e=>e.numeroCartel)),u=e=>String(null!==e&&void 0!==e?e:"").trim().replace(/\D+/g,""),f=e=>{var a,t;return"number"===typeof e&&isFinite(e)?e:null!=e&&null!==(a=null===(t=o.parseNumeroFlexible)||void 0===t?void 0:t.call(o,String(e)))&&void 0!==a?a:0},b=(e,a)=>{for(const t of a)if(e&&null!=e[t]){const a=f(e[t]);if(null!=a&&isFinite(a)&&0!==a)return a}return null},v=e=>{if(!e)return 0;const a=b(e,["montoLineaAdjudicada","monto_linea_adjudicada"]);if(null!=a&&a>0)return a;let t=(b(e,["precioUnitarioAdjudicado","precio_unitario_adjudicado","precioAdjudicado","precio_adjudicado","precioUnitario","precio_unitario","precio"])||0||0)*(b(e,["cantidadAdjudicada","cantidad_adjudicada","cantidadContratada","cantidad_contratada","cantidad"])||0||0);t=t-f(null===e||void 0===e?void 0:e.descuento)+f(null===e||void 0===e?void 0:e.iva)+f(null===e||void 0===e?void 0:e.otros_impuestos)+f(null===e||void 0===e?void 0:e.acarreos);if("USD"===((null===e||void 0===e?void 0:e.tipoMoneda)||(null===e||void 0===e?void 0:e.tipo_moneda)||"").toString().toUpperCase()){const a=f(null===e||void 0===e?void 0:e.tipo_cambio_crc);a>0&&(t*=a)}return t>0&&isFinite(t)?t:0},j=m.filter(e=>g.has(e.numeroCartel)),y=new Set(j.map(e=>u(e.idProveedorAdjudicado||e.idProveedor)).filter(Boolean)),N=new Map;j.forEach(e=>{const a=u(e.idProveedorAdjudicado||e.idProveedor);if(!a)return;const t=v(e);N.set(a,(N.get(a)||0)+t)});const C=Array.from(N.entries()).filter(e=>{let[,a]=e;return(a||0)>0}).map(e=>{let[a]=e;return a}),w=(null===(t=o.getComplementaryDashboard)||void 0===t||null===(i=t.call(o,{}))||void 0===i?void 0:i.top_proveedores)||[],k=e=>String(null!==e&&void 0!==e?e:"").replace(/\D+/g,""),S=e=>e.replace(/^0+/,""),M=x,_=new Map(M.map(e=>{var a;return[String(null!==(a=e.idProveedor)&&void 0!==a?a:"").trim(),e]})),A=new Map(M.map(e=>[k(e.idProveedor),e])),T=new Map(M.map(e=>[S(k(e.idProveedor)),e])),z=e=>((null===e||void 0===e?void 0:e.nombreProveedor)||(null===e||void 0===e?void 0:e.razonSocial)||(null===e||void 0===e?void 0:e.nombre)||"").toString().trim(),L=(w||[]).slice(0,10).map(e=>{const a=(e=>{const a=_.get(String(e).trim()),t=A.get(k(e)),i=T.get(S(k(e)));return{exact:a?{id:a.idProveedor,nombre:z(a)}:null,digits:t?{id:t.idProveedor,nombre:z(t)}:null,nozeros:i?{id:i.idProveedor,nombre:z(i)}:null}})(e.id);return{id:e.id,dmNombre:e.nombre,exact:a.exact,digits:a.digits,nozeros:a.nozeros}}),P=L.reduce((e,a)=>(a.exact&&a.exact.nombre&&(e.exact+=1),a.digits&&a.digits.nombre&&(e.digits+=1),a.nozeros&&a.nozeros.nombre&&(e.nozeros+=1),e),{exact:0,digits:0,nozeros:0}),R=j.slice(0,3).map(e=>({nro:e.numeroCartel,idProv:u(e.idProveedorAdjudicado||e.idProveedor),montoLineaAdjudicada:e.montoLineaAdjudicada,precioUnitarioAdjudicado:e.precioUnitarioAdjudicado,cantidadAdjudicada:e.cantidadAdjudicada,tipoMoneda:e.tipoMoneda||e.tipo_moneda,tipo_cambio_crc:e.tipo_cambio_crc,computedCRC:v(e)})),F=(null===d||void 0===d||null===(s=d.headerStats)||void 0===s?void 0:s.LineasAdjudicadas)||{},D=(null===d||void 0===d||null===(r=d.headerStats)||void 0===r?void 0:r.Proveedores)||{};return{rowCounts:(null===d||void 0===d?void 0:d.rowCounts)||{},topFromDM:w,provCount:x.length,cartelesCount:p.length,contratosCount:h.length,laCount:m.length,laWithinCarteles:j.length,uniqueProvInLA:y.size,provWithPositiveMonto:C.length,sampleLA:R,headerStatsLA:{rawHeaders:(F.rawHeaders||[]).slice(0,12),explicitMapped:(F.explicitMapped||[]).slice(0,12),autoNormalized:(F.autoNormalized||[]).slice(0,12)},sampleProvs:x.slice(0,3).map(e=>({id:u(e.idProveedor),nombre:e.nombreProveedor})),headerStatsProveedores:{rawHeaders:(D.rawHeaders||[]).slice(0,12),explicitMapped:(D.explicitMapped||[]).slice(0,12),autoNormalized:(D.autoNormalized||[]).slice(0,12)},topResolver:L,resolverStats:P}},[l,a]);return a?(0,u.jsxs)("div",{style:{position:"fixed",top:"10px",right:"10px",width:"300px",background:"white",border:"2px solid #ff0000",borderRadius:"8px",padding:"16px",maxHeight:"85vh",overflowY:"auto",boxSizing:"border-box",zIndex:1e3,fontSize:"12px",fontFamily:"monospace"},children:[(0,u.jsx)("h3",{children:"DEBUG PANEL"}),(0,u.jsxs)("div",{children:[(0,u.jsx)("strong",{children:"isLoaded:"})," ",l?"YES":"NO"]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("strong",{children:"error:"})," ",o||"none"]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("strong",{children:"instituciones:"})," ",(null===t||void 0===t?void 0:t.length)||0]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("strong",{children:"keywords:"})," ",(null===r||void 0===r?void 0:r.length)||0]}),l&&c&&(0,u.jsxs)("div",{style:{marginTop:"10px"},children:[(0,u.jsx)("strong",{children:"Proveedor Debug:"}),(0,u.jsxs)("div",{children:["Proveedores: ",c.provCount.toLocaleString()," \u2022 Carteles: ",c.cartelesCount.toLocaleString()," \u2022 Contratos: ",c.contratosCount.toLocaleString()," \u2022 L.Adjudicadas: ",c.laCount.toLocaleString()]}),(0,u.jsxs)("div",{children:["LA dentro de carteles: ",c.laWithinCarteles.toLocaleString()," \u2022 Proveedores en LA: ",c.uniqueProvInLA.toLocaleString()," \u2022 Con monto>0: ",c.provWithPositiveMonto.toLocaleString()]}),(0,u.jsxs)("div",{children:["Top proveedores (DataManager): ",c.topFromDM.length]}),c.topFromDM.length>0&&(0,u.jsx)("pre",{style:{fontSize:"10px",background:"#f0f0f0",padding:"4px"},children:JSON.stringify(c.topFromDM.slice(0,5),null,2)}),(0,u.jsx)("div",{style:{marginTop:6},children:(0,u.jsx)("strong",{children:"Resolver Proveedor (Top 10):"})}),(0,u.jsxs)("div",{children:["Matches \u2192 exact: ",c.resolverStats.exact," \u2022 digits: ",c.resolverStats.digits," \u2022 nozeros: ",c.resolverStats.nozeros]}),(0,u.jsx)("pre",{style:{fontSize:"10px",background:"#f0f0f0",padding:"4px"},children:JSON.stringify(c.topResolver,null,2)}),(0,u.jsx)("div",{style:{marginTop:6},children:(0,u.jsx)("strong",{children:"Headers LA (muestra):"})}),(0,u.jsx)("pre",{style:{fontSize:"10px",background:"#f0f0f0",padding:"4px"},children:JSON.stringify(c.headerStatsLA,null,2)}),(0,u.jsx)("div",{style:{marginTop:6},children:(0,u.jsx)("strong",{children:"Headers Proveedores (muestra):"})}),(0,u.jsx)("pre",{style:{fontSize:"10px",background:"#f0f0f0",padding:"4px"},children:JSON.stringify(c.headerStatsProveedores,null,2)}),(0,u.jsx)("div",{style:{marginTop:6},children:(0,u.jsx)("strong",{children:"L.Adjudicadas (c\xe1lculo por l\xednea):"})}),(0,u.jsx)("pre",{style:{fontSize:"10px",background:"#f0f0f0",padding:"4px"},children:JSON.stringify(c.sampleLA,null,2)}),(0,u.jsx)("div",{style:{marginTop:6},children:(0,u.jsx)("strong",{children:"Proveedores (muestra):"})}),(0,u.jsx)("pre",{style:{fontSize:"10px",background:"#f0f0f0",padding:"4px"},children:JSON.stringify(c.sampleProvs,null,2)})]}),t&&t.length>0&&(0,u.jsxs)("div",{style:{marginTop:"10px"},children:[(0,u.jsx)("strong",{children:"Primera instituci\xf3n:"}),(0,u.jsx)("pre",{style:{fontSize:"10px",background:"#f0f0f0",padding:"4px"},children:JSON.stringify(t[0],null,2)})]}),r&&r.length>0&&(0,u.jsxs)("div",{style:{marginTop:"10px"},children:[(0,u.jsx)("strong",{children:"Primeras keywords:"}),(0,u.jsx)("div",{children:r.slice(0,5).join(", ")})]})]}):null};function _e(e){let{data:a,columns:t,height:s=420,rowHeight:n=40,overscan:o=6,onRowClick:l,emptyMessage:c="Sin registros",ariaLabel:d="Tabla de datos",resizable:p=!1}=e;const h=(0,i.useRef)(null),m=a.length,[x,g]=(0,i.useState)(0),[f,b]=(0,i.useState)(()=>{const e={};return t.forEach(a=>{e[String(a.key)]=a.width||160}),e}),v=(0,i.useRef)(null),j=(0,i.useCallback)(e=>{if(!v.current)return;const a=e.clientX-v.current.startX;b(e=>(0,r.A)((0,r.A)({},e),{},{[v.current.key]:Math.max(60,v.current.startWidth+a)}))},[]),y=(0,i.useCallback)(()=>{v.current=null,document.removeEventListener("mousemove",j),document.removeEventListener("mouseup",y)},[j]),N=(0,i.useCallback)(()=>{h.current&&g(h.current.scrollTop)},[]),C=Math.max(0,Math.floor(x/n)-o),w=Math.min(m,Math.ceil((x+s)/n)+o),k=a.slice(C,w),S=t.reduce((e,a)=>e+(f[String(a.key)]||a.width||160),0),M=(0,i.useCallback)((e,a)=>{const s=C+a;return(0,u.jsx)("div",{role:"row","aria-rowindex":s+1,className:"vt-row ".concat(s%2===0?"even":"odd"),style:{position:"absolute",top:s*n,height:n,width:S},onClick:()=>l&&l(e),tabIndex:0,children:t.map(a=>{let t=a.cell?a.cell(e):e[a.key];return null!=t&&""!==t||(t="\u2014"),t instanceof Date?t="".concat(t.getUTCFullYear(),"-").concat(String(t.getUTCMonth()+1).padStart(2,"0"),"-").concat(String(t.getUTCDate()).padStart(2,"0")):"object"!==typeof t||i.isValidElement(t)||(t=String(t)),(0,u.jsx)("div",{role:"cell",className:"vt-cell",style:{width:f[String(a.key)]||a.width||160,textAlign:a.align||"left"},children:t},String(a.key))})},s)},[t,l,n,C,S,f]);return 0===m?(0,u.jsx)("div",{className:"vt-empty","aria-label":"Tabla vac\xeda",children:c}):(0,u.jsx)("div",{className:"vt-scroll-outer",children:(0,u.jsxs)("div",{className:"vt-wrapper",role:"table","aria-label":d,style:{width:S},children:[(0,u.jsx)("div",{className:"vt-header",role:"rowgroup",children:(0,u.jsx)("div",{className:"vt-row vt-row--header",role:"row",style:{width:S},children:t.map(e=>{const a=String(e.key),t=f[a]||e.width||160;return(0,u.jsxs)("div",{role:"columnheader",className:"vt-cell vt-cell--header",style:{width:t,position:"relative"},children:[e.header,p&&(0,u.jsx)("span",{className:"vt-resize-handle",onMouseDown:e=>((e,a)=>{p&&(a.preventDefault(),a.stopPropagation(),v.current={key:e,startX:a.clientX,startWidth:f[e]},document.addEventListener("mousemove",j),document.addEventListener("mouseup",y))})(a,e),role:"separator","aria-orientation":"vertical","aria-label":"Redimensionar columna ".concat(e.header)})]},a)})})}),(0,u.jsx)("div",{className:"vt-body",role:"rowgroup",ref:h,onScroll:N,style:{height:s,position:"relative",overflowY:"auto",overflowX:"hidden"},children:(0,u.jsx)("div",{style:{height:m*n,position:"relative",width:S},children:k.map((e,a)=>M(e,a))})})]})})}const Ae=i.memo(_e,(e,a)=>e.data===a.data&&e.columns===a.columns&&e.height===a.height&&e.rowHeight===a.rowHeight&&e.onRowClick===a.onRowClick),Te=e=>{var a,t;let{keywords:s,max:n=200}=e;const[o,l]=(0,i.useState)(null),c=(0,i.useMemo)(()=>(s||[]).slice(0,n),[s,n]),d=c.length?Math.max(...c.map(e=>e.frecuencia||0)):1,p=c.length?c.reduce((e,a)=>e+(a.frecuencia||0),0)/c.length:0,h=2.2*p,m=.6*p,x=c.map(e=>{const a=e.frecuencia||0;let t;return t=a>=h?"dominante":a>=p?"clave":a>=m?"emergente":"nicho",(0,r.A)((0,r.A)({},e),{},{categoria:t})}),g={dominante:[],clave:[],emergente:[],nicho:[]};x.forEach(e=>g[e.categoria].push(e)),Object.keys(g).forEach(e=>g[e]=g[e].sort((e,a)=>a.frecuencia-e.frecuencia));const f=x.slice(0,80);return(0,u.jsxs)("div",{className:"akp",children:[(0,u.jsxs)("div",{className:"akp__legend",children:[(0,u.jsx)("span",{className:"akp__badge dom",children:"Dominantes"}),(0,u.jsx)("span",{className:"akp__badge cla",children:"Claves"}),(0,u.jsx)("span",{className:"akp__badge eme",children:"Emergentes"}),(0,u.jsx)("span",{className:"akp__badge nic",children:"Nicho"})]}),(0,u.jsx)("div",{className:"akp__cloud","aria-label":"Nube de palabras clave with semantic scaling",children:f.map(e=>{const a=.6+e.frecuencia/d*.9;return(0,u.jsx)("button",{className:"akp__word cat-".concat(e.categoria," ").concat(o===e.palabra?"focused":""),style:{fontSize:"".concat(Math.min(1.5,a).toFixed(2),"rem"),opacity:.45+e.frecuencia/d*.55},title:"".concat(e.palabra," \u2022 Frecuencia: ").concat(e.frecuencia," (").concat(e.categoria,")"),onClick:()=>l(o===e.palabra?null:e.palabra),children:e.palabra},e.palabra)})}),o&&(0,u.jsxs)("div",{className:"akp__detail",role:"dialog","aria-label":"Detalle palabra clave",children:[(0,u.jsx)("h4",{children:o}),(0,u.jsxs)("p",{children:["Frecuencia: ",q((null===(a=x.find(e=>e.palabra===o))||void 0===a?void 0:a.frecuencia)||0)]}),(0,u.jsxs)("p",{children:["Categor\xeda: ",null===(t=x.find(e=>e.palabra===o))||void 0===t?void 0:t.categoria]}),(0,u.jsx)("button",{className:"akp__close",onClick:()=>l(null),children:"Cerrar"})]}),(0,u.jsx)("div",{className:"akp__groups",children:["dominante","clave","emergente","nicho"].map(e=>(0,u.jsxs)("div",{className:"akp__group",children:[(0,u.jsxs)("div",{className:"akp__group-title",children:[e.charAt(0).toUpperCase()+e.slice(1)," (",g[e].length,")"]}),(0,u.jsx)("div",{className:"akp__chips",children:g[e].slice(0,12).map(a=>(0,u.jsx)("span",{className:"akp__chip cat-".concat(e),children:a.palabra},a.palabra))})]},e))})]})},ze=["title","children","className"],Le=e=>{if(!e)return"\u2014";if(e instanceof Date)return"".concat(e.getUTCFullYear(),"-").concat(String(e.getUTCMonth()+1).padStart(2,"0"),"-").concat(String(e.getUTCDate()).padStart(2,"0"));const a=new Date(e);return isNaN(+a)?String(e):"".concat(a.getUTCFullYear(),"-").concat(String(a.getUTCMonth()+1).padStart(2,"0"),"-").concat(String(a.getUTCDate()).padStart(2,"0"))},Pe=e=>{let{title:a,children:t,className:i=""}=e,s=(0,ce.A)(e,ze);return(0,u.jsxs)("div",(0,r.A)((0,r.A)({onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-6px) translateZ(12px) rotateX(1deg)",e.currentTarget.style.boxShadow="\n        0 20px 60px rgba(0,0,0,0.18),\n        0 0 0 2px rgba(255,255,255,0.35) inset,\n        0 30px 80px rgba(102, 126, 234, 0.22)\n      "},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0) translateZ(0) rotateX(0deg)",e.currentTarget.style.boxShadow="\n        0 12px 40px rgba(0,0,0,0.12),\n        0 0 0 1px rgba(255,255,255,0.25) inset,\n        0 25px 70px rgba(102, 126, 234, 0.18)\n      "},className:"inst-card ".concat(i),style:{background:"linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.88) 100%)",backdropFilter:"blur(25px) saturate(180%)",WebkitBackdropFilter:"blur(25px) saturate(180%)",borderRadius:"28px",padding:"32px",boxShadow:"\n        0 12px 40px rgba(0,0,0,0.12),\n        0 0 0 1px rgba(255,255,255,0.25) inset,\n        0 25px 70px rgba(102, 126, 234, 0.18)\n      ",border:"2px solid rgba(255,255,255,0.35)",position:"relative",overflow:"hidden",transition:"all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)",transform:"translateZ(0)",transformStyle:"preserve-3d",willChange:"transform, box-shadow"}},s),{},{children:[(0,u.jsx)("div",{style:{position:"absolute",top:"-50%",left:"-50%",width:"200%",height:"200%",background:"linear-gradient(45deg, transparent 30%, rgba(102, 126, 234, 0.08) 50%, transparent 70%)",backgroundSize:"500px 500px",animation:"shimmer 6s linear infinite",pointerEvents:"none"}}),(0,u.jsx)("h3",{className:"inst-card__title",style:{position:"relative",zIndex:1,fontSize:"22px",fontWeight:700,letterSpacing:"-0.01em",marginBottom:"24px",background:"linear-gradient(135deg, #2c3e50 0%, #667eea 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:a}),(0,u.jsx)("div",{style:{position:"relative",zIndex:1},children:t})]}))},Re=()=>{var e,a,t,o,l,c,d,p;const{isLoaded:h}=(0,s.M)(),{filters:m,view:x,setFiltersPanelCollapsed:g,setSelectedKPI:f,clearFilters:b}=ue();(0,i.useEffect)(()=>{ue.getState().syncFromURL()},[]),(0,i.useMemo)(()=>{if(!h)return[];try{return n.M.getInstitucionesList()}catch(e){return console.error("\u274c Error obteniendo lista de instituciones:",e),[]}},[h]);const j=(0,i.useMemo)(()=>{const e=m.anioDesde?new Date("".concat(m.anioDesde,"-01-01T00:00:00Z")):void 0,a=m.anioHasta?new Date("".concat(m.anioHasta,"-12-31T00:00:00Z")):void 0;return{institucion:m.institucion,fechaDesde:e,fechaHasta:a,procedimientos:m.procedimientos?m.procedimientos.split(",").map(e=>e.trim()).filter(Boolean):void 0,categorias:m.categoria?[m.categoria]:void 0,estados:m.estado?[m.estado]:void 0}},[m.institucion,m.anioDesde,m.anioHasta,m.procedimientos,m.categoria,m.estado]),w=(0,i.useMemo)(()=>{if(!m.institucion||!h)return null;try{console.log("\ud83d\udd0d InstitucionesDashboard: Calling getInstitucionDashboard with params:",j);const t=n.M.getInstitucionDashboard(j);var e,a;if(console.log("\ud83d\udcca InstitucionesDashboard: getInstitucionDashboard result:",t),t)console.log("\ud83d\udcb0 KPIs:",t.kpis),console.log("\ud83d\udc77 Proveedores sample:",null===(e=t.proveedores)||void 0===e||null===(a=e.top_por_monto)||void 0===a?void 0:a.slice(0,3)),console.log("\ud83d\udcc8 Procesos:",t.procesos);return t}catch(t){return console.error("\u274c InstitucionesDashboard: Error calling getInstitucionDashboard:",t),null}},[m.institucion,j,h]),[T,z]=(0,i.useState)(()=>new Set),[L,P]=(0,i.useState)(()=>new Set),R=(0,i.useCallback)(e=>{z(a=>{const t=new Set(a);return t.has(e)?t.delete(e):t.add(e),t})},[]),F=(0,i.useCallback)(e=>{P(a=>{const t=new Set(a);return t.has(e)?t.delete(e):t.add(e),t})},[]),D=(0,i.useMemo)(()=>{var e;return(null===w||void 0===w||null===(e=w.sectores)||void 0===e?void 0:e.sector_analysis)||[]},[w]),I=(0,i.useMemo)(()=>{if(!D.length)return[];const e=D.reduce((e,a)=>e+(a.count||0),0);return D.map((a,t)=>{const i=String(a.sector||"Sector ".concat(t+1)),s=a.count||0,r=e?s/e*100:0,n=$.primary[t%$.primary.length],o=i.length>24?"".concat(i.slice(0,21),"\u2026"):i;return{name:i,value:s,percentage:r,formattedPercentage:"".concat(r.toFixed(1),"%"),baseColor:n,gradientId:"sectorGrad-".concat(t),shortName:o}})},[D]),E=(0,i.useCallback)(e=>{const{cx:a,cy:t,midAngle:i,innerRadius:s,outerRadius:r,index:n}=e,o=I[n];if(!o||o.percentage<4)return null;const l=Math.PI/180,c=s+.6*(r-s),d=a+c*Math.cos(-i*l),p=t+c*Math.sin(-i*l);return(0,u.jsx)("g",{className:"sector-label",children:(0,u.jsxs)("text",{x:d,y:p,fill:"#ffffff",textAnchor:"middle",dominantBaseline:"middle",children:[(0,u.jsx)("tspan",{fontSize:12,fontWeight:700,children:o.formattedPercentage}),(0,u.jsx)("tspan",{x:d,dy:"1.2em",fontSize:10,fontWeight:500,children:o.shortName})]})})},[I]),W=(0,i.useMemo)(()=>I.length?(0,u.jsx)("div",{className:"sector-legend",role:"list",children:I.map((e,a)=>(0,u.jsxs)("div",{className:"sector-legend__item",role:"listitem",children:[(0,u.jsx)("span",{className:"sector-legend__bullet",style:{background:e.baseColor}}),(0,u.jsxs)("div",{className:"sector-legend__meta",children:[(0,u.jsx)("span",{className:"sector-legend__name",children:e.name}),(0,u.jsxs)("span",{className:"sector-legend__value",children:[e.formattedPercentage," \xb7 ",q(e.value)," carteles"]})]})]},"".concat(e.name,"-").concat(a)))}):null,[I]),B=(0,i.useMemo)(()=>{var e,a;if(null===w||void 0===w||!w.kpis)return[];const t=w.kpis,i=((null===(e=w.proveedores)||void 0===e?void 0:e.top_por_monto)||[]).map(e=>e.monto||0),s=null===(a=w.oportunidades)||void 0===a?void 0:a.ofertas_analytics;return[{title:"Procesos de contrataci\xf3n",value:t.procesos_contratacion,format:"number",icon:"\ud83d\udccb",isClickable:!0,dataset:[t.procesos_contratacion],onClick:()=>f("procesos")},...s?[{title:"Total ofertas",value:s.total_ofertas,format:"number",icon:"\ud83e\uddfe",isClickable:!1,dataset:[s.total_ofertas]}]:[],{title:"Licitaciones adjudicadas",value:t.licitaciones_adjudicadas,format:"number",icon:"\u2705",isClickable:!0,dataset:[t.licitaciones_adjudicadas],onClick:()=>f("licitaciones")},{title:"Proveedores \xfanicos",value:t.proveedores_unicos_adjudicados,format:"number",icon:"\ud83c\udfe2",isClickable:!0,dataset:[t.proveedores_unicos_adjudicados],onClick:()=>f("proveedores")},{title:"\xcdndice de concentraci\xf3n",value:t.indice_concentracion_top3,format:"percentage",icon:"\ud83d\udcca",subtitle:"Top 3 proveedores",isClickable:!0,dataset:[t.indice_concentracion_top3],onClick:()=>f("concentracion")},...null!=t.monto_total_contratado_contratos?[{title:"Monto total contratos",value:t.monto_total_contratado_contratos,format:"currency",icon:"\ud83d\udcb0",isClickable:!0,dataset:i,sparklineData:i.slice(0,10),onClick:()=>f("monto_total")}]:[],...null!=t.monto_promedio_contrato?[{title:"Monto promedio por contrato",value:Math.round(t.monto_promedio_contrato),format:"currency",icon:"\ud83d\udcc8",dataset:i,comparison:{label:"vs sector",value:15.2,benchmark:"sector"}}]:[]]},[w,f]),O=(0,i.useMemo)(()=>{var e;return null!==w&&void 0!==w&&null!==(e=w.visuales)&&void 0!==e&&e.serie_mensual_contratos?w.visuales.serie_mensual_contratos.map(e=>({date:e.mes,value:e.monto||0,label:K(e.monto,{compact:!0}),eventos:e.contratos>50?[{tipo:"Alta actividad",descripcion:"".concat(e.contratos," contratos en este mes")}]:[]})):[]},[w]);(0,i.useMemo)(()=>{var e,a,t;if(null===w||void 0===w||null===(e=w.proveedores)||void 0===e||!e.top_por_monto)return[];const i=(w.proveedores.top_por_monto||[]).slice(0,12),s=(null===w||void 0===w||null===(a=w.proveedores)||void 0===a||null===(t=a.top_por_monto)||void 0===t?void 0:t.reduce((e,a)=>e+(a.monto||0),0))||0;return i.map(e=>{const a=s>0?e.monto/s*100:0;return(0,r.A)((0,r.A)({},e),{},{pct:a})})},[w]),(0,i.useMemo)(()=>{var e,a,t;if(null===w||void 0===w||null===(e=w.proveedores)||void 0===e||!e.top_por_contratos)return[];const i=(w.proveedores.top_por_contratos||[]).slice(0,12),s=(null===w||void 0===w||null===(a=w.proveedores)||void 0===a||null===(t=a.top_por_contratos)||void 0===t?void 0:t.reduce((e,a)=>e+(a.contratos||0),0))||0;return i.map(e=>{const a=s>0?e.contratos/s*100:0;return(0,r.A)((0,r.A)({},e),{},{pct:a})})},[w]);const H=(0,i.useCallback)(e=>a=>{let{active:t,payload:i}=a;if(!t||!i||!i.length)return null;const s=i[0].payload;if("monto"===e){var r,n;const e=(null===w||void 0===w||null===(r=w.proveedores)||void 0===r||null===(n=r.top_por_monto)||void 0===n?void 0:n.reduce((e,a)=>e+(a.monto||0),0))||0,a=e?s.monto/e*100:0;return(0,u.jsxs)("div",{className:"enhanced-tooltip",children:[(0,u.jsx)("div",{className:"enhanced-tooltip__header",children:s.display}),(0,u.jsx)("div",{className:"enhanced-tooltip__value",children:K(s.monto)}),(0,u.jsxs)("div",{className:"enhanced-tooltip__rank",children:[a.toFixed(2),"% del total"]})]})}{var o,l;const e=(null===w||void 0===w||null===(o=w.proveedores)||void 0===o||null===(l=o.top_por_contratos)||void 0===l?void 0:l.reduce((e,a)=>e+(a.contratos||0),0))||0,a=e?s.contratos/e*100:0;return(0,u.jsxs)("div",{className:"enhanced-tooltip",children:[(0,u.jsx)("div",{className:"enhanced-tooltip__header",children:s.display}),(0,u.jsxs)("div",{className:"enhanced-tooltip__value",children:[q(s.contratos)," contratos"]}),(0,u.jsxs)("div",{className:"enhanced-tooltip__rank",children:[a.toFixed(2),"% del total"]})]})}},[w]);return(0,u.jsxs)("div",{className:"modern-dashboard",style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%)",padding:"70px 80px",position:"relative",overflow:"hidden",perspective:"2000px",maxWidth:"1800px",margin:"0 auto"},children:[(0,u.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden",pointerEvents:"none",zIndex:0},children:[...Array(15)].map((e,a)=>(0,u.jsx)("div",{style:{position:"absolute",width:"".concat(100*Math.random()+50,"px"),height:"".concat(100*Math.random()+50,"px"),background:"radial-gradient(circle, rgba(255,255,255,".concat(.3*Math.random()+.1,") 0%, transparent 70%)"),borderRadius:"50%",top:"".concat(100*Math.random(),"%"),left:"".concat(100*Math.random(),"%"),animation:"float".concat(a%3," ").concat(20*Math.random()+15,"s ease-in-out infinite"),filter:"blur(25px)",transform:"rotate(".concat(360*Math.random(),"deg)"),willChange:"transform"}},a))}),(0,u.jsx)("style",{children:"\n        @keyframes float0 {\n          0%, 100% { transform: translate(0, 0) rotate(0deg); opacity: 0.3; }\n          25% { transform: translate(100px, -100px) rotate(90deg); opacity: 0.6; }\n          50% { transform: translate(200px, -50px) rotate(180deg); opacity: 0.4; }\n          75% { transform: translate(100px, 50px) rotate(270deg); opacity: 0.7; }\n        }\n        @keyframes float1 {\n          0%, 100% { transform: translate(0, 0) rotate(360deg); opacity: 0.4; }\n          33% { transform: translate(-150px, 120px) rotate(240deg); opacity: 0.7; }\n          66% { transform: translate(-50px, -100px) rotate(120deg); opacity: 0.5; }\n        }\n        @keyframes float2 {\n          0%, 100% { transform: translate(0, 0) rotate(0deg) scale(1); opacity: 0.3; }\n          50% { transform: translate(120px, 150px) rotate(180deg) scale(1.3); opacity: 0.8; }\n        }\n        @keyframes pulse {\n          0%, 100% { transform: scale(1); opacity: 1; }\n          50% { transform: scale(1.05); opacity: 0.9; }\n        }\n        @keyframes shimmer {\n          0% { background-position: -1000px 0; }\n          100% { background-position: 1000px 0; }\n        }\n        @keyframes wiggle {\n          0%, 100% { transform: rotate(-3deg); }\n          50% { transform: rotate(3deg); }\n        }\n        @keyframes glow-pulse {\n          0%, 100% { filter: drop-shadow(0 0 8px rgba(102, 126, 234, 0.6)); }\n          50% { filter: drop-shadow(0 0 20px rgba(102, 126, 234, 1)); }\n        }\n        @keyframes card-float {\n          0%, 100% { transform: translateY(0px) rotateX(0deg); }\n          50% { transform: translateY(-8px) rotateX(2deg); }\n        }\n      "}),(0,u.jsx)(Me,{}),(0,u.jsx)(Se,{isCollapsed:x.filtersPanelCollapsed,onToggle:()=>g(!x.filtersPanelCollapsed)}),(0,u.jsxs)("main",{className:"dashboard-main ".concat(x.filtersPanelCollapsed?"filters-collapsed":"filters-expanded"),style:{position:"relative",zIndex:1},children:[!h&&(0,u.jsxs)("div",{className:"dashboard-loading",children:[(0,u.jsx)("div",{className:"loading-spinner"}),(0,u.jsx)("p",{children:"Cargando datos del sistema..."})]}),h&&!m.institucion&&(0,u.jsx)("div",{className:"dashboard-empty-state",children:(0,u.jsxs)("div",{className:"empty-state-content",children:[(0,u.jsx)("span",{className:"empty-state-icon",children:"\ud83c\udfdb\ufe0f"}),(0,u.jsx)("h2",{children:"Seleccione una instituci\xf3n"}),(0,u.jsx)("p",{children:"Use el panel de filtros para seleccionar una instituci\xf3n y comenzar el an\xe1lisis."}),(0,u.jsx)("button",{className:"empty-state-btn",onClick:()=>g(!1),children:"Abrir filtros"})]})}),h&&m.institucion&&!w&&(0,u.jsx)("div",{className:"dashboard-empty-state",children:(0,u.jsxs)("div",{className:"empty-state-content",children:[(0,u.jsx)("span",{className:"empty-state-icon",children:"\ud83d\udcca"}),(0,u.jsx)("h2",{children:"Sin datos disponibles"}),(0,u.jsx)("p",{children:"No se encontraron datos para la instituci\xf3n y filtros seleccionados."}),(0,u.jsx)("button",{className:"empty-state-btn",onClick:b,children:"Limpiar filtros"})]})}),h&&m.institucion&&w&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("header",{style:{background:"linear-gradient(135deg, rgba(255,255,255,0.25) 0%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.2) 100%)",backdropFilter:"blur(25px) saturate(180%)",WebkitBackdropFilter:"blur(25px) saturate(180%)",borderRadius:"24px",padding:"32px 40px",marginBottom:"32px",border:"2px solid rgba(255,255,255,0.3)",boxShadow:"\n                0 8px 32px rgba(0,0,0,0.15),\n                0 0 0 1px rgba(255,255,255,0.1) inset,\n                0 20px 60px rgba(102, 126, 234, 0.2)\n              ",position:"relative",overflow:"hidden",transform:"translateZ(0)",transformStyle:"preserve-3d",willChange:"transform"},children:[(0,u.jsx)("div",{style:{position:"absolute",top:"-50%",left:"-50%",width:"200%",height:"200%",background:"linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.15) 50%, transparent 70%)",backgroundSize:"1000px 1000px",animation:"shimmer 6s linear infinite",pointerEvents:"none"}}),(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",position:"relative",zIndex:1},children:[(0,u.jsxs)("div",{className:"institution-info",children:[(0,u.jsxs)("h1",{style:{margin:"0 0 10px 0",fontSize:"2.4em",fontWeight:800,color:"#ffffff",letterSpacing:"-0.02em",lineHeight:1.15,textShadow:"\n                      0 2px 10px rgba(0,0,0,0.3),\n                      0 4px 20px rgba(102, 126, 234, 0.4),\n                      0 0 40px rgba(102, 126, 234, 0.2)\n                    ",transform:"translateZ(20px)",filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.2))"},children:["\ud83c\udfdb\ufe0f ",(null===(e=w.institucion)||void 0===e?void 0:e.nombre)||m.institucion]}),(0,u.jsxs)("div",{style:{display:"flex",gap:"12px",transform:"translateZ(10px)"},children:[(0,u.jsx)("span",{style:{background:"linear-gradient(135deg, rgba(102, 126, 234, 0.3) 0%, rgba(118, 75, 162, 0.3) 100%)",backdropFilter:"blur(10px)",color:"#ffffff",padding:"6px 12px",borderRadius:"10px",fontSize:"12px",fontWeight:600,border:"1px solid rgba(255,255,255,0.2)",textShadow:"0 1px 3px rgba(0,0,0,0.3)"},children:(null===(a=w.institucion)||void 0===a?void 0:a.tipo)||"\u2014"}),(0,u.jsxs)("span",{style:{background:"linear-gradient(135deg, rgba(102, 126, 234, 0.3) 0%, rgba(118, 75, 162, 0.3) 100%)",backdropFilter:"blur(10px)",color:"#ffffff",padding:"6px 12px",borderRadius:"10px",fontSize:"12px",fontWeight:600,border:"1px solid rgba(255,255,255,0.2)",textShadow:"0 1px 3px rgba(0,0,0,0.3)"},children:["C\xf3digo: ",(null===(t=w.institucion)||void 0===t?void 0:t.codigo)||m.institucion]})]})]}),(0,u.jsxs)("div",{style:{display:"flex",gap:"12px",transform:"translateZ(15px)"},children:[(0,u.jsx)("button",{className:"action-btn",onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-4px) scale(1.05)",e.currentTarget.style.boxShadow="0 12px 32px rgba(108, 92, 231, 0.4)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0) scale(1)",e.currentTarget.style.boxShadow="0 8px 24px rgba(0,0,0,0.2)"},style:{background:"linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%)",color:"white",border:"none",padding:"10px 18px",borderRadius:"12px",fontWeight:700,fontSize:"12px",cursor:"pointer",boxShadow:"0 8px 24px rgba(0,0,0,0.2)",transition:"all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)",willChange:"transform"},title:"Exportar datos",children:"\ud83d\udce5 Exportar"}),(0,u.jsx)("button",{className:"action-btn",onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-4px) scale(1.05)",e.currentTarget.style.boxShadow="0 12px 32px rgba(32, 201, 151, 0.4)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0) scale(1)",e.currentTarget.style.boxShadow="0 8px 24px rgba(0,0,0,0.2)"},style:{background:"linear-gradient(135deg, #20c997 0%, #00b894 100%)",color:"white",border:"none",padding:"10px 18px",borderRadius:"12px",fontWeight:700,fontSize:"12px",cursor:"pointer",boxShadow:"0 8px 24px rgba(0,0,0,0.2)",transition:"all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)",willChange:"transform"},title:"Compartir dashboard",children:"\ud83d\udd17 Compartir"})]})]})]}),(0,u.jsx)("section",{className:"kpi-grid","aria-label":"Indicadores clave de rendimiento",style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"24px",marginBottom:"36px",perspective:"2000px",transformStyle:"preserve-3d"},children:B.map((e,a)=>(0,u.jsx)(fe,(0,r.A)((0,r.A)({},e),{},{isSelected:"procesos"===x.selectedKPI&&e.title.includes("Procesos")}),a))}),(0,u.jsxs)("div",{className:"content-grid",style:{display:"grid",gap:"24px",perspective:"2000px",transformStyle:"preserve-3d"},children:[x.timelineVisible&&O.length>0&&(0,u.jsx)("aside",{className:"timeline-sidebar",children:(0,u.jsx)(Ne,{data:O,title:"Evoluci\xf3n temporal",valueFormat:"currency",height:300,showBrush:!0,showEvents:!0})}),(0,u.jsxs)("div",{className:"charts-area",style:{display:"grid",gap:"24px"},children:[(0,u.jsxs)("div",{className:"charts-row",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"24px",perspective:"2000px",transformStyle:"preserve-3d"},children:[(0,u.jsx)(Pe,{title:"\ud83c\udfc6 Top 10 proveedores por monto",className:"chart-card",children:(0,u.jsx)(v.u,{width:"100%",height:280,children:(0,u.jsxs)(_.E,{data:w.proveedores.top_por_monto.map(e=>{const a=!e.nombre||e.nombre===e.id;return{name:a?e.id:e.nombre,id:e.id,display:a?"ID ".concat(e.id," (sin nombre)"):"".concat(e.nombre," (ID ").concat(e.id,")"),monto:e.monto}}),margin:{top:20,right:10,left:0,bottom:0},children:[(0,u.jsxs)("defs",{children:[(0,u.jsxs)("linearGradient",{id:"gradMonto",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,u.jsx)("stop",{offset:"0%",stopColor:"#667eea",stopOpacity:1}),(0,u.jsx)("stop",{offset:"35%",stopColor:"#764ba2",stopOpacity:.95}),(0,u.jsx)("stop",{offset:"70%",stopColor:"#f093fb",stopOpacity:.9}),(0,u.jsx)("stop",{offset:"100%",stopColor:"#764ba2",stopOpacity:.85})]}),(0,u.jsxs)("filter",{id:"shadowMonto",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[(0,u.jsx)("feDropShadow",{dx:"0",dy:"2",stdDeviation:"3",floodOpacity:"0.15",floodColor:"#667eea"}),(0,u.jsx)("feDropShadow",{dx:"0",dy:"6",stdDeviation:"8",floodOpacity:"0.1",floodColor:"#764ba2"}),(0,u.jsx)("feDropShadow",{dx:"0",dy:"12",stdDeviation:"16",floodOpacity:"0.06",floodColor:"#f093fb"})]})]}),(0,u.jsx)(y.W,{dataKey:"name",hide:!0}),(0,u.jsx)(N.h,{tickFormatter:e=>K(e,{compact:!0}),stroke:"#64748b",style:{fontSize:13,fontWeight:600}}),(0,u.jsx)(C.m,{content:H("monto"),cursor:{fill:"rgba(102, 126, 234, 0.08)",filter:"blur(8px)"},wrapperStyle:{outline:"none",filter:"drop-shadow(0 8px 32px rgba(102, 126, 234, 0.25))"}}),(0,u.jsx)(A.y,{dataKey:"monto",fill:"url(#gradMonto)",radius:[10,10,0,0],filter:"url(#shadowMonto)",style:{transition:"all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)",cursor:"pointer"},children:(0,u.jsx)(de.Ze,{dataKey:"monto",position:"top",formatter:e=>K(Number(e)||0,{compact:!0}),style:{fontSize:12,fill:"#1e293b",fontWeight:800,textShadow:"0 1px 2px rgba(255,255,255,0.8)"}})})]})})}),(0,u.jsx)(Pe,{title:"\ud83d\udcca Top 10 proveedores por contratos",className:"chart-card",children:(0,u.jsx)(v.u,{width:"100%",height:280,children:(0,u.jsxs)(_.E,{data:w.proveedores.top_por_contratos.map(e=>{const a=!e.nombre||e.nombre===e.id;return{name:a?e.id:e.nombre,id:e.id,display:a?"ID ".concat(e.id," (sin nombre)"):"".concat(e.nombre," (ID ").concat(e.id,")"),contratos:e.contratos}}),margin:{top:20,right:10,left:0,bottom:0},children:[(0,u.jsxs)("defs",{children:[(0,u.jsxs)("linearGradient",{id:"gradContratos",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,u.jsx)("stop",{offset:"0%",stopColor:"#f093fb",stopOpacity:1}),(0,u.jsx)("stop",{offset:"35%",stopColor:"#f5576c",stopOpacity:.95}),(0,u.jsx)("stop",{offset:"70%",stopColor:"#ff8a80",stopOpacity:.9}),(0,u.jsx)("stop",{offset:"100%",stopColor:"#f5576c",stopOpacity:.85})]}),(0,u.jsxs)("filter",{id:"shadowContratos",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[(0,u.jsx)("feDropShadow",{dx:"0",dy:"2",stdDeviation:"3",floodOpacity:"0.15",floodColor:"#f093fb"}),(0,u.jsx)("feDropShadow",{dx:"0",dy:"6",stdDeviation:"8",floodOpacity:"0.1",floodColor:"#f5576c"}),(0,u.jsx)("feDropShadow",{dx:"0",dy:"12",stdDeviation:"16",floodOpacity:"0.06",floodColor:"#ff8a80"})]})]}),(0,u.jsx)(y.W,{dataKey:"name",hide:!0}),(0,u.jsx)(N.h,{stroke:"#64748b",style:{fontSize:13,fontWeight:600}}),(0,u.jsx)(C.m,{content:H("contratos"),cursor:{fill:"rgba(240, 147, 251, 0.08)",filter:"blur(8px)"},wrapperStyle:{outline:"none",filter:"drop-shadow(0 8px 32px rgba(240, 147, 251, 0.25))"}}),(0,u.jsx)(A.y,{dataKey:"contratos",fill:"url(#gradContratos)",radius:[10,10,0,0],filter:"url(#shadowContratos)",style:{transition:"all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)",cursor:"pointer"},children:(0,u.jsx)(de.Ze,{dataKey:"contratos",position:"top",formatter:e=>q(Number(e)||0),style:{fontSize:12,fill:"#1e293b",fontWeight:800,textShadow:"0 1px 2px rgba(255,255,255,0.8)"}})})]})})})]}),(0,u.jsxs)("div",{className:"charts-row",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"24px",perspective:"2000px",transformStyle:"preserve-3d"},children:[(0,u.jsx)(Pe,{title:"\ud83c\udfaf Distribuci\xf3n por sectores",className:"chart-card",children:(0,u.jsxs)("div",{className:"sector-chart",children:[(0,u.jsx)(v.u,{width:"100%",height:300,children:(0,u.jsxs)(k.r,{children:[(0,u.jsxs)("defs",{children:[I.map((e,a)=>(0,u.jsxs)("linearGradient",{id:e.gradientId,x1:"0",y1:"0",x2:"1",y2:"1",children:[(0,u.jsx)("stop",{offset:"0%",stopColor:e.baseColor,stopOpacity:1}),(0,u.jsx)("stop",{offset:"50%",stopColor:e.baseColor,stopOpacity:.85}),(0,u.jsx)("stop",{offset:"100%",stopColor:e.baseColor,stopOpacity:.7})]},e.gradientId)),(0,u.jsxs)("filter",{id:"shadowPie",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[(0,u.jsx)("feDropShadow",{dx:"0",dy:"2",stdDeviation:"4",floodOpacity:"0.12"}),(0,u.jsx)("feDropShadow",{dx:"0",dy:"6",stdDeviation:"10",floodOpacity:"0.08"}),(0,u.jsx)("feDropShadow",{dx:"0",dy:"12",stdDeviation:"20",floodOpacity:"0.04"})]})]}),(0,u.jsxs)(S.F,{data:I,cx:"50%",cy:"50%",innerRadius:70,outerRadius:120,paddingAngle:3,dataKey:"value",labelLine:!1,filter:"url(#shadowPie)",animationBegin:0,animationDuration:1e3,animationEasing:"ease-out",children:[I.map((e,a)=>(0,u.jsx)(M.f,{fill:"url(#".concat(e.gradientId,")"),stroke:"#ffffff",strokeWidth:3,style:{filter:"drop-shadow(0 4px 8px rgba(0,0,0,0.1))",transition:"all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)",cursor:"pointer"}},"cell-".concat(a))),(0,u.jsx)(pe.JU,{content:E})]}),(0,u.jsx)(C.m,{formatter:(e,a,t)=>{const i=I.reduce((e,a)=>e+a.value,0),s=i?e/i*100:0;return["".concat(e," carteles (").concat(s.toFixed(1),"%)"),a]},contentStyle:{background:"rgba(255, 255, 255, 0.98)",backdropFilter:"blur(25px) saturate(180%)",border:"2px solid rgba(255, 255, 255, 0.3)",borderRadius:"16px",padding:"14px 18px",boxShadow:"0 16px 48px rgba(102, 126, 234, 0.25), 0 8px 24px rgba(118, 75, 162, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.4)"},itemStyle:{color:"#1e293b",fontWeight:700,fontSize:"12px",textShadow:"0 1px 2px rgba(255,255,255,0.8)"},labelStyle:{color:"#64748b",fontWeight:600,fontSize:"11px"},wrapperStyle:{outline:"none",filter:"drop-shadow(0 12px 40px rgba(102, 126, 234, 0.3))"}}),(()=>{const e=I.reduce((e,a)=>e+a.value,0),a=I[0],t=e&&a?(a.value/e*100).toFixed(1):"0";return(0,u.jsxs)("text",{x:"50%",y:"50%",textAnchor:"middle",dominantBaseline:"middle",style:{fontSize:13,fontFamily:"inherit",fill:"#334155"},children:[(0,u.jsx)("tspan",{x:"50%",dy:"-0.5em",fontSize:18,fontWeight:800,fill:"#667eea",children:e}),(0,u.jsx)("tspan",{x:"50%",dy:"1.3em",fill:"#64748b",fontSize:12,children:"total carteles"}),a&&(0,u.jsxs)("tspan",{x:"50%",dy:"1.3em",fill:"#f093fb",fontSize:11,fontWeight:700,children:[t,"% ",a.name]})]})})()]})}),W]})}),(0,u.jsx)(Pe,{title:"\ud83d\udcac Palabras clave (an\xe1lisis sem\xe1ntico)",className:"chart-card",children:null!==(o=w.bienes_servicios)&&void 0!==o&&o.palabras_clave&&w.bienes_servicios.palabras_clave.length>0?(0,u.jsx)(Te,{keywords:w.bienes_servicios.palabras_clave.map(e=>{var a,t;return{palabra:e.palabra,frecuencia:null!==(a=null!==(t=e.frecuencia)&&void 0!==t?t:e.freq)&&void 0!==a?a:0}})}):(0,u.jsx)("div",{className:"no-data",children:"\ud83d\udcca Sin palabras clave disponibles"})})]})]})]}),(null===(l=w.oportunidades)||void 0===l?void 0:l.ofertas_analytics)&&(0,u.jsxs)("section",{className:"offers-analytics","aria-label":"Anal\xedtica de ofertas",style:{background:"linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(240,242,255,0.9) 100%)",backdropFilter:"blur(25px) saturate(180%)",borderRadius:"24px",padding:"32px",border:"2px solid rgba(255, 255, 255, 0.3)",boxShadow:"0 20px 60px rgba(102, 126, 234, 0.15), 0 8px 24px rgba(118, 75, 162, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.5)",marginTop:"24px",position:"relative",overflow:"hidden"},children:[(0,u.jsx)("div",{style:{position:"absolute",top:0,left:"-100%",width:"100%",height:"100%",background:"linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent)",animation:"shimmer 3s infinite",pointerEvents:"none",zIndex:1}}),(0,u.jsx)("h2",{className:"section-title",style:{fontSize:"22px",fontWeight:800,color:"#1e293b",marginBottom:"20px",textShadow:"0 2px 4px rgba(255,255,255,0.8)",position:"relative",zIndex:2},children:"\ud83c\udfaa Competencia en licitaciones"}),(0,u.jsxs)("div",{className:"offers-grid",style:{display:"grid",gridTemplateColumns:"auto 1fr",gap:"24px",perspective:"2000px",transformStyle:"preserve-3d",position:"relative",zIndex:2},children:[(0,u.jsxs)("div",{className:"offer-kpis",style:{display:"flex",flexDirection:"column",gap:"16px",minWidth:"280px"},children:[(0,u.jsxs)("div",{className:"offer-kpi",style:{background:"linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.05) 100%)",backdropFilter:"blur(20px)",borderRadius:"16px",padding:"16px",border:"2px solid rgba(102, 126, 234, 0.2)",boxShadow:"0 8px 24px rgba(102, 126, 234, 0.12), inset 0 1px 0 rgba(255, 255, 255, 0.4)",transition:"all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)",cursor:"pointer",transform:"translateZ(0)"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-4px) translateZ(8px) rotateX(1deg)",e.currentTarget.style.boxShadow="0 12px 36px rgba(102, 126, 234, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.6)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0) translateZ(0) rotateX(0)",e.currentTarget.style.boxShadow="0 8px 24px rgba(102, 126, 234, 0.12), inset 0 1px 0 rgba(255, 255, 255, 0.4)"},children:[(0,u.jsx)("div",{className:"offer-kpi__label",style:{fontSize:"11px",fontWeight:600,color:"#64748b",marginBottom:"6px"},children:"\ud83d\udcca Promedio de ofertas"}),(0,u.jsx)("div",{className:"offer-kpi__value",style:{fontSize:"28px",fontWeight:800,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",textShadow:"0 2px 4px rgba(102, 126, 234, 0.2)"},children:(w.oportunidades.ofertas_analytics.promedio_ofertas||0).toFixed(2)})]}),(0,u.jsxs)("div",{className:"offer-kpi",style:{background:"linear-gradient(135deg, rgba(245, 87, 108, 0.1) 0%, rgba(240, 147, 251, 0.05) 100%)",backdropFilter:"blur(20px)",borderRadius:"16px",padding:"16px",border:"2px solid rgba(245, 87, 108, 0.2)",boxShadow:"0 8px 24px rgba(245, 87, 108, 0.12), inset 0 1px 0 rgba(255, 255, 255, 0.4)",transition:"all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)",cursor:"pointer",transform:"translateZ(0)"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-4px) translateZ(8px) rotateX(1deg)",e.currentTarget.style.boxShadow="0 12px 36px rgba(245, 87, 108, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.6)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0) translateZ(0) rotateX(0)",e.currentTarget.style.boxShadow="0 8px 24px rgba(245, 87, 108, 0.12), inset 0 1px 0 rgba(255, 255, 255, 0.4)"},children:[(0,u.jsx)("div",{className:"offer-kpi__label",style:{fontSize:"11px",fontWeight:600,color:"#64748b",marginBottom:"6px"},children:"\u26a0\ufe0f Una sola oferta"}),(0,u.jsxs)("div",{className:"offer-kpi__value",style:{fontSize:"28px",fontWeight:800,background:"linear-gradient(135deg, #f5576c 0%, #f093fb 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",textShadow:"0 2px 4px rgba(245, 87, 108, 0.2)"},children:[(w.oportunidades.ofertas_analytics.porcentaje_una_oferta||0).toFixed(1),"%"]})]}),(0,u.jsxs)("div",{className:"offer-kpi",style:{background:"linear-gradient(135deg, rgba(52, 211, 153, 0.1) 0%, rgba(16, 185, 129, 0.05) 100%)",backdropFilter:"blur(20px)",borderRadius:"16px",padding:"16px",border:"2px solid rgba(52, 211, 153, 0.2)",boxShadow:"0 8px 24px rgba(52, 211, 153, 0.12), inset 0 1px 0 rgba(255, 255, 255, 0.4)",transition:"all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)",cursor:"pointer",transform:"translateZ(0)"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-4px) translateZ(8px) rotateX(1deg)",e.currentTarget.style.boxShadow="0 12px 36px rgba(52, 211, 153, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.6)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0) translateZ(0) rotateX(0)",e.currentTarget.style.boxShadow="0 8px 24px rgba(52, 211, 153, 0.12), inset 0 1px 0 rgba(255, 255, 255, 0.4)"},children:[(0,u.jsx)("div",{className:"offer-kpi__label",style:{fontSize:"11px",fontWeight:600,color:"#64748b",marginBottom:"6px"},children:"\ud83e\uddfe Total ofertas"}),(0,u.jsx)("div",{className:"offer-kpi__value",style:{fontSize:"28px",fontWeight:800,background:"linear-gradient(135deg, #34d399 0%, #10b981 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",textShadow:"0 2px 4px rgba(52, 211, 153, 0.2)"},children:(Y=w.oportunidades.ofertas_analytics.total_ofertas||0,(Y||0).toLocaleString("es-CR",{maximumFractionDigits:0}))})]})]}),(0,u.jsx)("div",{className:"offer-distribution",style:{background:"linear-gradient(135deg, rgba(255,255,255,0.6) 0%, rgba(240,255,244,0.5) 100%)",backdropFilter:"blur(20px)",borderRadius:"20px",padding:"20px",border:"2px solid rgba(52, 211, 153, 0.2)",boxShadow:"0 12px 40px rgba(52, 211, 153, 0.12), inset 0 1px 0 rgba(255, 255, 255, 0.4)"},children:(0,u.jsx)(v.u,{width:"100%",height:220,children:(0,u.jsxs)(_.E,{data:w.oportunidades.ofertas_analytics.distribucion,children:[(0,u.jsxs)("defs",{children:[(0,u.jsxs)("linearGradient",{id:"gradOfertas",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,u.jsx)("stop",{offset:"0%",stopColor:"#10b981",stopOpacity:1}),(0,u.jsx)("stop",{offset:"35%",stopColor:"#34d399",stopOpacity:.95}),(0,u.jsx)("stop",{offset:"70%",stopColor:"#6ee7b7",stopOpacity:.9}),(0,u.jsx)("stop",{offset:"100%",stopColor:"#059669",stopOpacity:.85})]}),(0,u.jsxs)("filter",{id:"shadowOfertas",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[(0,u.jsx)("feDropShadow",{dx:"0",dy:"2",stdDeviation:"3",floodOpacity:"0.15",floodColor:"#10b981"}),(0,u.jsx)("feDropShadow",{dx:"0",dy:"6",stdDeviation:"8",floodOpacity:"0.1",floodColor:"#34d399"}),(0,u.jsx)("feDropShadow",{dx:"0",dy:"12",stdDeviation:"16",floodOpacity:"0.06",floodColor:"#6ee7b7"})]})]}),(0,u.jsx)(y.W,{dataKey:"ofertas",label:{value:"N\xfamero de ofertas",position:"insideBottom",dy:10,style:{fontWeight:700,fontSize:13,fill:"#1e293b"}},stroke:"#64748b",style:{fontSize:13,fontWeight:600}}),(0,u.jsx)(N.h,{stroke:"#64748b",style:{fontSize:13,fontWeight:600}}),(0,u.jsx)(C.m,{formatter:(e,a,t)=>["".concat(e," licitaciones (").concat((t.payload.percentage||0).toFixed(1),"%)"),"Licitaciones"],contentStyle:{background:"rgba(255, 255, 255, 0.98)",backdropFilter:"blur(25px) saturate(180%)",border:"2px solid rgba(52, 211, 153, 0.3)",borderRadius:"16px",padding:"14px 18px",boxShadow:"0 16px 48px rgba(52, 211, 153, 0.25), inset 0 1px 0 rgba(255, 255, 255, 0.4)"},itemStyle:{color:"#1e293b",fontWeight:700,fontSize:"12px",textShadow:"0 1px 2px rgba(255,255,255,0.8)"},labelStyle:{color:"#64748b",fontWeight:600,fontSize:"11px"},wrapperStyle:{outline:"none",filter:"drop-shadow(0 12px 40px rgba(52, 211, 153, 0.3))"}}),(0,u.jsx)(A.y,{dataKey:"count",fill:"url(#gradOfertas)",radius:[10,10,0,0],filter:"url(#shadowOfertas)",style:{transition:"all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)",cursor:"pointer"}})]})})})]})]}),(0,u.jsxs)("section",{className:"tables-section","aria-label":"Licitaciones y contratos",style:{display:"grid",gap:"24px",marginTop:"24px",perspective:"2000px",transformStyle:"preserve-3d"},children:[(0,u.jsx)(Pe,{title:"Ofertas (resumen)",children:(0,u.jsx)(Ae,{data:((null===(c=w.oportunidades)||void 0===c?void 0:c.ofertas_resumen)||[]).map(e=>({cartel:e.numeroCartel,descripcion:e.descripcion||"",fecha:Le(e.fechaOferta)})),columns:[{key:"cartel",header:"SICOP",width:160},{key:"descripcion",header:"Descripci\xf3n",width:520},{key:"fecha",header:"\xdaltima oferta",width:140}],height:220,ariaLabel:"Tabla de ofertas",resizable:!0})}),(0,u.jsx)(Pe,{title:"Licitaciones recientes (tabla)",children:(0,u.jsx)(Ae,{data:((null===(d=w.oportunidades)||void 0===d?void 0:d.licitaciones_recientes)||[]).map(e=>{const a=(e.nombreCartel||"").toString();return{cartel:e.numeroCartel,fecha:Le(e.fechaPublicacion),procedimiento:e.procedimiento||"\u2014",descripcion:a,descripcionCorta:a.length>80?a.slice(0,77)+"\u2026":a,montoEstimado:e.montoEstimado||0,ofertas:e.ofertasRecibidas||0,estado:e.estado||"\u2014"}}),columns:[{key:"cartel",header:"Cartel",width:110},{key:"fecha",header:"Fecha",width:100},{key:"procedimiento",header:"Procedimiento",width:160},{key:"descripcionCorta",header:"Descripci\xf3n",width:380,cell:e=>{const a=e.cartel,t=T.has(a);return(0,u.jsx)("div",{className:"desc-cell ".concat(t?"expanded":""),style:{whiteSpace:t?"normal":"nowrap",cursor:"pointer"},title:t?"Click para contraer":"Click para expandir",onClick:()=>R(a),children:t?e.descripcion:e.descripcionCorta})}},{key:"montoEstimado",header:"Estimado",width:120,align:"right",cell:e=>K(e.montoEstimado,{compact:!0})},{key:"ofertas",header:"Ofertas",width:90,align:"right"},{key:"estado",header:"Estado",width:140}],height:240,ariaLabel:"Tabla de licitaciones recientes",resizable:!0})}),(0,u.jsx)(Pe,{title:"Contratos (resumen)",children:(0,u.jsx)(Ae,{data:(w.contratos_resumen||[]).map(e=>({contrato:e.idContrato,cartel:e.numeroCartel,proveedor:e.proveedor,fecha:Le(e.fechaFirma),monto:e.monto||0,estado:e.estado||"\u2014"})),columns:[{key:"contrato",header:"Contrato",width:110},{key:"cartel",header:"Cartel",width:110},{key:"proveedor",header:"Proveedor",width:220},{key:"fecha",header:"Firma",width:110},{key:"monto",header:"Monto",width:120,align:"right",cell:e=>K(e.monto,{compact:!0})},{key:"estado",header:"Estado",width:140}],height:240,ariaLabel:"Tabla de contratos",resizable:!0})})]}),(null===(p=w.sectores)||void 0===p?void 0:p.sector_clasificacion)&&(0,u.jsx)("section",{className:"tables-section","aria-label":"Clasificaci\xf3n sectorial por cartel",children:(0,u.jsx)(Pe,{title:"Clasificaci\xf3n de carteles (sector y subcategor\xeda)",children:(0,u.jsx)(Ae,{data:(w.sectores.sector_clasificacion||[]).map(e=>({cartel:e.numeroCartel,sector:e.sector,subcategoria:e.subcategoria,descripcionCorta:(e.descripcion||"").length>100?e.descripcion.slice(0,97)+"\u2026":e.descripcion||"",descripcion:e.descripcion||""})),columns:[{key:"cartel",header:"Cartel",width:120},{key:"sector",header:"Sector",width:140},{key:"subcategoria",header:"Subcategor\xeda",width:200},{key:"descripcionCorta",header:"Descripci\xf3n",width:480,cell:e=>{const a=e.cartel+e.subcategoria,t=L.has(a);return(0,u.jsx)("div",{className:"desc-cell ".concat(t?"expanded":""),style:{whiteSpace:t?"normal":"nowrap",cursor:"pointer"},title:t?"Click para contraer":"Click para expandir",onClick:()=>F(a),children:t?e.descripcion:e.descripcionCorta})}}],height:260,ariaLabel:"Tabla de clasificaci\xf3n sectorial",resizable:!0})})})]})]})]});var Y};var Fe=t(3245),De=t(7202);const Ie=()=>{var e,a,t,r,n,o,l,c,d,p,h,m,x,g,f,b,T,z;const{isLoaded:L,buscarCartelPorNumero:P,sugerirCarteles:R,instituciones:F}=(0,s.M)(),[D,I]=(0,i.useState)(""),[E,W]=(0,i.useState)([]),[B,O]=(0,i.useState)(null),[H,Y]=(0,i.useState)(!1),[U,G]=(0,i.useState)("overview");(0,i.useEffect)(()=>{if(!D)return void W([]);const e=setTimeout(()=>{const e=R(D,10);W(e)},180);return()=>clearTimeout(e)},[D,R]),(0,i.useEffect)(()=>{if(!L)return;try{const e=P("20250401505");e?console.log("\ud83d\udd0e Probe dossier for 20250401505:",{numeroCartel:e.numeroCartel,kpis:e.kpis,cartel:e.cartel}):console.log("\ud83d\udd0e Probe dossier NOT found for 20250401505")}catch(e){console.warn("Probe error 20250401505:",e)}},[L,P]);const V=(0,i.useCallback)(e=>{I(e),W([])},[]),Z=(0,i.useCallback)(()=>{if(!D)return;Y(!0);const e=P(D);O(e),Y(!1)},[D,P]),X=(0,i.useMemo)(()=>{var e;if(null===B||void 0===B||null===(e=B.cartel)||void 0===e||!e.codigoInstitucion)return"";const a=null===F||void 0===F?void 0:F.find(e=>e.codigoInstitucion===B.cartel.codigoInstitucion);return(null===a||void 0===a?void 0:a.nombreInstitucion)||B.cartel.codigoInstitucion},[B,F]),Q=(0,i.useMemo)(()=>{var e;return(null===B||void 0===B||null===(e=B.cartel)||void 0===e?void 0:e.codigoInstitucion)||""},[B]),ee=[{key:"numeroLinea",header:"#",width:60,align:"center"},{key:"descripcionLinea",header:"Descripci\xf3n",width:420},{key:"unidadMedida",header:"Unidad",width:90},{key:"cantidadRequerida",header:"Cantidad",width:100,align:"right",cell:e=>q(e.cantidadRequerida,{decimals:0})},{key:"presupuestoLinea",header:"Presupuesto",width:140,align:"right",cell:e=>K(e.presupuestoLinea)}],ae=[{key:"idProveedor",header:"Proveedor",width:200},{key:"fechaOferta",header:"Fecha",width:120,cell:e=>J(e.fechaOferta)},{key:"montoOferta",header:"Monto",width:160,align:"right",cell:e=>K(e.montoOferta)},{key:"estadoOferta",header:"Estado",width:120}],te=[{key:"numeroLinea",header:"L\xednea",width:60,align:"center"},{key:"idProveedorAdjudicado",header:"Proveedor Ganador",width:240},{key:"cantidadAdjudicada",header:"Cant.",width:90,align:"right"},{key:"precioAdjudicado",header:"Precio",width:140,align:"right",cell:e=>K(e.precioAdjudicado)},{key:"montoLineaAdjudicada",header:"Monto L\xednea",width:160,align:"right",cell:e=>K(e.montoLineaAdjudicada)}],ie=[{key:"idContrato",header:"Contrato",width:160},{key:"fechaFirma",header:"Firma",width:120,cell:e=>J(e.fechaFirma)},{key:"montoContrato",header:"Monto",width:160,align:"right",cell:e=>K(e.montoContrato)},{key:"estadoContrato",header:"Estado",width:120}],se=[{key:"idOrden",header:"Orden",width:140},{key:"fechaOrden",header:"Fecha",width:120,cell:e=>J(e.fechaOrden)},{key:"montoOrden",header:"Monto",width:140,align:"right",cell:e=>K(e.montoOrden)},{key:"descripcionOrden",header:"Detalle",width:260}],re=[{key:"idRecepcion",header:"Recepci\xf3n",width:160},{key:"fechaRecepcion",header:"Fecha",width:120,cell:e=>J(e.fechaRecepcion)},{key:"cantidadRecibida",header:"Cant.",width:100,align:"right",cell:e=>q(e.cantidadRecibida,{decimals:0})},{key:"conformeEntrega",header:"Conforme",width:120,cell:e=>e.conformeEntrega?"\u2705 S\xed":"\u274c No"}],ne=[{key:"numeroLinea",header:"L\xednea",width:70,align:"center"},{key:"cantidadOfertasRecibidas",header:"Ofertas",width:100,align:"right"},{key:"mejorOferta",header:"Mejor",width:120,align:"right",cell:e=>K(e.mejorOferta)},{key:"peorOferta",header:"Peor",width:120,align:"right",cell:e=>K(e.peorOferta)},{key:"promedioOfertas",header:"Promedio",width:120,align:"right",cell:e=>K(e.promedioOfertas)},{key:"desierta",header:"Desierta",width:100,cell:e=>e.desierta?"S\xed":"No"}],oe=[{key:"numeroLinea",header:"L\xednea",width:70,align:"center"},{key:"idProveedor",header:"Proveedor",width:220},{key:"precioUnitarioOfertado",header:"Precio Unit.",width:140,align:"right",cell:e=>K(e.precioUnitarioOfertado)},{key:"cantidadOfertada",header:"Cantidad",width:110,align:"right",cell:e=>q(e.cantidadOfertada)},{key:"montoOfertadoLinea",header:"Monto L\xednea",width:160,align:"right",cell:e=>K(e.montoOfertadoLinea)}],le=[{key:"idGarantia",header:"Garant\xeda",width:160},{key:"tipoGarantia",header:"Tipo",width:140},{key:"montoGarantia",header:"Monto",width:160,align:"right",cell:e=>K(e.montoGarantia)},{key:"emisorGarantia",header:"Emisor",width:200},{key:"fechaInicio",header:"Inicio",width:120,cell:e=>J(e.fechaInicio)},{key:"fechaVencimiento",header:"Vence",width:120,cell:e=>J(e.fechaVencimiento)}],ce=(0,i.useMemo)(()=>null!==B&&void 0!==B&&B.ofertas?B.ofertas.slice(0,10).map(e=>{var a;return{proveedor:(null===(a=e.idProveedor)||void 0===a?void 0:a.substring(0,20))||"N/A",monto:e.montoOferta||0,estado:e.estadoOferta||"Desconocido"}}).sort((e,a)=>e.monto-a.monto):[],[B]),de=(0,i.useMemo)(()=>{if(null===B||void 0===B||!B.lineasOfertadas)return[];const e=B.lineasOfertadas.reduce((e,a)=>{const t=a.idProveedor||"Sin identificar";return e[t]=(e[t]||0)+1,e},{});return Object.entries(e).map(e=>{let[a,t]=e;return{name:a.substring(0,25),value:t}}).sort((e,a)=>a.value-e.value).slice(0,8)},[B]),pe=(0,i.useMemo)(()=>null!==B&&void 0!==B&&B.timeline?B.timeline.map((e,a)=>{var t,i;return{fase:(null===(t=e.evento)||void 0===t?void 0:t.substring(0,20))||"Fase ".concat(a+1),fecha:e.fecha?new Date(e.fecha).getTime():0,dias:a>0&&null!==(i=B.timeline[a-1])&&void 0!==i&&i.fecha?Math.floor((new Date(e.fecha).getTime()-new Date(B.timeline[a-1].fecha).getTime())/864e5):0}}).filter(e=>e.fecha>0):[],[B]),he=(0,i.useMemo)(()=>{var e,a,t,i;if(null===B||void 0===B||!B.kpis)return{competitionIndex:0,savings:0,avgResponseTime:0,compliance:0};const s=(null===(e=B.ofertas)||void 0===e?void 0:e.length)||0,r=(null===(a=B.lineas)||void 0===a?void 0:a.length)||1,n=Math.min(s/r*10,100),o=B.kpis.presupuestoTotal||0,l=B.kpis.montoAdjudicado||0,c=o>0?(o-l)/o*100:0,d=B.timeline||[],p=d.find(e=>{var a;return null===(a=e.evento)||void 0===a?void 0:a.toLowerCase().includes("public")}),h=d.find(e=>{var a;return null===(a=e.evento)||void 0===a?void 0:a.toLowerCase().includes("apert")}),m=null!==p&&void 0!==p&&p.fecha&&null!==h&&void 0!==h&&h.fecha?Math.floor((new Date(h.fecha).getTime()-new Date(p.fecha).getTime())/864e5):0,x=((null===(t=B.recepciones)||void 0===t?void 0:t.filter(e=>e.conformeEntrega).length)||0)/((null===(i=B.recepciones)||void 0===i?void 0:i.length)||1)*100;return{competitionIndex:Math.round(n),savings:Math.round(10*c)/10,avgResponseTime:m,compliance:Math.round(x)}},[B]),me=[{key:"idRecurso",header:"Recurso",width:140},{key:"idProveedor",header:"Proveedor",width:220},{key:"fechaPresentacion",header:"Fecha",width:130,cell:e=>J(e.fechaPresentacion)},{key:"estadoRecurso",header:"Estado",width:140},{key:"resultadoRecurso",header:"Resultado",width:160},{key:"motivoRecurso",header:"Motivo",width:300}],xe=[{key:"idReajuste",header:"Reajuste",width:140},{key:"fechaReajuste",header:"Fecha",width:130,cell:e=>J(e.fechaReajuste)},{key:"porcentajeReajuste",header:"%",width:100,align:"right",cell:e=>null!=e.porcentajeReajuste?"".concat(e.porcentajeReajuste,"%"):"\u2014"},{key:"montoReajuste",header:"Monto",width:140,align:"right",cell:e=>K(e.montoReajuste)},{key:"nuevoMontoContrato",header:"Nuevo Monto",width:160,align:"right",cell:e=>K(e.nuevoMontoContrato)},{key:"motivoReajuste",header:"Motivo",width:300}];return(0,u.jsxs)("div",{className:"sicop-explorer",children:[(0,u.jsxs)("div",{className:"search-card",children:[(0,u.jsx)("h2",{children:"\ud83d\udd0e Explorador SICOP"}),(0,u.jsx)("p",{children:"Busca por n\xfamero SICOP para ver el dossier completo: cartel, l\xedneas, ofertas, adjudicaci\xf3n y contratos con an\xe1lisis avanzado."}),(0,u.jsxs)("div",{className:"search-wrapper",children:[(0,u.jsxs)("div",{className:"search-input-container",children:[(0,u.jsx)("input",{className:"search-input",placeholder:"Ej: 2024LN-000123-0001101101",value:D,onChange:e=>I(e.target.value),onKeyDown:e=>{"Enter"===e.key&&Z()},"aria-label":"Buscar por n\xfamero SICOP"}),E.length>0&&(0,u.jsx)("div",{className:"suggestions-list",role:"listbox","aria-label":"Sugerencias",children:E.map(e=>(0,u.jsxs)("div",{className:"suggestion-item",onClick:()=>V(e.numeroCartel),children:[(0,u.jsx)("div",{className:"suggestion-item-title",children:e.numeroCartel}),(0,u.jsx)("div",{className:"suggestion-item-subtitle",children:e.nombreCartel})]},e.numeroCartel))})]}),(0,u.jsx)("button",{className:"search-btn",onClick:Z,disabled:!L||!D||H,children:H?"Buscando\u2026":"Buscar"})]})]}),B&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{className:"header-card",children:[(0,u.jsxs)("div",{className:"header-banner",children:[(0,u.jsx)("div",{className:"header-badge",children:"LICITACI\xd3N P\xdaBLICA"}),(0,u.jsxs)("div",{className:"header-title-section",children:[(0,u.jsx)("h1",{className:"header-main-title",children:(null===(e=B.cartel)||void 0===e?void 0:e.nombreCartel)||"Cartel Sin Nombre"}),(0,u.jsxs)("div",{className:"header-metadata",children:[(0,u.jsxs)("span",{className:"header-meta-item",children:[(0,u.jsx)("span",{className:"meta-icon",children:"\ud83d\udccb"}),(0,u.jsx)("span",{className:"meta-label",children:"SICOP:"}),(0,u.jsx)("span",{className:"meta-value",children:B.numeroCartel})]}),Q&&(0,u.jsxs)("span",{className:"header-meta-item",children:[(0,u.jsx)("span",{className:"meta-icon",children:"\ud83c\udfe2"}),(0,u.jsx)("span",{className:"meta-label",children:"Instituci\xf3n:"}),(0,u.jsx)("span",{className:"meta-value",children:Q})]}),(0,u.jsxs)("span",{className:"header-meta-item",children:[(0,u.jsx)("span",{className:"meta-icon",children:"\ud83c\udfdb\ufe0f"}),(0,u.jsx)("span",{className:"meta-label",children:X})]})]})]}),(0,u.jsxs)("div",{className:"header-chips",children:[(null===(a=B.cartel)||void 0===a?void 0:a.estadoCartel)&&(0,u.jsxs)("span",{className:"chip chip-status",children:[(0,u.jsx)("span",{className:"chip-icon",children:"\ud83d\udccb"}),B.cartel.estadoCartel]}),(null===(t=B.cartel)||void 0===t?void 0:t.codigoProcedimiento)&&(0,u.jsxs)("span",{className:"chip chip-procedure",children:[(0,u.jsx)("span",{className:"chip-icon",children:"\ud83d\udd16"}),B.cartel.codigoProcedimiento]}),(null===(r=B.cartel)||void 0===r?void 0:r.codigoSistema)&&(0,u.jsxs)("span",{className:"chip chip-system",children:[(0,u.jsx)("span",{className:"chip-icon",children:"\ud83d\udcbb"}),B.cartel.codigoSistema]})]})]}),(0,u.jsxs)("div",{className:"header-kpis",children:[(0,u.jsxs)("div",{className:"kpi-mini",children:[(0,u.jsx)("span",{className:"kpi-mini-label",children:"Presupuesto"}),(0,u.jsx)("strong",{className:"kpi-mini-value",children:K(null===(n=B.kpis)||void 0===n?void 0:n.montoEstimado)})]}),(0,u.jsxs)("div",{className:"kpi-mini",children:[(0,u.jsx)("span",{className:"kpi-mini-label",children:"Ofertas"}),(0,u.jsx)("strong",{className:"kpi-mini-value",children:q(null===(o=B.kpis)||void 0===o?void 0:o.ofertasRecibidas)})]}),(0,u.jsxs)("div",{className:"kpi-mini",children:[(0,u.jsx)("span",{className:"kpi-mini-label",children:"Participantes"}),(0,u.jsx)("strong",{className:"kpi-mini-value",children:q(null===(l=B.kpis)||void 0===l?void 0:l.proveedoresParticipantes)})]}),(0,u.jsxs)("div",{className:"kpi-mini",children:[(0,u.jsx)("span",{className:"kpi-mini-label",children:"Ganadores"}),(0,u.jsx)("strong",{className:"kpi-mini-value",children:q(null===(c=B.kpis)||void 0===c?void 0:c.proveedoresGanadores)})]}),(0,u.jsxs)("div",{className:"kpi-mini",children:[(0,u.jsx)("span",{className:"kpi-mini-label",children:"Adjudicado"}),(0,u.jsx)("strong",{className:"kpi-mini-value",children:K(null===(d=B.kpis)||void 0===d?void 0:d.montoAdjudicado)})]})]})]}),(0,u.jsxs)("div",{className:"kpi-grid-enhanced",children:[(0,u.jsxs)("div",{className:"kpi-card-enhanced",children:[(0,u.jsx)("div",{className:"kpi-enhanced-header",children:(0,u.jsx)("div",{className:"kpi-enhanced-icon",children:"\ud83c\udfc6"})}),(0,u.jsx)("div",{className:"kpi-enhanced-label",children:"\xcdndice de Competencia"}),(0,u.jsxs)("div",{className:"kpi-enhanced-value",children:[he.competitionIndex,"%"]}),(0,u.jsx)("div",{className:"kpi-enhanced-trend ".concat(he.competitionIndex>50?"positive":"neutral"),children:he.competitionIndex>50?"\u2191 Alta competencia":"\u2192 Media competencia"})]}),(0,u.jsxs)("div",{className:"kpi-card-enhanced",children:[(0,u.jsx)("div",{className:"kpi-enhanced-header",children:(0,u.jsx)("div",{className:"kpi-enhanced-icon",children:"\ud83d\udcb0"})}),(0,u.jsx)("div",{className:"kpi-enhanced-label",children:"Ahorro Obtenido"}),(0,u.jsxs)("div",{className:"kpi-enhanced-value",children:[he.savings.toFixed(1),"%"]}),(0,u.jsx)("div",{className:"kpi-enhanced-trend ".concat(he.savings>0?"positive":"negative"),children:he.savings>0?"\u2191 Bajo presupuesto":"\u2193 Sobre presupuesto"})]}),(0,u.jsxs)("div",{className:"kpi-card-enhanced",children:[(0,u.jsx)("div",{className:"kpi-enhanced-header",children:(0,u.jsx)("div",{className:"kpi-enhanced-icon",children:"\u23f1\ufe0f"})}),(0,u.jsx)("div",{className:"kpi-enhanced-label",children:"Tiempo de Respuesta"}),(0,u.jsxs)("div",{className:"kpi-enhanced-value",children:[he.avgResponseTime," d\xedas"]}),(0,u.jsx)("div",{className:"kpi-enhanced-trend ".concat(he.avgResponseTime<15?"positive":"neutral"),children:he.avgResponseTime<15?"\u2191 R\xe1pido":"\u2192 Normal"})]}),(0,u.jsxs)("div",{className:"kpi-card-enhanced",children:[(0,u.jsx)("div",{className:"kpi-enhanced-header",children:(0,u.jsx)("div",{className:"kpi-enhanced-icon",children:"\u2705"})}),(0,u.jsx)("div",{className:"kpi-enhanced-label",children:"Cumplimiento"}),(0,u.jsxs)("div",{className:"kpi-enhanced-value",children:[he.compliance,"%"]}),(0,u.jsx)("div",{className:"kpi-enhanced-trend ".concat(he.compliance>80?"positive":"neutral"),children:he.compliance>80?"\u2191 Excelente":"\u2192 Aceptable"})]})]}),(0,u.jsxs)("div",{className:"tab-nav",children:[(0,u.jsx)("button",{className:"tab-btn ".concat("overview"===U?"active":""),onClick:()=>G("overview"),children:"\ud83d\udcca Vista General"}),(0,u.jsx)("button",{className:"tab-btn ".concat("offers"===U?"active":""),onClick:()=>G("offers"),children:"\ud83d\udcbc Ofertas y Competencia"}),(0,u.jsx)("button",{className:"tab-btn ".concat("timeline"===U?"active":""),onClick:()=>G("timeline"),children:"\u23f1\ufe0f L\xednea de Tiempo"}),(0,u.jsx)("button",{className:"tab-btn ".concat("contracts"===U?"active":""),onClick:()=>G("contracts"),children:"\ud83d\udcc3 Contratos y Ejecuci\xf3n"})]}),"overview"===U&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{className:"chart-card",children:[(0,u.jsx)("h3",{children:"\ud83d\udce6 L\xedneas del Cartel"}),(0,u.jsx)(Ae,{data:B.lineas||[],columns:ee,height:340,resizable:!0})]}),(0,u.jsxs)("div",{className:"chart-grid",children:[(0,u.jsxs)("div",{className:"chart-card",children:[(0,u.jsx)("h3",{children:"\ud83d\udce8 An\xe1lisis de L\xedneas Recibidas"}),(0,u.jsx)(Ae,{data:B.lineasRecibidas||[],columns:ne,height:280})]}),(0,u.jsxs)("div",{className:"chart-card",children:[(0,u.jsx)("h3",{children:"\ud83d\udcdd An\xe1lisis de L\xedneas Ofertadas"}),(0,u.jsx)(Ae,{data:B.lineasOfertadas||[],columns:oe,height:280})]})]})]}),"offers"===U&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{className:"chart-grid",children:[(0,u.jsxs)("div",{className:"chart-card",children:[(0,u.jsx)("h3",{children:"\ud83d\udcca Comparaci\xf3n de Ofertas"}),(0,u.jsx)(v.u,{width:"100%",height:320,children:(0,u.jsxs)(_.E,{data:ce,margin:{top:20,right:30,left:20,bottom:60},children:[(0,u.jsx)("defs",{children:(0,u.jsxs)("linearGradient",{id:"offerGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,u.jsx)("stop",{offset:"0%",stopColor:"#667eea",stopOpacity:.9}),(0,u.jsx)("stop",{offset:"100%",stopColor:"#764ba2",stopOpacity:.7})]})}),(0,u.jsx)(Fe.d,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),(0,u.jsx)(y.W,{dataKey:"proveedor",angle:-45,textAnchor:"end",height:80,tick:{fill:"#6b7280",fontSize:12}}),(0,u.jsx)(N.h,{tick:{fill:"#6b7280",fontSize:12}}),(0,u.jsx)(C.m,{contentStyle:{background:"rgba(255, 255, 255, 0.95)",border:"1px solid #e5e7eb",borderRadius:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},formatter:e=>K(e)}),(0,u.jsx)(De.s,{}),(0,u.jsx)(A.y,{dataKey:"monto",fill:"url(#offerGradient)",name:"Monto Oferta",radius:[8,8,0,0]})]})})]}),(0,u.jsxs)("div",{className:"chart-card",children:[(0,u.jsx)("h3",{children:"\ud83c\udfaf Distribuci\xf3n por Proveedor"}),(0,u.jsx)(v.u,{width:"100%",height:320,children:(0,u.jsxs)(k.r,{children:[(0,u.jsx)(S.F,{data:de,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:100,label:e=>"".concat(e.name,": ").concat(e.value),children:de.map((e,a)=>(0,u.jsx)(M.f,{fill:$.categorical[a%$.categorical.length]},"cell-".concat(a)))}),(0,u.jsx)(C.m,{contentStyle:{background:"rgba(255, 255, 255, 0.95)",border:"1px solid #e5e7eb",borderRadius:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"}})]})})]})]}),(0,u.jsxs)("div",{className:"chart-grid",children:[(0,u.jsxs)("div",{className:"table-card",children:[(0,u.jsxs)("h3",{children:["\ud83d\udcbc Ofertas Recibidas",(0,u.jsx)("span",{className:"table-badge",children:(null===(p=B.ofertas)||void 0===p?void 0:p.length)||0})]}),(0,u.jsx)(Ae,{data:B.ofertas||[],columns:ae,height:320})]}),(0,u.jsxs)("div",{className:"table-card",children:[(0,u.jsxs)("h3",{children:["\ud83c\udfc6 Adjudicaciones",(0,u.jsx)("span",{className:"table-badge",children:(null===(h=B.lineasAdjudicadas)||void 0===h?void 0:h.length)||0})]}),(0,u.jsx)(Ae,{data:B.lineasAdjudicadas||[],columns:te,height:320})]})]})]}),"timeline"===U&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{className:"chart-card",children:[(0,u.jsx)("h3",{children:"\u23f1\ufe0f L\xednea de Tiempo del Proceso"}),(0,u.jsx)(Ne,{data:B.timeline,title:"Hitos del Proceso",valueFormat:"number",height:280,showBrush:!1}),null!=(null===(m=B.kpis)||void 0===m?void 0:m.ttaDias)&&(0,u.jsxs)("div",{style:{marginTop:16,padding:"16px",background:"rgba(102, 126, 234, 0.05)",borderRadius:"12px",color:"#6b7280",fontWeight:600},children:["\u23f1\ufe0f TTA (Apertura \u2192 Adjudicaci\xf3n): ",(0,u.jsxs)("strong",{style:{color:"#667eea",fontSize:"18px"},children:[B.kpis.ttaDias," d\xedas"]})]})]}),pe.length>0&&(0,u.jsxs)("div",{className:"chart-card",children:[(0,u.jsx)("h3",{children:"\ud83d\udcc8 Progreso por Fase"}),(0,u.jsx)(v.u,{width:"100%",height:300,children:(0,u.jsxs)(j.Q,{data:pe,margin:{top:10,right:30,left:0,bottom:0},children:[(0,u.jsx)("defs",{children:(0,u.jsxs)("linearGradient",{id:"timelineGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,u.jsx)("stop",{offset:"0%",stopColor:"#667eea",stopOpacity:.3}),(0,u.jsx)("stop",{offset:"100%",stopColor:"#764ba2",stopOpacity:.05})]})}),(0,u.jsx)(Fe.d,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),(0,u.jsx)(y.W,{dataKey:"fase",tick:{fill:"#6b7280",fontSize:11},angle:-20,textAnchor:"end",height:80}),(0,u.jsx)(N.h,{tick:{fill:"#6b7280",fontSize:12},label:{value:"D\xedas",angle:-90,position:"insideLeft"}}),(0,u.jsx)(C.m,{contentStyle:{background:"rgba(255, 255, 255, 0.95)",border:"1px solid #e5e7eb",borderRadius:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"}}),(0,u.jsx)(w.Gk,{type:"monotone",dataKey:"dias",stroke:"#667eea",strokeWidth:3,fill:"url(#timelineGradient)",name:"D\xedas transcurridos"})]})})]})]}),"contracts"===U&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{className:"chart-grid",children:[(0,u.jsxs)("div",{className:"table-card",children:[(0,u.jsxs)("h3",{children:["\ud83d\udcc3 Contratos",(0,u.jsx)("span",{className:"table-badge",children:(null===(x=B.contratos)||void 0===x?void 0:x.length)||0})]}),(0,u.jsx)(Ae,{data:B.contratos||[],columns:ie,height:300})]}),(0,u.jsxs)("div",{className:"table-card",children:[(0,u.jsxs)("h3",{children:["\ud83e\uddfe \xd3rdenes de Compra",(0,u.jsx)("span",{className:"table-badge",children:(null===(g=B.ordenes)||void 0===g?void 0:g.length)||0})]}),(0,u.jsx)(Ae,{data:B.ordenes||[],columns:se,height:300})]})]}),(0,u.jsxs)("div",{className:"chart-grid",children:[(0,u.jsxs)("div",{className:"table-card",children:[(0,u.jsxs)("h3",{children:["\ud83d\udce6 Recepciones",(0,u.jsx)("span",{className:"table-badge",children:(null===(f=B.recepciones)||void 0===f?void 0:f.length)||0})]}),(0,u.jsx)(Ae,{data:B.recepciones||[],columns:re,height:300})]}),(0,u.jsxs)("div",{className:"table-card",children:[(0,u.jsxs)("h3",{children:["\ud83d\udee1\ufe0f Garant\xedas",(0,u.jsx)("span",{className:"table-badge",children:(null===(b=B.garantias)||void 0===b?void 0:b.length)||0})]}),(0,u.jsx)(Ae,{data:B.garantias||[],columns:le,height:300})]})]}),(0,u.jsxs)("div",{className:"chart-grid",children:[(0,u.jsxs)("div",{className:"table-card",children:[(0,u.jsxs)("h3",{children:["\u2696\ufe0f Recursos / Objeciones",(0,u.jsx)("span",{className:"table-badge",children:(null===(T=B.recursos)||void 0===T?void 0:T.length)||0})]}),(0,u.jsx)(Ae,{data:B.recursos||[],columns:me,height:280})]}),(0,u.jsxs)("div",{className:"table-card",children:[(0,u.jsxs)("h3",{children:["\ud83d\udd01 Reajustes de Precios",(0,u.jsx)("span",{className:"table-badge",children:(null===(z=B.reajustes)||void 0===z?void 0:z.length)||0})]}),(0,u.jsx)(Ae,{data:B.reajustes||[],columns:xe,height:280})]})]})]})]})]})};var Ee=t(1397),We=t.n(Ee),Be=t(6615);const Oe=e=>new Intl.NumberFormat("es-CR",{style:"currency",currency:"CRC"}).format(e),He=(e,a)=>{if(!a||0===a.length)return[{text:e,highlighted:!1}];const t=[];let i=0;const s=new RegExp("(".concat(a.map(e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).join("|"),")"),"gi");return[...e.matchAll(s)].forEach(a=>{void 0!==a.index&&(a.index>i&&t.push({text:e.slice(i,a.index),highlighted:!1}),t.push({text:a[0],highlighted:!0}),i=a.index+a[0].length)}),i<e.length&&t.push({text:e.slice(i),highlighted:!1}),t.length>0?t:[{text:e,highlighted:!1}]},Ye={display:"inline-block",padding:"4px 12px",borderRadius:20,fontSize:12,fontWeight:600,margin:"2px 4px"},Ue={background:"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)",borderRadius:12,boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",border:"1px solid rgba(226, 232, 240, 0.8)",padding:24,marginBottom:20,transition:"all 0.3s ease"};function Ge(e){let{category:a,onClose:t}=e;const[s,n]=(0,i.useState)(0),[o,l]=(0,i.useState)(new Set),c=20,d=Math.ceil(a.ejemplos.length/c),p=a.ejemplos.slice(s*c,(s+1)*c),h=e=>{l(a=>{const t=new Set(a);return t.has(e)?t.delete(e):t.add(e),t})};return(0,u.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,padding:20},onClick:t,children:(0,u.jsxs)("div",{style:{background:"white",borderRadius:16,width:"90%",maxWidth:1200,maxHeight:"90vh",overflow:"auto",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",position:"relative"},onClick:e=>e.stopPropagation(),children:[(0,u.jsx)("div",{style:{background:"linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%)",color:"white",padding:24,borderRadius:"16px 16px 0 0",position:"sticky",top:0,zIndex:10},children:(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("h2",{style:{margin:"0 0 8px 0",fontSize:28,fontWeight:700},children:a.categoria}),(0,u.jsxs)("div",{style:{display:"flex",gap:16,opacity:.95},children:[(0,u.jsxs)("span",{children:["\ud83d\udcca ",a.totalLineas.toLocaleString()," licitaciones"]}),(0,u.jsxs)("span",{children:["\ud83d\udcb0 ",Oe(a.montoTotal)]}),(0,u.jsxs)("span",{children:["\ud83d\udcc8 ",(m=a.porcentaje,"".concat(m.toFixed(1),"%"))," del total"]})]})]}),(0,u.jsx)("button",{onClick:t,style:{background:"rgba(255, 255, 255, 0.2)",border:"none",color:"white",fontSize:32,cursor:"pointer",borderRadius:"50%",width:48,height:48,display:"flex",alignItems:"center",justifyContent:"center",transition:"background 0.3s ease"},onMouseEnter:e=>e.currentTarget.style.background="rgba(255, 255, 255, 0.3)",onMouseLeave:e=>e.currentTarget.style.background="rgba(255, 255, 255, 0.2)",children:"\xd7"})]})}),(0,u.jsxs)("div",{style:{padding:24},children:[(0,u.jsxs)("div",{style:(0,r.A)((0,r.A)({},Ue),{},{background:"linear-gradient(135deg, #ecfccb 0%, #d9f99d 100%)",marginBottom:24}),children:[(0,u.jsx)("h3",{style:{margin:"0 0 12px 0",fontSize:18,fontWeight:700,color:"#365314"},children:"\ud83d\udd0d Palabras Clave que Definen esta Categor\xeda"}),(0,u.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:Array.from(new Set(a.ejemplos.flatMap(e=>e.palabrasCoincidentes))).map(e=>(0,u.jsx)("span",{style:(0,r.A)((0,r.A)({},Ye),{},{background:"#22c55e",color:"white",fontSize:14,padding:"8px 16px",fontWeight:700,boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"}),children:e},e))})]}),(0,u.jsxs)("div",{children:[(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[(0,u.jsx)("h3",{style:{margin:0,fontSize:20,fontWeight:700},children:"\ud83d\udccb Ejemplos de Licitaciones Clasificadas"}),(0,u.jsxs)("div",{style:{fontSize:14,color:"#6b7280"},children:["Mostrando ",s*c+1," - ",Math.min((s+1)*c,a.ejemplos.length)," de ",a.ejemplos.length]})]}),(0,u.jsx)("div",{style:{display:"grid",gap:16},children:p.map((e,a)=>{var t;const i=s*c+a,n=o.has(i);return(0,u.jsxs)("div",{style:{background:"#ffffff",border:"2px solid #e5e7eb",borderRadius:12,padding:20,transition:"all 0.3s ease",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"},children:[(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:12},children:[(0,u.jsxs)("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[(0,u.jsx)("span",{style:{background:"linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%)",color:"white",padding:"6px 12px",borderRadius:8,fontWeight:700,fontSize:14},children:e.numeroCartel}),(0,u.jsx)("span",{style:{background:"#f3f4f6",color:"#374151",padding:"6px 12px",borderRadius:8,fontSize:12,fontWeight:600},children:e.codigoInstitucion}),(0,u.jsx)("span",{style:{background:"cartel"===e.tipoCoincidencia?"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)":"linear-gradient(135deg, #10b981 0%, #059669 100%)",color:"white",padding:"6px 12px",borderRadius:8,fontSize:11,fontWeight:700},children:"cartel"===e.tipoCoincidencia?"\ud83d\udccb Cartel completo":"\ud83d\udcc4 L\xedneas espec\xedficas"})]}),e.presupuestoLinea&&(0,u.jsx)("span",{style:{background:"#dcfce7",color:"#166534",padding:"6px 12px",borderRadius:8,fontWeight:700,fontSize:14},children:Oe(e.presupuestoLinea)})]}),"cartel"===e.tipoCoincidencia?(0,u.jsxs)("div",{children:[(0,u.jsxs)("div",{style:{fontSize:15,lineHeight:1.6,color:"#1f2937",marginBottom:12,background:"#fef3c7",padding:16,borderRadius:8,borderLeft:"4px solid #f59e0b"},children:[(0,u.jsx)("div",{style:{fontWeight:600,marginBottom:8,color:"#92400e"},children:"\ud83c\udfaf Coincidencia detectada en los datos del cartel"}),He(e.descripcionLinea,e.palabrasCoincidentes).map((e,a)=>(0,u.jsx)("span",{style:{background:e.highlighted?"#f59e0b":"transparent",color:e.highlighted?"white":"#1f2937",fontWeight:e.highlighted?700:400,padding:e.highlighted?"2px 6px":"0",borderRadius:e.highlighted?4:0,boxShadow:e.highlighted?"0 2px 4px rgba(245, 158, 11, 0.3)":"none"},children:e.text},a))]}),e.todasLasLineas&&e.todasLasLineas.length>0&&(0,u.jsxs)("div",{style:{marginTop:12},children:[(0,u.jsx)("button",{onClick:()=>h(i),style:{background:n?"#f59e0b":"#fef3c7",color:n?"white":"#92400e",border:"none",borderRadius:8,padding:"8px 16px",cursor:"pointer",fontWeight:600,fontSize:13,width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},children:(0,u.jsxs)("span",{children:[n?"\u25bc":"\u25b6"," Ver todas las l\xedneas del cartel (",e.todasLasLineas.length,")"]})}),n&&(0,u.jsx)("div",{style:{marginTop:12,maxHeight:400,overflow:"auto",background:"#fffbeb",borderRadius:8,padding:12},children:e.todasLasLineas.map((e,a)=>(0,u.jsxs)("div",{style:{background:"white",padding:12,marginBottom:8,borderRadius:6,borderLeft:"3px solid #fbbf24",fontSize:13},children:[(0,u.jsxs)("div",{style:{fontWeight:600,color:"#92400e",marginBottom:4},children:["L\xednea ",a+1]}),(0,u.jsx)("div",{style:{color:"#374151",marginBottom:6},children:e.descripcion}),e.presupuesto>0&&(0,u.jsx)("div",{style:{fontSize:12,color:"#059669",fontWeight:600},children:Oe(e.presupuesto)})]},a))})]})]}):(0,u.jsxs)("div",{children:[(0,u.jsxs)("div",{style:{fontSize:14,fontWeight:600,marginBottom:12,color:"#059669",background:"#d1fae5",padding:12,borderRadius:8,borderLeft:"4px solid #10b981"},children:["\u2705 Coincidencias encontradas en l\xedneas espec\xedficas (",(null===(t=e.lineasCoincidentes)||void 0===t?void 0:t.length)||0," l\xedneas)"]}),e.lineasCoincidentes&&e.lineasCoincidentes.length>0&&(0,u.jsxs)("div",{style:{display:"grid",gap:12,maxHeight:n?"none":300,overflow:n?"visible":"auto",background:"#ecfdf5",borderRadius:8,padding:12},children:[(n?e.lineasCoincidentes:e.lineasCoincidentes.slice(0,2)).map((e,a)=>(0,u.jsxs)("div",{style:{background:"white",padding:14,borderRadius:8,borderLeft:"4px solid #22c55e",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"},children:[(0,u.jsxs)("div",{style:{fontWeight:600,color:"#166534",marginBottom:8,fontSize:13},children:["\ud83d\udccc L\xednea coincidente ",a+1]}),(0,u.jsx)("div",{style:{fontSize:14,lineHeight:1.5,color:"#1f2937",marginBottom:8},children:He(e.descripcion,e.palabrasEncontradas).map((e,a)=>(0,u.jsx)("span",{style:{background:e.highlighted?"#22c55e":"transparent",color:e.highlighted?"white":"#1f2937",fontWeight:e.highlighted?700:400,padding:e.highlighted?"2px 6px":"0",borderRadius:e.highlighted?4:0,boxShadow:e.highlighted?"0 2px 4px rgba(34, 197, 94, 0.3)":"none"},children:e.text},a))}),e.presupuesto>0&&(0,u.jsxs)("div",{style:{fontSize:12,color:"#059669",fontWeight:600},children:["\ud83d\udcb0 ",Oe(e.presupuesto)]}),(0,u.jsx)("div",{style:{display:"flex",gap:6,flexWrap:"wrap",marginTop:8},children:e.palabrasEncontradas.map(e=>(0,u.jsxs)("span",{style:(0,r.A)((0,r.A)({},Ye),{},{background:"#22c55e",color:"white",fontSize:10,padding:"3px 8px"}),children:["\u2713 ",e]},e))})]},a)),e.lineasCoincidentes.length>2&&(0,u.jsx)("button",{onClick:()=>h(i),style:{background:n?"#10b981":"#d1fae5",color:n?"white":"#059669",border:"none",borderRadius:8,padding:"10px 16px",cursor:"pointer",fontWeight:600,fontSize:13},children:n?"\u25b2 Mostrar menos":"\u25bc Ver ".concat(e.lineasCoincidentes.length-2," l\xedneas m\xe1s")})]})]}),(0,u.jsxs)("div",{style:{display:"flex",gap:6,flexWrap:"wrap",marginTop:12,paddingTop:12,borderTop:"1px solid #e5e7eb"},children:[(0,u.jsx)("span",{style:{fontSize:12,color:"#6b7280",fontWeight:600},children:"Palabras clave detectadas en este cartel:"}),e.palabrasCoincidentes.map(a=>(0,u.jsxs)("span",{style:(0,r.A)((0,r.A)({},Ye),{},{background:"cartel"===e.tipoCoincidencia?"#f59e0b":"#22c55e",color:"white",fontSize:11,padding:"4px 10px"}),children:["\u2713 ",a]},a))]})]},a)})}),d>1&&(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:12,marginTop:24,padding:20,background:"#f9fafb",borderRadius:12},children:[(0,u.jsx)("button",{onClick:()=>n(Math.max(0,s-1)),disabled:0===s,style:{background:0===s?"#e5e7eb":"#3b82f6",color:0===s?"#9ca3af":"white",border:"none",borderRadius:8,padding:"10px 20px",cursor:0===s?"not-allowed":"pointer",fontWeight:600,fontSize:14},children:"\u2190 Anterior"}),(0,u.jsx)("div",{style:{display:"flex",gap:6},children:Array.from({length:Math.min(d,7)},(e,a)=>{let t;return t=d<=7||s<3?a:s>d-4?d-7+a:s-3+a,(0,u.jsx)("button",{onClick:()=>n(t),style:{background:s===t?"#3b82f6":"white",color:s===t?"white":"#374151",border:s===t?"none":"1px solid #d1d5db",borderRadius:8,padding:"8px 14px",cursor:"pointer",fontWeight:s===t?700:600,fontSize:14,minWidth:40},children:t+1},t)})}),(0,u.jsx)("button",{onClick:()=>n(Math.min(d-1,s+1)),disabled:s===d-1,style:{background:s===d-1?"#e5e7eb":"#3b82f6",color:s===d-1?"#9ca3af":"white",border:"none",borderRadius:8,padding:"10px 20px",cursor:s===d-1?"not-allowed":"pointer",fontWeight:600,fontSize:14},children:"Siguiente \u2192"})]})]})]}),(0,u.jsxs)("div",{style:{padding:24,borderTop:"2px solid #e5e7eb",background:"#f9fafb",borderRadius:"0 0 16px 16px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,u.jsxs)("div",{style:{fontSize:14,color:"#6b7280"},children:["\ud83d\udca1 Las palabras en ",(0,u.jsx)("span",{style:{background:"#22c55e",color:"white",padding:"2px 8px",borderRadius:4,fontWeight:700},children:"verde"})," son las que identificaron esta categor\xeda"]}),(0,u.jsx)("button",{onClick:t,style:{background:"linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%)",color:"white",border:"none",borderRadius:8,padding:"12px 24px",cursor:"pointer",fontWeight:600,fontSize:16},children:"Cerrar"})]})]})});var m}var Ve=t(724);const Ze=["score","textos"],qe=(0,r.A)((0,r.A)({},Ve.S2),{},{background:"linear-gradient(135deg, #1e3a8a 0%, #0c4a6e 100%)",color:"white",textAlign:"center"}),Ke=(0,r.A)((0,r.A)({},Ve.S2),{},{cursor:"pointer"}),Xe={display:"inline-block",padding:"4px 12px",borderRadius:20,fontSize:12,fontWeight:600,margin:"2px 4px"},Je=(0,r.A)((0,r.A)({},Xe),{},{background:"#dcfce7",color:"#166534"}),Qe=(0,r.A)((0,r.A)({},Xe),{},{background:"#fef3c7",color:"#92400e"}),$e=(0,r.A)((0,r.A)({},Xe),{},{background:"#dbeafe",color:"#1e40af"});function ea(){const{isLoaded:e}=(0,s.M)(),[a,t]=(0,i.useState)(null),[o,l]=(0,i.useState)(null),[c,d]=(0,i.useState)(!1),[p,h]=(0,i.useState)(0),[m,x]=(0,i.useState)(""),[g,f]=(0,i.useState)(!1),[b,v]=(0,i.useState)(null),j=async()=>{if(e){d(!0),h(0);try{var a;console.log("[CategoryAnalysisView] \ud83d\udd0d Obteniendo datos de DataManager...");const e=(null===(a=n.M.getDashboardMetrics)||void 0===a?void 0:a.call(n.M,{}))||null;if(console.log("[CategoryAnalysisView] Datos recibidos:",e),null===e||void 0===e||!e.sector_analysis)return console.warn("[CategoryAnalysisView] No hay sector_analysis en dashboardData"),void t({totalLineas:0,totalMonto:0,cobertura:0,categorias:[],sinCategorizar:{lineas:0,ejemplos:[]}});const i=e.sector_analysis;console.log("[CategoryAnalysisView] sector_analysis:",i);const s=async e=>{try{console.log("[CategoryAnalysisView] \ud83d\udd0d Buscando ejemplos para: ".concat(e));const a=n.M.obtenerDatos("DetalleLineaCartel")||[],t=n.M.obtenerDatos("DetalleCarteles")||[],i=new Map(t.map(e=>[e.numeroCartel,e])),s={};a.forEach(e=>{e.numeroCartel&&(s[e.numeroCartel]||(s[e.numeroCartel]=[]),s[e.numeroCartel].push(e))});const r=n.M.getSectorRules(),o=r[e]||[];if(0===o.length)return console.warn("[CategoryAnalysisView] \u26a0\ufe0f No hay reglas para sector: ".concat(e)),[];console.log("[CategoryAnalysisView] Reglas para ".concat(e,":"),o.length);const l=e=>(e||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim(),c=e=>{const a={},t={},n={},o={},c={},d={};Object.keys(r).forEach(e=>{a[e]=0,o[e]=0,c[e]=0,t[e]=new Set,n[e]=[],d[e]=[]});const p=function(e,i){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],p=arguments.length>3?arguments[3]:void 0;e&&Object.entries(r).forEach(r=>{let[h,m]=r;const x=l(e),g=[];let u=0;for(const e of m)if(e.test(x)){u++;const a=x.match(e);if(a&&a[0]){const e=a[0].trim();e&&!g.includes(e)&&(g.push(e),t[h].add(e))}}u>0&&(a[h]+=u,s?(c[h]+=u,p&&d[h].push({descripcion:p.descripcionLinea||"",presupuesto:p.presupuestoLinea||0,palabrasEncontradas:g})):o[h]+=u,n[h].push({fuente:i,texto:e.substring(0,200),coincidencias:g}))})};(s[e]||[]).forEach((e,a)=>{p(e.descripcionLinea,"L\xednea ".concat(a+1),!0,e)});const h=i.get(e);h&&(p(h.nombreCartel,"Nombre del cartel",!1),p(h.descripcionCartel,"Descripci\xf3n del cartel",!1),p(h.clasificacionObjeto,"Clasificaci\xf3n del objeto",!1));const m=Object.entries(a).filter(e=>{let[a,t]=e;return t>0}).sort((e,a)=>a[1]-e[1]);if(0===m.length)return{sector:"Otros",score:0,coincidencias:[],textos:[],tipoCoincidencia:"cartel",lineasConCoincidencias:[]};const[x,g]=m[0],u=c[x]>o[x]?"lineas":"cartel";return{sector:x,score:g,coincidencias:Array.from(t[x]),textos:n[x],tipoCoincidencia:u,lineasConCoincidencias:d[x]}},d=[],p=new Set(Object.keys(s).concat(t.map(e=>e.numeroCartel).filter(Boolean))),h=Array.from(p);console.log("[CategoryAnalysisView] \ud83d\udce6 Procesando ".concat(h.length," carteles en lotes para ").concat(e,"..."));const m=100,x=a=>{const t=c(a);if(t.sector===e&&t.score>0){const e=i.get(a),r=s[a]||[];let n="";n="lineas"===t.tipoCoincidencia&&t.lineasConCoincidencias.length>0?t.lineasConCoincidencias[0].descripcion:null!==e&&void 0!==e&&e.nombreCartel?e.nombreCartel:null!==e&&void 0!==e&&e.descripcionCartel?e.descripcionCartel:r.length>0&&r[0].descripcionLinea?r[0].descripcionLinea:"Sin descripci\xf3n disponible";const o={numeroCartel:a,descripcionLinea:n,presupuestoLinea:r.reduce((e,a)=>e+(a.presupuestoLinea||0),0),codigoInstitucion:(null===e||void 0===e?void 0:e.codigoInstitucion)||"",palabrasCoincidentes:t.coincidencias,tipoCoincidencia:t.tipoCoincidencia,score:t.score,textos:t.textos};return"lineas"===t.tipoCoincidencia?o.lineasCoincidentes=t.lineasConCoincidencias:o.todasLasLineas=r.map(e=>({descripcion:e.descripcionLinea||"",presupuesto:e.presupuestoLinea||0})),o}return null};for(let e=0;e<h.length;e+=m){const a=h.slice(e,e+m).map(x).filter(Boolean);d.push(...a),e+m<h.length&&await new Promise(e=>setTimeout(e,0))}return console.log("[CategoryAnalysisView] \u2705 Encontrados ".concat(d.length," ejemplos para ").concat(e)),d.sort((e,a)=>a.score-e.score).slice(0,50).map(e=>{let{score:a,textos:t}=e;return(0,ce.A)(e,Ze)})}catch(a){return console.error("[CategoryAnalysisView] \u274c Error obteniendo ejemplos para ".concat(e,":"),a),[]}},r=i.reduce((e,a)=>e+a.count,0),o=i.reduce((e,a)=>e+a.total_monto,0),l=i.find(e=>"Sin categorizar"===e.sector||"Otros"===e.sector),c=(null===l||void 0===l?void 0:l.count)||0,d=r>0?(r-c)/r*100:0,p=i.filter(e=>"Sin categorizar"!==e.sector&&"Otros"!==e.sector),m=[];console.log("[CategoryAnalysisView] \ud83d\udce6 Procesando ".concat(p.length," categor\xedas..."));for(let a=0;a<p.length;a++){const e=p[a],t=Math.round((a+1)/p.length*100);h(t),console.log("[CategoryAnalysisView] [".concat(a+1,"/").concat(p.length,"] Procesando: ").concat(e.sector));const i=await s(e.sector);console.log('[CategoryAnalysisView] Sector "'.concat(e.sector,'": ').concat(i.length," ejemplos")),m.push({categoria:e.sector,totalLineas:e.count,porcentaje:e.percentage,montoTotal:e.total_monto,ejemplos:i,instituciones:[],tendenciaMensual:[]}),await new Promise(e=>setTimeout(e,0))}console.log("[CategoryAnalysisView] \u2705 Categor\xedas procesadas:",m.length),t({totalLineas:r,totalMonto:o,cobertura:d,categorias:m,sinCategorizar:{lineas:c,ejemplos:[]}})}catch(i){console.error("[CategoryAnalysisView] \u274c Error analizando categor\xedas:",i)}finally{d(!1),h(0)}}};(0,i.useEffect)(()=>{e&&j()},[e]),(0,i.useEffect)(()=>{if(!e||"undefined"===typeof window)return;const a=()=>{console.log("[CategoryAnalysisView] \ud83d\udd04 Configuraci\xf3n actualizada, refrescando..."),j()};return window.addEventListener("categoryConfigurationUpdated",a),window.addEventListener("manualCategoriesUpdated",a),window.addEventListener("subcategoryConfigurationUpdated",a),()=>{window.removeEventListener("categoryConfigurationUpdated",a),window.removeEventListener("manualCategoriesUpdated",a),window.removeEventListener("subcategoryConfigurationUpdated",a)}},[e]);const y=(0,i.useMemo)(()=>{if(!a||!m)return(null===a||void 0===a?void 0:a.categorias)||[];const e=m.toLowerCase();return a.categorias.filter(a=>a.categoria.toLowerCase().includes(e)||a.ejemplos.some(a=>a.descripcionLinea.toLowerCase().includes(e)))},[a,m]);return e?c?(0,u.jsx)("div",{style:Ve.S2,children:(0,u.jsxs)("div",{style:{textAlign:"center",padding:40},children:[(0,u.jsx)("div",{style:{fontSize:18,color:"#6b7280",marginBottom:16},children:"Analizando categor\xedas del sistema..."}),p>0&&(0,u.jsxs)("div",{style:{fontSize:14,color:"#9ca3af",marginBottom:12},children:["Procesando: ",p,"%"]}),(0,u.jsx)("div",{style:{width:200,height:4,background:"#e5e7eb",margin:"0 auto",borderRadius:2,overflow:"hidden"},children:(0,u.jsx)("div",{style:{width:p>0?"".concat(p,"%"):"60%",height:"100%",background:"linear-gradient(90deg, #3b82f6, #8b5cf6)",transition:"width 0.3s ease",animation:0===p?"pulse 2s infinite":"none"}})}),(0,u.jsx)("div",{style:{marginTop:16,fontSize:12,color:"#9ca3af",fontStyle:"italic"},children:"Procesando en lotes para evitar bloqueos..."})]})}):a?(0,u.jsxs)("div",{children:[g&&b&&(0,u.jsx)(Ge,{category:b,onClose:()=>{f(!1),v(null)}}),(0,u.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:16,marginBottom:24},children:[(0,u.jsxs)("div",{style:qe,children:[(0,u.jsx)("div",{style:{fontSize:32,fontWeight:700,marginBottom:8},children:a.categorias.length}),(0,u.jsx)("div",{style:{opacity:.9},children:"Categor\xedas Activas"})]}),(0,u.jsxs)("div",{style:qe,children:[(0,u.jsx)("div",{style:{fontSize:32,fontWeight:700,marginBottom:8},children:(0,Ve.l9)(a.cobertura)}),(0,u.jsx)("div",{style:{opacity:.9},children:"Cobertura Total"})]}),(0,u.jsxs)("div",{style:qe,children:[(0,u.jsx)("div",{style:{fontSize:32,fontWeight:700,marginBottom:8},children:a.totalLineas.toLocaleString()}),(0,u.jsx)("div",{style:{opacity:.9},children:"L\xedneas Analizadas"})]}),(0,u.jsxs)("div",{style:qe,children:[(0,u.jsx)("div",{style:{fontSize:32,fontWeight:700,marginBottom:8},children:a.sinCategorizar.lineas.toLocaleString()}),(0,u.jsx)("div",{style:{opacity:.9},children:"Sin Categorizar"})]})]}),(0,u.jsx)("div",{style:Ve.S2,children:(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16},children:[(0,u.jsx)("div",{style:{flex:1},children:(0,u.jsx)("input",{type:"text",placeholder:"Buscar categor\xedas o ejemplos...",value:m,onChange:e=>x(e.target.value),style:{width:"100%",padding:"12px 16px",border:"2px solid #e5e7eb",borderRadius:8,fontSize:16,transition:"border-color 0.3s ease"}})}),(0,u.jsx)("button",{onClick:j,style:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",color:"white",border:"none",borderRadius:8,padding:"12px 20px",cursor:"pointer",fontWeight:600},children:"Actualizar"})]})}),(0,u.jsxs)("div",{style:{display:"grid",gridTemplateColumns:o?"1fr 1fr":"1fr",gap:20},children:[(0,u.jsx)("div",{children:y.map((e,a)=>(0,u.jsxs)("div",{style:(0,r.A)((0,r.A)({},Ke),{},{background:(null===o||void 0===o?void 0:o.categoria)===e.categoria?"linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%)":Ve.S2.background}),onClick:()=>l((null===o||void 0===o?void 0:o.categoria)===e.categoria?null:e),children:[(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:16},children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("h3",{style:{margin:"0 0 8px 0",fontSize:20,fontWeight:700,color:"#1f2937"},children:e.categoria}),(0,u.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[(0,u.jsxs)("span",{style:Je,children:[e.totalLineas.toLocaleString()," l\xedneas"]}),(0,u.jsx)("span",{style:$e,children:(0,Ve.l9)(e.porcentaje)}),(0,u.jsx)("span",{style:Qe,children:(0,Ve.up)(e.montoTotal)})]})]}),(0,u.jsxs)("div",{style:{width:40,height:40,borderRadius:"50%",background:"linear-gradient(135deg, hsl(".concat(137.5*a%360,", 70%, 60%) 0%, hsl(").concat((137.5*a+60)%360,", 70%, 70%) 100%)"),display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:700,fontSize:18},children:["#",a+1]})]}),(0,u.jsxs)("div",{style:{marginBottom:16},children:[(0,u.jsx)("div",{style:{fontWeight:600,marginBottom:8,color:"#374151"},children:"Ejemplos principales:"}),(0,u.jsx)("div",{style:{fontSize:14,color:"#6b7280",lineHeight:1.5},children:e.ejemplos.slice(0,3).map((e,a)=>(0,u.jsxs)("div",{style:{marginBottom:8},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[(0,u.jsxs)("span",{style:{fontWeight:600},children:[e.numeroCartel,":"]}),(0,u.jsx)("span",{style:(0,r.A)((0,r.A)({},Xe),{},{background:"cartel"===e.tipoCoincidencia?"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)":"linear-gradient(135deg, #10b981 0%, #059669 100%)",color:"white",fontSize:9,padding:"3px 8px"}),children:"cartel"===e.tipoCoincidencia?"\ud83d\udccb Cartel":"\ud83d\udcc4 L\xedneas"})]}),(0,u.jsxs)("div",{style:{paddingLeft:8,borderLeft:"2px solid #e5e7eb"},children:[e.descripcionLinea.slice(0,100),e.descripcionLinea.length>100&&"..."]}),(0,u.jsxs)("div",{style:{marginTop:4,display:"flex",flexWrap:"wrap",gap:4},children:[e.palabrasCoincidentes.slice(0,3).map(a=>(0,u.jsx)("span",{style:(0,r.A)((0,r.A)({},Xe),{},{background:"cartel"===e.tipoCoincidencia?"#fef3c7":"#dcfce7",color:"cartel"===e.tipoCoincidencia?"#92400e":"#166534",fontSize:10}),children:a},a)),e.palabrasCoincidentes.length>3&&(0,u.jsxs)("span",{style:{fontSize:10,color:"#9ca3af"},children:["+",e.palabrasCoincidentes.length-3," m\xe1s"]})]})]},a))})]}),(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingTop:16,borderTop:"1px solid #e5e7eb"},children:[(0,u.jsxs)("div",{style:{fontSize:14,color:"#6b7280"},children:["Top instituciones: ",e.instituciones.slice(0,2).map(e=>e.codigo).join(", ")]}),(0,u.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,u.jsx)("button",{onClick:a=>{a.stopPropagation(),v(e),f(!0)},style:{background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"white",border:"none",borderRadius:6,padding:"6px 12px",cursor:"pointer",fontSize:12,fontWeight:600},children:"Ver todos los ejemplos"}),(0,u.jsx)("div",{style:{color:(null===o||void 0===o?void 0:o.categoria)===e.categoria?"#3b82f6":"#9ca3af",fontSize:12,fontWeight:600,display:"flex",alignItems:"center"},children:(null===o||void 0===o?void 0:o.categoria)===e.categoria?"Ver menos":"Ver detalles"})]})]})]},e.categoria))}),o&&(0,u.jsx)("div",{style:{position:"sticky",top:20,height:"fit-content"},children:(0,u.jsxs)("div",{style:Ve.S2,children:[(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[(0,u.jsx)("h3",{style:{margin:0,fontSize:24,fontWeight:700,color:"#1f2937"},children:o.categoria}),(0,u.jsx)("button",{onClick:()=>l(null),style:{background:"transparent",border:"none",fontSize:24,cursor:"pointer",color:"#9ca3af"},children:"\xd7"})]}),(0,u.jsx)("div",{style:{marginBottom:24},children:(0,u.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[(0,u.jsxs)("div",{style:{textAlign:"center",padding:16,background:"#f8fafc",borderRadius:8},children:[(0,u.jsx)("div",{style:{fontSize:24,fontWeight:700,color:"#1f2937"},children:o.totalLineas.toLocaleString()}),(0,u.jsx)("div",{style:{color:"#6b7280"},children:"L\xedneas"})]}),(0,u.jsxs)("div",{style:{textAlign:"center",padding:16,background:"#f8fafc",borderRadius:8},children:[(0,u.jsx)("div",{style:{fontSize:20,fontWeight:700,color:"#1f2937"},children:(0,Ve.up)(o.montoTotal)}),(0,u.jsx)("div",{style:{color:"#6b7280"},children:"Monto Total"})]})]})}),(0,u.jsxs)("div",{style:{marginBottom:24},children:[(0,u.jsx)("h4",{style:{margin:"0 0 12px 0",fontSize:16,fontWeight:600,color:"#374151"},children:"Top Instituciones"}),(0,u.jsx)("div",{style:{maxHeight:200,overflow:"auto"},children:o.instituciones.slice(0,8).map((e,a)=>(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0",borderBottom:a<7?"1px solid #f3f4f6":"none"},children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{style:{fontWeight:600,fontSize:14},children:e.codigo}),(0,u.jsxs)("div",{style:{fontSize:12,color:"#6b7280"},children:[e.nombre.slice(0,30),e.nombre.length>30&&"..."]})]}),(0,u.jsxs)("div",{style:{textAlign:"right"},children:[(0,u.jsxs)("div",{style:{fontSize:14,fontWeight:600},children:[e.lineas," l\xedneas"]}),(0,u.jsx)("div",{style:{fontSize:12,color:"#6b7280"},children:(0,Ve.up)(e.monto)})]})]},e.codigo))})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("h4",{style:{margin:"0 0 12px 0",fontSize:16,fontWeight:600,color:"#374151"},children:"Ejemplos de L\xedneas Capturadas"}),(0,u.jsx)("div",{style:{maxHeight:300,overflow:"auto"},children:o.ejemplos.slice(0,8).map((e,a)=>(0,u.jsxs)("div",{style:{padding:12,marginBottom:8,background:"cartel"===e.tipoCoincidencia?"#fef3c7":"#dcfce7",borderRadius:8,borderLeft:"4px solid ".concat("cartel"===e.tipoCoincidencia?"#f59e0b":"#10b981")},children:[(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8,alignItems:"center"},children:[(0,u.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,u.jsx)("span",{style:{fontWeight:600,color:"#1f2937"},children:e.numeroCartel}),(0,u.jsx)("span",{style:{fontSize:10,fontWeight:700,background:"cartel"===e.tipoCoincidencia?"#f59e0b":"#10b981",color:"white",padding:"2px 8px",borderRadius:4},children:"cartel"===e.tipoCoincidencia?"\ud83d\udccb":"\ud83d\udcc4"})]}),(0,u.jsx)("span",{style:{fontSize:12,color:"#6b7280"},children:e.codigoInstitucion})]}),(0,u.jsx)("div",{style:{fontSize:13,color:"#374151",marginBottom:8,lineHeight:1.4},children:e.descripcionLinea}),"lineas"===e.tipoCoincidencia&&e.lineasCoincidentes&&(0,u.jsxs)("div",{style:{fontSize:11,color:"#059669",marginBottom:8,fontWeight:600},children:["\u2713 ",e.lineasCoincidentes.length," l\xednea(s) espec\xedfica(s) coincidieron"]}),(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,u.jsx)("div",{children:e.palabrasCoincidentes.slice(0,4).map(a=>(0,u.jsx)("span",{style:(0,r.A)((0,r.A)({},Xe),{},{background:"cartel"===e.tipoCoincidencia?"#f59e0b":"#10b981",color:"white",fontSize:10}),children:a},a))}),e.presupuestoLinea&&(0,u.jsx)("div",{style:{fontSize:12,fontWeight:600,color:"#059669"},children:(0,Ve.up)(e.presupuestoLinea)})]})]},a))})]})]})})]}),a.sinCategorizar.lineas>0&&(0,u.jsxs)("div",{style:Ve.S2,children:[(0,u.jsxs)("h3",{style:{margin:"0 0 16px 0",fontSize:20,fontWeight:700,color:"#dc2626"},children:["\u26a0\ufe0f L\xedneas Sin Categorizar (",a.sinCategorizar.lineas.toLocaleString(),")"]}),(0,u.jsxs)("div",{style:{maxHeight:200,overflow:"auto"},children:[a.sinCategorizar.ejemplos.slice(0,15).map((e,a)=>(0,u.jsx)("div",{style:{padding:8,marginBottom:4,background:"#fef2f2",borderRadius:6,fontSize:14,color:"#374151"},children:e},a)),a.sinCategorizar.ejemplos.length>15&&(0,u.jsxs)("div",{style:{textAlign:"center",padding:8,color:"#6b7280"},children:["... y ",a.sinCategorizar.lineas-15," m\xe1s"]})]})]})]}):(0,u.jsx)("div",{style:Ve.S2,children:(0,u.jsx)("div",{style:{textAlign:"center",padding:40},children:(0,u.jsx)("button",{onClick:j,style:{background:"linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%)",color:"white",border:"none",borderRadius:8,padding:"12px 24px",cursor:"pointer",fontSize:16,fontWeight:600},children:"Analizar Categor\xedas del Sistema"})})}):(0,u.jsx)("div",{style:Ve.S2,children:(0,u.jsx)("div",{style:{textAlign:"center",padding:40},children:(0,u.jsx)("div",{style:{fontSize:18,color:"#6b7280"},children:"Cargando datos..."})})})}const aa=(0,i.lazy)(()=>t.e(847).then(t.bind(t,7847))),ta=(0,i.lazy)(()=>t.e(493).then(t.bind(t,1493))),ia=(0,i.lazy)(()=>t.e(37).then(t.bind(t,8037)).then(e=>({default:e.CategoryConfigView}))),sa=()=>Math.random().toString(36).slice(2,10);function ra(){const{instituciones:e}=(0,s.M)(),[a,t]=(0,i.useState)([]),[n,o]=(0,i.useState)([]),[l,c]=(0,i.useState)("analysis"),[d,p]=(0,i.useState)(!0);(0,i.useEffect)(()=>{(async()=>{p(!0);try{await new Promise(e=>setTimeout(e,100));const e=Be.M.getAllRules(),a=Be.M.getAllGroups();t(e),o(a)}catch(e){console.error("[CategoryManager] Error loading data:",e)}finally{p(!1)}})()},[]);const h=(0,i.useMemo)(()=>(e||[]).map(e=>({value:e.codigoInstitucion,label:"".concat(e.codigoInstitucion," - ").concat(e.nombreInstitucion)})),[e]),m=e=>({padding:"18px 36px",background:e?"linear-gradient(135deg, rgba(102, 126, 234, 0.95) 0%, rgba(118, 75, 162, 0.9) 50%, rgba(79, 172, 254, 0.85) 100%)":"rgba(255, 255, 255, 0.05)",backdropFilter:e?"blur(20px) saturate(180%)":"blur(10px)",WebkitBackdropFilter:e?"blur(20px) saturate(180%)":"blur(10px)",color:e?"white":"rgba(255, 255, 255, 0.6)",border:e?"1px solid rgba(255, 255, 255, 0.3)":"1px solid rgba(255, 255, 255, 0.1)",cursor:"pointer",borderRadius:"16px 16px 0 0",fontWeight:e?700:600,fontSize:15,transition:"all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1)",boxShadow:e?"\n        0 -4px 20px rgba(102, 126, 234, 0.4),\n        0 -2px 10px rgba(118, 75, 162, 0.3),\n        inset 0 1px 0 rgba(255, 255, 255, 0.4),\n        inset 0 -1px 0 rgba(0, 0, 0, 0.2)\n      ":"0 2px 8px rgba(0, 0, 0, 0.1)",textShadow:e?"0 1px 3px rgba(0, 0, 0, 0.3)":"none",transform:e?"translateY(-2px) scale(1.02)":"translateY(0) scale(1)",position:"relative",overflow:"hidden",willChange:"transform, background, box-shadow"}),x=()=>(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"40px",minHeight:"200px"},children:[(0,u.jsx)("div",{className:"spinner",style:{width:"40px",height:"40px",border:"4px solid #e5e7eb",borderTop:"4px solid #3b82f6",borderRadius:"50%",animation:"spin 0.8s linear infinite"}}),(0,u.jsx)("style",{children:"\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      "})]});return d?(0,u.jsx)(x,{}):(0,u.jsxs)("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #0f172a 0%, #1e293b 25%, #334155 50%, #475569 75%, #64748b 100%)",position:"relative",overflow:"hidden"},children:[(0,u.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,pointerEvents:"none",zIndex:0,opacity:.4},children:[...Array(20)].map((e,a)=>(0,u.jsx)("div",{style:{position:"absolute",width:"".concat(6*Math.random()+2,"px"),height:"".concat(6*Math.random()+2,"px"),background:"radial-gradient(circle, ".concat(["#667eea","#764ba2","#f093fb","#4facfe"][a%4]," 0%, transparent 70%)"),borderRadius:"50%",left:"".concat(100*Math.random(),"%"),top:"".concat(100*Math.random(),"%"),animation:"floatParticle".concat(a%4," ").concat(15+10*Math.random(),"s ease-in-out infinite"),animationDelay:"".concat(5*Math.random(),"s"),willChange:"transform"}},a))}),(0,u.jsx)("style",{children:"\n        @keyframes floatParticle0 {\n          0%, 100% { transform: translate(0, 0) rotate(0deg); }\n          25% { transform: translate(100px, -100px) rotate(90deg); }\n          50% { transform: translate(200px, 0) rotate(180deg); }\n          75% { transform: translate(100px, 100px) rotate(270deg); }\n        }\n        @keyframes floatParticle1 {\n          0%, 100% { transform: translate(0, 0) rotate(0deg) scale(1); }\n          33% { transform: translate(-80px, 120px) rotate(120deg) scale(1.2); }\n          66% { transform: translate(80px, -80px) rotate(240deg) scale(0.8); }\n        }\n        @keyframes floatParticle2 {\n          0%, 100% { transform: translate(0, 0) rotate(360deg); }\n          50% { transform: translate(-150px, 150px) rotate(0deg); }\n        }\n        @keyframes floatParticle3 {\n          0%, 100% { transform: translate(0, 0) scale(1) rotate(0deg); }\n          25% { transform: translate(120px, 60px) scale(1.3) rotate(90deg); }\n          50% { transform: translate(-60px, 120px) scale(0.7) rotate(180deg); }\n          75% { transform: translate(-120px, -60px) scale(1.1) rotate(270deg); }\n        }\n        @keyframes shimmerBorder {\n          0% { background-position: -200% center; }\n          100% { background-position: 200% center; }\n        }\n        @keyframes pulseGlow {\n          0%, 100% { \n            box-shadow: 0 0 20px rgba(102, 126, 234, 0.4), \n                        0 0 40px rgba(118, 75, 162, 0.3),\n                        0 0 60px rgba(240, 147, 251, 0.2),\n                        inset 0 0 20px rgba(255, 255, 255, 0.1);\n          }\n          50% { \n            box-shadow: 0 0 30px rgba(102, 126, 234, 0.6), \n                        0 0 60px rgba(118, 75, 162, 0.5),\n                        0 0 90px rgba(240, 147, 251, 0.3),\n                        inset 0 0 30px rgba(255, 255, 255, 0.15);\n          }\n        }\n        @keyframes fadeInUp {\n          from {\n            opacity: 0;\n            transform: translateY(30px) translateZ(-50px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0) translateZ(0);\n          }\n        }\n        @keyframes scaleIn {\n          from {\n            opacity: 0;\n            transform: scale(0.9) rotateX(10deg);\n          }\n          to {\n            opacity: 1;\n            transform: scale(1) rotateX(0deg);\n          }\n        }\n        @keyframes wiggle {\n          0%, 100% { transform: rotate(-3deg) scale(1); }\n          50% { transform: rotate(3deg) scale(1.05); }\n        }\n      "}),(0,u.jsxs)("div",{style:{background:"linear-gradient(135deg, rgba(102, 126, 234, 0.95) 0%, rgba(118, 75, 162, 0.95) 25%, rgba(79, 172, 254, 0.9) 50%, rgba(0, 242, 254, 0.85) 75%, rgba(102, 126, 234, 0.9) 100%)",backdropFilter:"blur(25px) saturate(180%)",WebkitBackdropFilter:"blur(25px) saturate(180%)",padding:"70px 80px",marginBottom:"40px",boxShadow:"\n          0 20px 60px rgba(102, 126, 234, 0.4),\n          0 10px 30px rgba(118, 75, 162, 0.3),\n          0 5px 15px rgba(0, 0, 0, 0.2),\n          inset 0 1px 0 rgba(255, 255, 255, 0.4),\n          inset 0 -1px 0 rgba(0, 0, 0, 0.2)\n        ",borderBottom:"2px solid rgba(255, 255, 255, 0.3)",position:"relative",overflow:"hidden",perspective:"2000px",transformStyle:"preserve-3d",animation:"fadeInUp 0.8s cubic-bezier(0.34, 1.56, 0.64, 1)",willChange:"transform, opacity"},children:[(0,u.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,height:"3px",background:"linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.8), transparent)",backgroundSize:"200% 100%",animation:"shimmerBorder 3s linear infinite",willChange:"background-position"}}),(0,u.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"\n            radial-gradient(circle at 20% 30%, rgba(102, 126, 234, 0.4) 0%, transparent 50%),\n            radial-gradient(circle at 80% 60%, rgba(240, 147, 251, 0.3) 0%, transparent 50%),\n            radial-gradient(circle at 40% 80%, rgba(79, 172, 254, 0.35) 0%, transparent 50%),\n            radial-gradient(circle at 60% 20%, rgba(118, 75, 162, 0.3) 0%, transparent 50%),\n            linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(240, 147, 251, 0.1) 100%)\n          ",pointerEvents:"none",mixBlendMode:"overlay",animation:"pulseGlow 4s ease-in-out infinite",willChange:"box-shadow"}}),(0,u.jsxs)("div",{style:{position:"relative",zIndex:1,textAlign:"center",transform:"translateZ(50px)",transformStyle:"preserve-3d"},children:[(0,u.jsxs)("h1",{style:{margin:"0 0 16px 0",color:"white",fontSize:"4.5em",fontWeight:"900",textShadow:"\n              0 2px 4px rgba(0, 0, 0, 0.3),\n              0 4px 8px rgba(0, 0, 0, 0.2),\n              0 8px 16px rgba(0, 0, 0, 0.1),\n              0 0 40px rgba(255, 255, 255, 0.3)\n            ",letterSpacing:"-2px",display:"flex",alignItems:"center",justifyContent:"center",gap:"20px",transform:"translateZ(30px)",animation:"scaleIn 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) 0.2s both",willChange:"transform"},children:[(0,u.jsx)("span",{onMouseEnter:e=>{e.currentTarget.style.transform="scale(1.2) rotate(10deg)",e.currentTarget.style.filter="drop-shadow(0 0 20px rgba(255, 255, 255, 0.8))"},onMouseLeave:e=>{e.currentTarget.style.transform="scale(1) rotate(0deg)",e.currentTarget.style.filter="none"},style:{fontSize:"1.1em",transition:"all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1)",display:"inline-block",animation:"wiggle 3s ease-in-out infinite",willChange:"transform"},children:"\ud83c\udff7\ufe0f"}),"Gesti\xf3n de Categor\xedas"]}),(0,u.jsx)("p",{style:{margin:0,color:"rgba(255, 255, 255, 0.95)",fontSize:"1.32em",fontWeight:"600",textShadow:"\n              0 1px 2px rgba(0, 0, 0, 0.3),\n              0 2px 4px rgba(0, 0, 0, 0.2),\n              0 0 20px rgba(255, 255, 255, 0.2)\n            ",letterSpacing:"0.5px",transform:"translateZ(20px)",animation:"fadeInUp 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) 0.4s both",willChange:"transform, opacity"},children:"Sistema de clasificaci\xf3n y an\xe1lisis de licitaciones"})]})]}),(0,u.jsxs)("div",{style:{marginBottom:40,borderBottom:"2px solid rgba(102, 126, 234, 0.2)",background:"linear-gradient(135deg, rgba(15, 23, 42, 0.6) 0%, rgba(30, 41, 59, 0.5) 100%)",backdropFilter:"blur(15px) saturate(150%)",WebkitBackdropFilter:"blur(15px) saturate(150%)",boxShadow:"\n          0 4px 16px rgba(0, 0, 0, 0.2),\n          inset 0 1px 0 rgba(255, 255, 255, 0.1)\n        ",padding:"0 80px",position:"relative",zIndex:10,perspective:"1500px",transformStyle:"preserve-3d",animation:"fadeInUp 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) 0.3s both",willChange:"transform, opacity"},children:[(0,u.jsxs)("button",{onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-4px) scale(1.05) rotateX(5deg)",e.currentTarget.style.boxShadow="\n              0 -8px 30px rgba(102, 126, 234, 0.6),\n              0 -4px 15px rgba(118, 75, 162, 0.4),\n              inset 0 1px 0 rgba(255, 255, 255, 0.5)\n            "},onMouseLeave:e=>{const a="analysis"===l;e.currentTarget.style.transform=a?"translateY(-2px) scale(1.02)":"translateY(0) scale(1)",e.currentTarget.style.boxShadow=a?"0 -4px 20px rgba(102, 126, 234, 0.4), 0 -2px 10px rgba(118, 75, 162, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.4), inset 0 -1px 0 rgba(0, 0, 0, 0.2)":"0 2px 8px rgba(0, 0, 0, 0.1)"},style:m("analysis"===l),onClick:()=>c("analysis"),children:[(0,u.jsx)("span",{style:{marginRight:"8px",fontSize:"1.1em"},children:"\ud83d\udcca"}),"An\xe1lisis del Sistema"]}),(0,u.jsxs)("button",{onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-4px) scale(1.05) rotateX(5deg)",e.currentTarget.style.boxShadow="\n              0 -8px 30px rgba(102, 126, 234, 0.6),\n              0 -4px 15px rgba(118, 75, 162, 0.4),\n              inset 0 1px 0 rgba(255, 255, 255, 0.5)\n            "},onMouseLeave:e=>{const a="manual"===l;e.currentTarget.style.transform=a?"translateY(-2px) scale(1.02)":"translateY(0) scale(1)",e.currentTarget.style.boxShadow=a?"0 -4px 20px rgba(102, 126, 234, 0.4), 0 -2px 10px rgba(118, 75, 162, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.4), inset 0 -1px 0 rgba(0, 0, 0, 0.2)":"0 2px 8px rgba(0, 0, 0, 0.1)"},style:m("manual"===l),onClick:()=>c("manual"),children:[(0,u.jsx)("span",{style:{marginRight:"8px",fontSize:"1.1em"},children:"\ud83c\udff7\ufe0f"}),"Categor\xedas Manuales"]}),(0,u.jsxs)("button",{onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-4px) scale(1.05) rotateX(5deg)",e.currentTarget.style.boxShadow="\n              0 -8px 30px rgba(102, 126, 234, 0.6),\n              0 -4px 15px rgba(118, 75, 162, 0.4),\n              inset 0 1px 0 rgba(255, 255, 255, 0.5)\n            "},onMouseLeave:e=>{const a="testing"===l;e.currentTarget.style.transform=a?"translateY(-2px) scale(1.02)":"translateY(0) scale(1)",e.currentTarget.style.boxShadow=a?"0 -4px 20px rgba(102, 126, 234, 0.4), 0 -2px 10px rgba(118, 75, 162, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.4), inset 0 -1px 0 rgba(0, 0, 0, 0.2)":"0 2px 8px rgba(0, 0, 0, 0.1)"},style:m("testing"===l),onClick:()=>c("testing"),children:[(0,u.jsx)("span",{style:{marginRight:"8px",fontSize:"1.1em"},children:"\ud83e\uddea"}),"Panel de Pruebas"]}),(0,u.jsxs)("button",{onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-4px) scale(1.05) rotateX(5deg)",e.currentTarget.style.boxShadow="\n              0 -8px 30px rgba(102, 126, 234, 0.6),\n              0 -4px 15px rgba(118, 75, 162, 0.4),\n              inset 0 1px 0 rgba(255, 255, 255, 0.5)\n            "},onMouseLeave:e=>{const a="config"===l;e.currentTarget.style.transform=a?"translateY(-2px) scale(1.02)":"translateY(0) scale(1)",e.currentTarget.style.boxShadow=a?"0 -4px 20px rgba(102, 126, 234, 0.4), 0 -2px 10px rgba(118, 75, 162, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.4), inset 0 -1px 0 rgba(0, 0, 0, 0.2)":"0 2px 8px rgba(0, 0, 0, 0.1)"},style:m("config"===l),onClick:()=>c("config"),children:[(0,u.jsx)("span",{style:{marginRight:"8px",fontSize:"1.1em"},children:"\u2699\ufe0f"}),"Configuraci\xf3n"]})]}),(0,u.jsxs)("div",{style:{padding:"0 80px 80px",maxWidth:"1800px",margin:"0 auto",position:"relative",zIndex:1},children:["analysis"===l&&(0,u.jsx)(ea,{}),"manual"===l&&(0,u.jsx)(i.Suspense,{fallback:(0,u.jsx)(x,{}),children:(0,u.jsx)(ta,{rules:a,groups:n,institucionesOptions:h,onStartNew:()=>({id:sa(),nombre:"",descripcion:"",palabrasClave:[],instituciones:[],activo:!0,color:"#3b82f6"}),onSaveRule:e=>{const i=!a.find(a=>a.id===e.id),s=i?[...a,e]:a.map(a=>a.id===e.id?e:a);t(s),Be.M.saveRules(s),window.dispatchEvent(new CustomEvent("manualCategoriesUpdated",{detail:{isNew:i,category:e,timestamp:Date.now()}}))},onRemoveRule:e=>{const i=a.filter(a=>a.id!==e);t(i),Be.M.saveRules(i)},onCreateGroup:e=>{const a={id:sa(),nombre:e||"Nuevo grupo",categorias:[],descripcion:""},t=[...n,a];o(t),Be.M.saveGroups(t)},onAddRuleToGroup:(e,a)=>{const t=n.map(t=>t.id===e?(0,r.A)((0,r.A)({},t),{},{categorias:We().uniq([...t.categorias||[],a])}):t);o(t),Be.M.saveGroups(t)},onRemoveRuleFromGroup:(e,a)=>{const t=n.map(t=>t.id===e?(0,r.A)((0,r.A)({},t),{},{categorias:(t.categorias||[]).filter(e=>e!==a)}):t);o(t),Be.M.saveGroups(t)}})}),"testing"===l&&(0,u.jsx)(i.Suspense,{fallback:(0,u.jsx)(x,{}),children:(0,u.jsx)(aa,{onSaveCategory:(e,i)=>{const s={id:sa(),nombre:i,descripcion:"Categor\xeda creada desde panel de pruebas con ".concat(e.length," palabras clave"),palabrasClave:e,instituciones:[],activo:!0,color:"#3b82f6"},r=[...a,s];t(r),Be.M.saveRules(r),window.dispatchEvent(new CustomEvent("manualCategoriesUpdated",{detail:{isNew:!0,category:s,timestamp:Date.now()}})),c("manual")}})}),"config"===l&&(0,u.jsx)(i.Suspense,{fallback:(0,u.jsx)(x,{}),children:(0,u.jsx)(ia,{})})]})]})}var na=t(3065);const oa=e=>{var a,t,s,r;let{filters:o}=e;const l=(0,i.useMemo)(()=>{const e=n.M.obtenerDatos("DetalleCarteles").filter(e=>e.fechaPublicacion&&e.fechaPublicacion>=o.periodo.inicio&&e.fechaPublicacion<=o.periodo.fin),a=n.M.obtenerDatos("Contratos").filter(e=>e.fechaFirma&&e.fechaFirma>=o.periodo.inicio&&e.fechaFirma<=o.periodo.fin);return(o.sectores.length>0?o.sectores:["medicamentos","salud","educaci\xf3n","tecnolog\xeda","construcci\xf3n","transporte","seguridad","alimentos","servicios","consultor\xeda"]).map(t=>{const i=e.filter(e=>"".concat(e.nombreCartel||""," ").concat(e.descripcionCartel||"").toLowerCase().includes(t.toLowerCase())),s=a.filter(a=>{const i=e.find(e=>e.numeroCartel===a.numeroCartel);if(i){if("".concat(i.nombreCartel||""," ").concat(i.descripcionCartel||"").toLowerCase().includes(t.toLowerCase()))return!0}if(a.descripcionContrato){if(a.descripcionContrato.toLowerCase().includes(t.toLowerCase()))return!0}const s=n.M.obtenerDatos("LineasContratadas").filter(e=>e.idContrato===a.idContrato);return s.length>0&&s.some(e=>{if(e.descripcionLinea){if(e.descripcionLinea.toLowerCase().includes(t.toLowerCase()))return!0}const a=n.M.obtenerDatos("DetalleLineaCartel").find(a=>a.numeroCartel===e.numeroCartel&&a.numeroLinea===e.numeroLinea);if(a&&a.descripcionLinea){return a.descripcionLinea.toLowerCase().includes(t.toLowerCase())}return!1})}),r=We().sumBy(s,e=>n.M.obtenerMontoContratoPreciso(e))||0,l=s.length>0?r/s.length:0,c=We().uniqBy(s,"idProveedor").length,d=i.reduce((e,a)=>e+(a.cantidadLineas||0),0),p=s.length,h=d>0?p/d*100:0,m=new Date(o.periodo.inicio);m.setFullYear(m.getFullYear()-1);const x=new Date(o.periodo.fin);x.setFullYear(x.getFullYear()-1);const g=a.filter(e=>{const a=e.fechaFirma;return!!a&&(a>=m&&a<=x)}).filter(e=>n.M.obtenerDatos("LineasContratadas").filter(a=>a.idContrato===e.idContrato).some(e=>{const a=n.M.obtenerDatos("DetalleLineaCartel").find(a=>a.numeroCartel===e.numeroCartel&&a.numeroLinea===e.numeroLinea);return!!a&&a.descripcionLinea.toLowerCase().includes(t.toLowerCase())})),u=We().sumBy(g,e=>n.M.obtenerMontoContratoPreciso(e))||1,f=u>0?(r-u)/u*100:0;return{sector:t,totalLicitaciones:i.length,totalContratos:s.length,montoTotal:r,montoPromedio:l,proveedoresActivos:c,tasaAdjudicacion:h,tendencia:f}}).sort((e,a)=>a.montoTotal-e.montoTotal)},[o]),c=(0,i.useMemo)(()=>We().sumBy(l,"montoTotal"),[l]);return(0,u.jsxs)("div",{className:"sector-market-report",children:[(0,u.jsx)("h2",{className:"report-title",children:"\ud83c\udfed An\xe1lisis de Mercado por Sector"}),(0,u.jsx)("div",{className:"report-intro",children:(0,u.jsxs)("p",{children:["An\xe1lisis detallado de ",l.length," sectores para el per\xedodo del"," ",o.periodo.inicio.toLocaleDateString()," al ",o.periodo.fin.toLocaleDateString()]})}),(0,u.jsx)("div",{className:"sectors-summary",children:l.map((e,a)=>{const t=c>0?e.montoTotal/c*100:0;return(0,u.jsxs)("div",{className:"sector-card",children:[(0,u.jsxs)("div",{className:"sector-card-header",children:[(0,u.jsxs)("div",{className:"sector-rank",children:["#",a+1]}),(0,u.jsx)("div",{className:"sector-name",children:e.sector.toUpperCase()}),(0,u.jsxs)("div",{className:"sector-trend ".concat(e.tendencia>=0?"positive":"negative"),children:[e.tendencia>=0?"\ud83d\udcc8":"\ud83d\udcc9"," ",Math.abs(e.tendencia).toFixed(1),"%"]})]}),(0,u.jsxs)("div",{className:"sector-metrics",children:[(0,u.jsxs)("div",{className:"sector-metric",children:[(0,u.jsx)("div",{className:"metric-label",children:"Monto Total"}),(0,u.jsxs)("div",{className:"metric-value large",children:["\u20a1",(e.montoTotal/1e6).toFixed(1),"M"]}),(0,u.jsxs)("div",{className:"metric-detail",children:[t.toFixed(1),"% del total"]})]}),(0,u.jsxs)("div",{className:"sector-metric",children:[(0,u.jsx)("div",{className:"metric-label",children:"Licitaciones"}),(0,u.jsx)("div",{className:"metric-value",children:e.totalLicitaciones})]}),(0,u.jsxs)("div",{className:"sector-metric",children:[(0,u.jsx)("div",{className:"metric-label",children:"Contratos"}),(0,u.jsx)("div",{className:"metric-value",children:e.totalContratos})]}),(0,u.jsxs)("div",{className:"sector-metric",children:[(0,u.jsx)("div",{className:"metric-label",children:"Monto Promedio"}),(0,u.jsxs)("div",{className:"metric-value",children:["\u20a1",(e.montoPromedio/1e3).toFixed(0),"K"]})]}),(0,u.jsxs)("div",{className:"sector-metric",children:[(0,u.jsx)("div",{className:"metric-label",children:"Proveedores Activos"}),(0,u.jsx)("div",{className:"metric-value",children:e.proveedoresActivos})]}),(0,u.jsxs)("div",{className:"sector-metric",children:[(0,u.jsx)("div",{className:"metric-label",children:"Tasa Adjudicaci\xf3n"}),(0,u.jsxs)("div",{className:"metric-value",children:[e.tasaAdjudicacion.toFixed(1),"%"]})]})]}),(0,u.jsx)("div",{className:"sector-visualization",children:(0,u.jsx)("div",{className:"participation-bar",children:(0,u.jsx)("div",{className:"participation-fill",style:{width:"".concat(t,"%")}})})})]},e.sector)})}),(0,u.jsxs)("div",{className:"report-section",children:[(0,u.jsx)("h3",{children:"\ud83d\udcca Comparativa de Sectores"}),(0,u.jsx)("div",{className:"comparative-chart",children:l.map(e=>(0,u.jsxs)("div",{className:"comparative-row",children:[(0,u.jsx)("div",{className:"comparative-label",children:e.sector}),(0,u.jsxs)("div",{className:"comparative-bars",children:[(0,u.jsxs)("div",{className:"comparative-bar-container",children:[(0,u.jsx)("div",{className:"bar-label",children:"Licitaciones"}),(0,u.jsxs)("div",{className:"bar-wrapper",children:[(0,u.jsx)("div",{className:"bar licitaciones",style:{width:"".concat(e.totalLicitaciones/Math.max(...l.map(e=>e.totalLicitaciones))*100,"%")}}),(0,u.jsx)("span",{className:"bar-value",children:e.totalLicitaciones})]})]}),(0,u.jsxs)("div",{className:"comparative-bar-container",children:[(0,u.jsx)("div",{className:"bar-label",children:"Contratos"}),(0,u.jsxs)("div",{className:"bar-wrapper",children:[(0,u.jsx)("div",{className:"bar contratos",style:{width:"".concat(e.totalContratos/Math.max(...l.map(e=>e.totalContratos))*100,"%")}}),(0,u.jsx)("span",{className:"bar-value",children:e.totalContratos})]})]})]})]},e.sector))})]}),(0,u.jsxs)("div",{className:"report-section insights",children:[(0,u.jsx)("h3",{children:"\ud83d\udca1 Insights del An\xe1lisis"}),(0,u.jsxs)("div",{className:"insights-grid",children:[(0,u.jsxs)("div",{className:"insight-card",children:[(0,u.jsx)("div",{className:"insight-icon",children:"\ud83c\udfc6"}),(0,u.jsxs)("div",{className:"insight-content",children:[(0,u.jsx)("div",{className:"insight-title",children:"Sector Dominante"}),(0,u.jsxs)("div",{className:"insight-text",children:[null===(a=l[0])||void 0===a?void 0:a.sector.toUpperCase()," lidera el mercado con \u20a1",((null===(t=l[0])||void 0===t?void 0:t.montoTotal)/1e6).toFixed(1),"M en contratos"]})]})]}),(0,u.jsxs)("div",{className:"insight-card",children:[(0,u.jsx)("div",{className:"insight-icon",children:"\ud83d\udcc8"}),(0,u.jsxs)("div",{className:"insight-content",children:[(0,u.jsx)("div",{className:"insight-title",children:"Mayor Crecimiento"}),(0,u.jsxs)("div",{className:"insight-text",children:[null===(s=l.reduce((e,a)=>a.tendencia>e.tendencia?a:e,l[0]))||void 0===s?void 0:s.sector.toUpperCase()," ","creci\xf3 ",Math.max(...l.map(e=>e.tendencia)).toFixed(1),"% interanual"]})]})]}),(0,u.jsxs)("div",{className:"insight-card",children:[(0,u.jsx)("div",{className:"insight-icon",children:"\ud83c\udfaf"}),(0,u.jsxs)("div",{className:"insight-content",children:[(0,u.jsx)("div",{className:"insight-title",children:"Mayor Competencia"}),(0,u.jsxs)("div",{className:"insight-text",children:[null===(r=l.reduce((e,a)=>a.proveedoresActivos>e.proveedoresActivos?a:e,l[0]))||void 0===r?void 0:r.sector.toUpperCase()," ","tiene ",Math.max(...l.map(e=>e.proveedoresActivos))," proveedores activos"]})]})]})]})]})]})},la=e=>{var a,t,s,r,o,l,c;let{filters:d}=e;const p=(0,i.useMemo)(()=>{const e=n.M.obtenerDatos("Contratos").filter(e=>e.fechaFirma&&e.fechaFirma>=d.periodo.inicio&&e.fechaFirma<=d.periodo.fin),a=n.M.obtenerDatos("Ofertas"),t=n.M.obtenerDatos("Proveedores"),i=We().groupBy(e,"idProveedor"),s=We().sumBy(e,e=>n.M.obtenerMontoContratoPreciso(e))||1;return We().map(i,(e,i)=>{const r=t.find(e=>e.idProveedor===i),o=a.filter(e=>e.idProveedor===i),l=We().sumBy(e,e=>n.M.obtenerMontoContratoPreciso(e))||0;let c="Desconocido";return r&&(c=r.nombreProveedor||r.razonSocial||r.nombre||"Proveedor ".concat(i)),{id:i,nombre:c,cantidadContratos:e.length,montoTotal:l,montoPromedio:l/e.length,marketShare:l/s*100,tasaExito:o.length>0?e.length/o.length*100:0,totalOfertas:o.length}}).sort((e,a)=>a.montoTotal-e.montoTotal).slice(0,50)},[d]),h=(0,i.useMemo)(()=>{const e=We().sumBy(p,"montoTotal")||1,a=We().take(p,3),t=We().take(p,5),i=We().take(p,10);return{top3:We().sumBy(a,"montoTotal")/e*100,top5:We().sumBy(t,"montoTotal")/e*100,top10:We().sumBy(i,"montoTotal")/e*100}},[p]),m=(0,i.useMemo)(()=>{const e=p.filter(e=>e.montoTotal>=1e8),a=p.filter(e=>e.montoTotal>=1e7&&e.montoTotal<1e8),t=p.filter(e=>e.montoTotal<1e7);return{grandes:{cantidad:e.length,montoTotal:We().sumBy(e,"montoTotal"),promedio:e.length>0?We().sumBy(e,"montoTotal")/e.length:0},medianos:{cantidad:a.length,montoTotal:We().sumBy(a,"montoTotal"),promedio:a.length>0?We().sumBy(a,"montoTotal")/a.length:0},"peque\xf1os":{cantidad:t.length,montoTotal:We().sumBy(t,"montoTotal"),promedio:t.length>0?We().sumBy(t,"montoTotal")/t.length:0}}},[p]);return(0,u.jsxs)("div",{className:"competence-analysis-report",children:[(0,u.jsx)("h2",{className:"report-title",children:"\ud83c\udfe2 An\xe1lisis de Competencia Detallado"}),(0,u.jsxs)("div",{className:"report-section",children:[(0,u.jsx)("h3",{children:"\ud83d\udcca Concentraci\xf3n del Mercado"}),(0,u.jsxs)("div",{className:"concentration-metrics",children:[(0,u.jsxs)("div",{className:"concentration-card",children:[(0,u.jsx)("div",{className:"concentration-label",children:"Top 3 Proveedores"}),(0,u.jsxs)("div",{className:"concentration-value",children:[h.top3.toFixed(1),"%"]}),(0,u.jsx)("div",{className:"concentration-description",children:"del mercado total"})]}),(0,u.jsxs)("div",{className:"concentration-card",children:[(0,u.jsx)("div",{className:"concentration-label",children:"Top 5 Proveedores"}),(0,u.jsxs)("div",{className:"concentration-value",children:[h.top5.toFixed(1),"%"]}),(0,u.jsx)("div",{className:"concentration-description",children:"del mercado total"})]}),(0,u.jsxs)("div",{className:"concentration-card",children:[(0,u.jsx)("div",{className:"concentration-label",children:"Top 10 Proveedores"}),(0,u.jsxs)("div",{className:"concentration-value",children:[h.top10.toFixed(1),"%"]}),(0,u.jsx)("div",{className:"concentration-description",children:"del mercado total"})]})]}),(0,u.jsx)("div",{className:"concentration-interpretation",children:h.top5>60?(0,u.jsx)("div",{className:"alert warning",children:"\u26a0\ufe0f Mercado altamente concentrado - Alta barrera de entrada"}):h.top5>40?(0,u.jsx)("div",{className:"alert info",children:"\u2139\ufe0f Mercado moderadamente concentrado - Competencia significativa"}):(0,u.jsx)("div",{className:"alert success",children:"\u2705 Mercado fragmentado - M\xfaltiples oportunidades de entrada"})})]}),(0,u.jsxs)("div",{className:"report-section",children:[(0,u.jsx)("h3",{children:"\ud83d\udcc8 Segmentaci\xf3n de Proveedores"}),(0,u.jsxs)("div",{className:"segmentation-grid",children:[(0,u.jsxs)("div",{className:"segment-card large",children:[(0,u.jsxs)("div",{className:"segment-header",children:[(0,u.jsx)("div",{className:"segment-icon",children:"\ud83c\udfc6"}),(0,u.jsx)("div",{className:"segment-title",children:"Grandes"})]}),(0,u.jsxs)("div",{className:"segment-metric",children:[(0,u.jsx)("div",{className:"segment-label",children:"Cantidad"}),(0,u.jsx)("div",{className:"segment-value",children:m.grandes.cantidad})]}),(0,u.jsxs)("div",{className:"segment-metric",children:[(0,u.jsx)("div",{className:"segment-label",children:"Monto Total"}),(0,u.jsxs)("div",{className:"segment-value",children:["\u20a1",(m.grandes.montoTotal/1e6).toFixed(1),"M"]})]}),(0,u.jsxs)("div",{className:"segment-metric",children:[(0,u.jsx)("div",{className:"segment-label",children:"Promedio"}),(0,u.jsxs)("div",{className:"segment-value",children:["\u20a1",(m.grandes.promedio/1e6).toFixed(1),"M"]})]})]}),(0,u.jsxs)("div",{className:"segment-card medium",children:[(0,u.jsxs)("div",{className:"segment-header",children:[(0,u.jsx)("div",{className:"segment-icon",children:"\ud83e\udd48"}),(0,u.jsx)("div",{className:"segment-title",children:"Medianos"})]}),(0,u.jsxs)("div",{className:"segment-metric",children:[(0,u.jsx)("div",{className:"segment-label",children:"Cantidad"}),(0,u.jsx)("div",{className:"segment-value",children:m.medianos.cantidad})]}),(0,u.jsxs)("div",{className:"segment-metric",children:[(0,u.jsx)("div",{className:"segment-label",children:"Monto Total"}),(0,u.jsxs)("div",{className:"segment-value",children:["\u20a1",(m.medianos.montoTotal/1e6).toFixed(1),"M"]})]}),(0,u.jsxs)("div",{className:"segment-metric",children:[(0,u.jsx)("div",{className:"segment-label",children:"Promedio"}),(0,u.jsxs)("div",{className:"segment-value",children:["\u20a1",(m.medianos.promedio/1e6).toFixed(1),"M"]})]})]}),(0,u.jsxs)("div",{className:"segment-card small",children:[(0,u.jsxs)("div",{className:"segment-header",children:[(0,u.jsx)("div",{className:"segment-icon",children:"\ud83e\udd49"}),(0,u.jsx)("div",{className:"segment-title",children:"Peque\xf1os"})]}),(0,u.jsxs)("div",{className:"segment-metric",children:[(0,u.jsx)("div",{className:"segment-label",children:"Cantidad"}),(0,u.jsx)("div",{className:"segment-value",children:m.peque\u00f1os.cantidad})]}),(0,u.jsxs)("div",{className:"segment-metric",children:[(0,u.jsx)("div",{className:"segment-label",children:"Monto Total"}),(0,u.jsxs)("div",{className:"segment-value",children:["\u20a1",(m.peque\u00f1os.montoTotal/1e6).toFixed(1),"M"]})]}),(0,u.jsxs)("div",{className:"segment-metric",children:[(0,u.jsx)("div",{className:"segment-label",children:"Promedio"}),(0,u.jsxs)("div",{className:"segment-value",children:["\u20a1",(m.peque\u00f1os.promedio/1e6).toFixed(1),"M"]})]})]})]})]}),(0,u.jsxs)("div",{className:"report-section",children:[(0,u.jsx)("h3",{children:"\ud83c\udfc5 Ranking de Proveedores (Top 20)"}),(0,u.jsxs)("div",{className:"ranking-table",children:[(0,u.jsxs)("div",{className:"ranking-header",children:[(0,u.jsx)("div",{className:"rank-col",children:"#"}),(0,u.jsx)("div",{className:"name-col",children:"Proveedor"}),(0,u.jsx)("div",{className:"contracts-col",children:"Contratos"}),(0,u.jsx)("div",{className:"amount-col",children:"Monto Total"}),(0,u.jsx)("div",{className:"share-col",children:"Market Share"}),(0,u.jsx)("div",{className:"success-col",children:"Tasa \xc9xito"})]}),p.slice(0,20).map((e,a)=>(0,u.jsxs)("div",{className:"ranking-row",children:[(0,u.jsx)("div",{className:"rank-col",children:(0,u.jsx)("div",{className:"rank-badge rank-".concat(a<3?a+1:"other"),children:a+1})}),(0,u.jsxs)("div",{className:"name-col",children:[(0,u.jsx)("div",{className:"provider-name",children:e.nombre}),(0,u.jsx)("div",{className:"provider-id",children:e.id})]}),(0,u.jsx)("div",{className:"contracts-col",children:e.cantidadContratos}),(0,u.jsxs)("div",{className:"amount-col",children:[(0,u.jsxs)("div",{className:"amount-main",children:["\u20a1",(e.montoTotal/1e6).toFixed(2),"M"]}),(0,u.jsxs)("div",{className:"amount-avg",children:["Prom: \u20a1",(e.montoPromedio/1e3).toFixed(0),"K"]})]}),(0,u.jsx)("div",{className:"share-col",children:(0,u.jsxs)("div",{className:"share-bar",children:[(0,u.jsx)("div",{className:"share-fill",style:{width:"".concat(Math.min(10*e.marketShare,100),"%")}}),(0,u.jsxs)("span",{className:"share-text",children:[e.marketShare.toFixed(2),"%"]})]})}),(0,u.jsxs)("div",{className:"success-col",children:[(0,u.jsxs)("div",{className:"success-badge ".concat(e.tasaExito>=50?"high":e.tasaExito>=25?"medium":"low"),children:[e.tasaExito.toFixed(1),"%"]}),(0,u.jsxs)("div",{className:"success-detail",children:[e.totalOfertas," ofertas"]})]})]},e.id))]})]}),(0,u.jsxs)("div",{className:"report-section insights",children:[(0,u.jsx)("h3",{children:"\ud83d\udca1 Insights Competitivos"}),(0,u.jsxs)("div",{className:"insights-grid",children:[(0,u.jsxs)("div",{className:"insight-card",children:[(0,u.jsx)("div",{className:"insight-icon",children:"\ud83d\udc51"}),(0,u.jsxs)("div",{className:"insight-content",children:[(0,u.jsx)("div",{className:"insight-title",children:"L\xedder del Mercado"}),(0,u.jsxs)("div",{className:"insight-text",children:[null===(a=p[0])||void 0===a?void 0:a.nombre," domina con ",null===(t=p[0])||void 0===t?void 0:t.marketShare.toFixed(2),"% del mercado y ",null===(s=p[0])||void 0===s?void 0:s.cantidadContratos," contratos"]})]})]}),(0,u.jsxs)("div",{className:"insight-card",children:[(0,u.jsx)("div",{className:"insight-icon",children:"\ud83c\udfaf"}),(0,u.jsxs)("div",{className:"insight-content",children:[(0,u.jsx)("div",{className:"insight-title",children:"Mayor Eficiencia"}),(0,u.jsxs)("div",{className:"insight-text",children:[null===(r=p.reduce((e,a)=>a.tasaExito>e.tasaExito?a:e,p[0]))||void 0===r?void 0:r.nombre," ","tiene la mayor tasa de \xe9xito con"," ",null===(o=p.reduce((e,a)=>a.tasaExito>e.tasaExito?a:e,p[0]))||void 0===o?void 0:o.tasaExito.toFixed(1),"%"]})]})]}),(0,u.jsxs)("div",{className:"insight-card",children:[(0,u.jsx)("div",{className:"insight-icon",children:"\ud83d\udcbc"}),(0,u.jsxs)("div",{className:"insight-content",children:[(0,u.jsx)("div",{className:"insight-title",children:"Mayor Actividad"}),(0,u.jsxs)("div",{className:"insight-text",children:[null===(l=p.reduce((e,a)=>a.cantidadContratos>e.cantidadContratos?a:e,p[0]))||void 0===l?void 0:l.nombre," ","es el m\xe1s activo con"," ",null===(c=p.reduce((e,a)=>a.cantidadContratos>e.cantidadContratos?a:e,p[0]))||void 0===c?void 0:c.cantidadContratos," contratos"]})]})]}),(0,u.jsxs)("div",{className:"insight-card",children:[(0,u.jsx)("div",{className:"insight-icon",children:"\ud83d\udcca"}),(0,u.jsxs)("div",{className:"insight-content",children:[(0,u.jsx)("div",{className:"insight-title",children:"Diversidad del Mercado"}),(0,u.jsxs)("div",{className:"insight-text",children:[p.length," proveedores activos compiten en el per\xedodo analizado"]})]})]})]})]})]})};We().mixin({std:e=>{const a=We().mean(e)||0,t=We().mean(e.map(e=>Math.pow(e-a,2)))||0;return Math.sqrt(t)}});const ca=e=>{var a,t,s,r,o;let{filters:l}=e;const c=(0,i.useMemo)(()=>{const e=n.M.obtenerDatos("LineasAdjudicadas"),a=n.M.obtenerDatos("DetalleLineaCartel"),t=n.M.obtenerDatos("DetalleCarteles").filter(e=>e.fechaPublicacion&&e.fechaPublicacion>=l.periodo.inicio&&e.fechaPublicacion<=l.periodo.fin),i=[];e.forEach(e=>{const s=t.find(a=>a.numeroCartel===e.numeroCartel);if(!s)return;const r=a.find(a=>a.numeroCartel===e.numeroCartel&&a.numeroLinea===e.numeroLinea);if(r&&e.precioAdjudicado&&e.cantidadAdjudicada){if(l.sectores.length>0){const e="".concat(s.nombreCartel||""," ").concat(r.descripcionLinea||"").toLowerCase();if(!l.sectores.some(a=>e.includes(a.toLowerCase())))return}i.push({fecha:s.fechaPublicacion,producto:r.descripcionLinea,precio:e.precioAdjudicado,cantidad:e.cantidadAdjudicada,precioUnitario:e.precioAdjudicado/e.cantidadAdjudicada,proveedor:e.idProveedorAdjudicado,cartel:e.numeroCartel,unidadMedida:r.unidadMedida})}});const s=We().groupBy(i,e=>{const a=e.producto.toLowerCase();return a.includes("medicamento")||a.includes("medicina")?"Medicamentos":a.includes("computadora")||a.includes("laptop")||a.includes("equipo")?"Equipos":a.includes("servicio")||a.includes("consultor\xeda")?"Servicios":a.includes("alimento")||a.includes("comida")?"Alimentos":a.includes("construcci\xf3n")||a.includes("obra")?"Construcci\xf3n":a.includes("transporte")||a.includes("veh\xedculo")?"Transporte":a.includes("papel")||a.includes("\xfatil")?"Suministros":"Otros"}),r=We().map(s,(e,a)=>{const t=e.map(e=>e.precioUnitario).filter(e=>e>0&&e<1e9),i=We().sortBy(t);return{categoria:a,cantidad:e.length,precioPromedio:We().mean(t)||0,precioMinimo:We().min(t)||0,precioMaximo:We().max(t)||0,precioMediana:i[Math.floor(i.length/2)]||0,variabilidad:We().mean(t)>0?We().std(t)/We().mean(t)*100:0,tendencia:d(e)}}).sort((e,a)=>a.cantidad-e.cantidad);return{preciosHistoricos:i,estadisticasPorCategoria:r,totalRegistros:i.length}},[l]),d=e=>{if(e.length<2)return 0;const a=We().sortBy(e,"fecha"),t=a.slice(0,Math.floor(a.length/4)),i=a.slice(-Math.floor(a.length/4)),s=We().meanBy(t,"precioUnitario")||1;return((We().meanBy(i,"precioUnitario")||0)-s)/s*100},p=(0,i.useMemo)(()=>{const e=We().groupBy(c.preciosHistoricos,e=>{const a=e.fecha;return a?"".concat(a.getFullYear(),"-").concat(String(a.getMonth()+1).padStart(2,"0")):"Sin fecha"});return We().map(e,(e,a)=>({periodo:a,precioPromedio:We().meanBy(e,"precioUnitario")||0,cantidad:e.length,montoTotal:We().sumBy(e,"precio")||0})).filter(e=>"Sin fecha"!==e.periodo).sort((e,a)=>e.periodo.localeCompare(a.periodo))},[c]);return(0,u.jsxs)("div",{className:"price-trends-report",children:[(0,u.jsx)("h2",{className:"report-title",children:"\ud83d\udcb0 Tendencias de Precios Hist\xf3ricos"}),(0,u.jsx)("div",{className:"report-intro",children:(0,u.jsxs)("p",{children:["An\xe1lisis de ",c.totalRegistros.toLocaleString()," registros de precios en ",c.estadisticasPorCategoria.length," categor\xedas"]})}),0===c.estadisticasPorCategoria.length&&(0,u.jsx)("div",{className:"no-data-message",children:(0,u.jsx)("div",{className:"alert info",children:"\u2139\ufe0f No hay suficientes datos de precios en el per\xedodo seleccionado. Prueba ajustando los filtros de per\xedodo o sectores."})}),(0,u.jsxs)("div",{className:"report-section",children:[(0,u.jsx)("h3",{children:"\ud83d\udcca An\xe1lisis por Categor\xeda de Producto"}),(0,u.jsx)("div",{className:"categories-grid",children:c.estadisticasPorCategoria.map(e=>(0,u.jsxs)("div",{className:"category-price-card",children:[(0,u.jsxs)("div",{className:"category-header",children:[(0,u.jsx)("div",{className:"category-name",children:e.categoria}),(0,u.jsxs)("div",{className:"category-trend ".concat(e.tendencia>=0?"up":"down"),children:[e.tendencia>=0?"\ud83d\udcc8":"\ud83d\udcc9"," ",Math.abs(e.tendencia).toFixed(1),"%"]})]}),(0,u.jsxs)("div",{className:"category-stats",children:[(0,u.jsxs)("div",{className:"stat-row",children:[(0,u.jsx)("span",{className:"stat-label",children:"Registros:"}),(0,u.jsx)("span",{className:"stat-value",children:e.cantidad})]}),(0,u.jsxs)("div",{className:"stat-row highlight",children:[(0,u.jsx)("span",{className:"stat-label",children:"Precio Promedio:"}),(0,u.jsxs)("span",{className:"stat-value",children:["\u20a1",e.precioPromedio.toLocaleString(void 0,{maximumFractionDigits:0})]})]}),(0,u.jsxs)("div",{className:"stat-row",children:[(0,u.jsx)("span",{className:"stat-label",children:"M\xednimo:"}),(0,u.jsxs)("span",{className:"stat-value",children:["\u20a1",e.precioMinimo.toLocaleString(void 0,{maximumFractionDigits:0})]})]}),(0,u.jsxs)("div",{className:"stat-row",children:[(0,u.jsx)("span",{className:"stat-label",children:"M\xe1ximo:"}),(0,u.jsxs)("span",{className:"stat-value",children:["\u20a1",e.precioMaximo.toLocaleString(void 0,{maximumFractionDigits:0})]})]}),(0,u.jsxs)("div",{className:"stat-row",children:[(0,u.jsx)("span",{className:"stat-label",children:"Mediana:"}),(0,u.jsxs)("span",{className:"stat-value",children:["\u20a1",e.precioMediana.toLocaleString(void 0,{maximumFractionDigits:0})]})]})]}),(0,u.jsxs)("div",{className:"category-variability",children:[(0,u.jsx)("div",{className:"variability-label",children:"Variabilidad"}),(0,u.jsxs)("div",{className:"variability-bar",children:[(0,u.jsx)("div",{className:"variability-fill ".concat(e.variabilidad>50?"high":e.variabilidad>25?"medium":"low"),style:{width:"".concat(Math.min(e.variabilidad,100),"%")}}),(0,u.jsxs)("span",{className:"variability-text",children:[e.variabilidad.toFixed(1),"%"]})]})]})]},e.categoria))})]}),(0,u.jsxs)("div",{className:"report-section",children:[(0,u.jsx)("h3",{children:"\ud83d\udcc8 Evoluci\xf3n Temporal de Precios"}),(0,u.jsx)("div",{className:"temporal-chart",children:(0,u.jsx)("div",{className:"chart-container",children:p.length>0?(0,u.jsx)("div",{className:"line-chart",children:p.map((e,a)=>{const t=Math.max(...p.map(e=>e.precioPromedio)),i=e.precioPromedio/t*100;return(0,u.jsxs)("div",{className:"chart-bar",children:[(0,u.jsx)("div",{className:"bar-container",children:(0,u.jsx)("div",{className:"bar-fill",style:{height:"".concat(i,"%")},title:"\u20a1".concat(e.precioPromedio.toLocaleString(void 0,{maximumFractionDigits:0}))})}),(0,u.jsx)("div",{className:"bar-label",children:e.periodo}),(0,u.jsxs)("div",{className:"bar-value",children:["\u20a1",(e.precioPromedio/1e3).toFixed(0),"K"]})]},e.periodo)})}):(0,u.jsx)("div",{className:"no-data",children:"No hay datos suficientes para mostrar la evoluci\xf3n temporal"})})})]}),(0,u.jsxs)("div",{className:"report-section",children:[(0,u.jsx)("h3",{children:"\ud83d\udcca Variabilidad de Precios por Categor\xeda"}),(0,u.jsx)("div",{className:"variability-comparison",children:c.estadisticasPorCategoria.map(e=>(0,u.jsxs)("div",{className:"variability-row",children:[(0,u.jsx)("div",{className:"variability-category",children:e.categoria}),(0,u.jsxs)("div",{className:"variability-visual",children:[(0,u.jsxs)("div",{className:"variability-range",children:[(0,u.jsxs)("span",{className:"range-min",children:["\u20a1",(e.precioMinimo/1e3).toFixed(0),"K"]}),(0,u.jsx)("div",{className:"range-bar",children:(0,u.jsx)("div",{className:"range-median",style:{left:"".concat((e.precioMediana-e.precioMinimo)/(e.precioMaximo-e.precioMinimo)*100,"%")},children:(0,u.jsx)("span",{className:"median-label",children:"Mediana"})})}),(0,u.jsxs)("span",{className:"range-max",children:["\u20a1",(e.precioMaximo/1e3).toFixed(0),"K"]})]}),(0,u.jsxs)("div",{className:"variability-coefficient",children:["CV: ",e.variabilidad.toFixed(1),"%"]})]})]},e.categoria))})]}),(0,u.jsxs)("div",{className:"report-section insights",children:[(0,u.jsx)("h3",{children:"\ud83d\udca1 Insights de Precios"}),c.estadisticasPorCategoria.length>0?(0,u.jsxs)("div",{className:"insights-grid",children:[(0,u.jsxs)("div",{className:"insight-card",children:[(0,u.jsx)("div",{className:"insight-icon",children:"\ud83d\udcc8"}),(0,u.jsxs)("div",{className:"insight-content",children:[(0,u.jsx)("div",{className:"insight-title",children:"Mayor Crecimiento"}),(0,u.jsxs)("div",{className:"insight-text",children:[null===(a=c.estadisticasPorCategoria.reduce((e,a)=>a.tendencia>e.tendencia?a:e,c.estadisticasPorCategoria[0]))||void 0===a?void 0:a.categoria," ","ha incrementado ",Math.max(...c.estadisticasPorCategoria.map(e=>e.tendencia||0)).toFixed(1),"% en el per\xedodo"]})]})]}),(0,u.jsxs)("div",{className:"insight-card",children:[(0,u.jsx)("div",{className:"insight-icon",children:"\u2696\ufe0f"}),(0,u.jsxs)("div",{className:"insight-content",children:[(0,u.jsx)("div",{className:"insight-title",children:"Mayor Estabilidad"}),(0,u.jsxs)("div",{className:"insight-text",children:[null===(t=c.estadisticasPorCategoria.reduce((e,a)=>a.variabilidad<e.variabilidad?a:e,c.estadisticasPorCategoria[0]))||void 0===t?void 0:t.categoria," ","presenta la menor variabilidad con ",Math.min(...c.estadisticasPorCategoria.map(e=>e.variabilidad||0)).toFixed(1),"%"]})]})]}),(0,u.jsxs)("div",{className:"insight-card",children:[(0,u.jsx)("div",{className:"insight-icon",children:"\ud83c\udfaf"}),(0,u.jsxs)("div",{className:"insight-content",children:[(0,u.jsx)("div",{className:"insight-title",children:"Mayor Actividad"}),(0,u.jsxs)("div",{className:"insight-text",children:[null===(s=c.estadisticasPorCategoria[0])||void 0===s?void 0:s.categoria," lidera con ",null===(r=c.estadisticasPorCategoria[0])||void 0===r?void 0:r.cantidad," registros"]})]})]}),(0,u.jsxs)("div",{className:"insight-card warning",children:[(0,u.jsx)("div",{className:"insight-icon",children:"\u26a0\ufe0f"}),(0,u.jsxs)("div",{className:"insight-content",children:[(0,u.jsx)("div",{className:"insight-title",children:"Mayor Volatilidad"}),(0,u.jsxs)("div",{className:"insight-text",children:[null===(o=c.estadisticasPorCategoria.reduce((e,a)=>a.variabilidad>e.variabilidad?a:e,c.estadisticasPorCategoria[0]))||void 0===o?void 0:o.categoria," ","muestra alta variabilidad (",Math.max(...c.estadisticasPorCategoria.map(e=>e.variabilidad||0)).toFixed(1),"%) - Requiere an\xe1lisis detallado"]})]})]})]}):(0,u.jsx)("div",{className:"alert info",children:"\u2139\ufe0f No hay suficientes datos para generar insights de precios"})]}),(0,u.jsxs)("div",{className:"report-section recommendations",children:[(0,u.jsx)("h3",{children:"\ud83d\udca1 Recomendaciones de Precio"}),(0,u.jsxs)("ul",{className:"recommendations-list",children:[(0,u.jsx)("li",{children:"Para categor\xedas con alta variabilidad (>50%), realice an\xe1lisis detallado de especificaciones t\xe9cnicas que puedan justificar las diferencias de precio"}),(0,u.jsx)("li",{children:"Considere los precios medianos en lugar de promedios para categor\xedas con alta dispersi\xf3n"}),(0,u.jsx)("li",{children:"Categor\xedas con tendencia positiva sostenida pueden requerir ajuste de presupuestos futuros"}),(0,u.jsx)("li",{children:"Monitoree de cerca las categor\xedas con volatilidad creciente para identificar oportunidades de ahorro"})]})]})]})},da=e=>{let{filters:a}=e;const t=(0,i.useMemo)(()=>{let e=n.M.obtenerDatos("DetalleCarteles").filter(e=>e.fechaPublicacion&&e.fechaPublicacion>=a.periodo.inicio&&e.fechaPublicacion<=a.periodo.fin),t=n.M.obtenerDatos("Contratos").filter(e=>e.fechaFirma&&e.fechaFirma>=a.periodo.inicio&&e.fechaFirma<=a.periodo.fin);if(a.categorias&&a.categorias.length>0){const i=n.M.obtenerDatos("CategoriasUsuario")||[];e=e.filter(e=>i.some(t=>{var i;return!!a.categorias.includes(t.nombreCategoria)&&(null===(i=t.carteles)||void 0===i?void 0:i.some(a=>a.numeroCartel===e.numeroCartel))})),t=t.filter(e=>i.some(t=>{var i;return!!a.categorias.includes(t.nombreCategoria)&&(null===(i=t.contratos)||void 0===i?void 0:i.some(a=>a.idContrato===e.idContrato))}))}const i=n.M.obtenerDatos("LineasAdjudicadas"),s=n.M.obtenerDatos("LineasRecibidas"),r=n.M.obtenerDatos("InstitucionesRegistradas"),o=[],l=s.filter(e=>e.cantidadOfertasRecibidas<=3&&e.cantidadOfertasRecibidas>0);if(l.length>0){const e=We().sumBy(l.map(e=>i.find(a=>a.numeroCartel===e.numeroCartel&&a.numeroLinea===e.numeroLinea)).filter(Boolean),"precioAdjudicado")||0;o.push({tipo:"poca_competencia",titulo:"Nichos con Baja Competencia",descripcion:"Se identificaron ".concat(l.length," l\xedneas con 3 o menos oferentes, indicando oportunidades con poca competencia"),potencial:"Alto",montoEstimado:e,metricas:[{label:"L\xedneas identificadas",value:l.length.toString()},{label:"Competencia promedio",value:"".concat(We().meanBy(l,"cantidadOfertasRecibidas").toFixed(1)," ofertas")},{label:"Monto estimado",value:"\u20a1".concat((e/1e6).toFixed(1),"M")}],recomendaciones:["Analizar especificaciones t\xe9cnicas de estas l\xedneas para evaluar viabilidad de entrada","Menor competencia puede significar requisitos especializados o barreras t\xe9cnicas","Considerar alianzas estrat\xe9gicas para cumplir requisitos complejos"]})}["medicamentos","tecnolog\xeda","construcci\xf3n","servicios","educaci\xf3n"].forEach(i=>{const s=e.filter(e=>"".concat(e.nombreCartel||""," ").concat(e.descripcionCartel||"").toLowerCase().includes(i.toLowerCase())),r=new Date(a.periodo.inicio);r.setFullYear(r.getFullYear()-1);const l=new Date(a.periodo.fin);l.setFullYear(l.getFullYear()-1);const c=n.M.obtenerDatos("DetalleCarteles").filter(e=>e.fechaPublicacion&&e.fechaPublicacion>=r&&e.fechaPublicacion<=l).filter(e=>"".concat(e.nombreCartel||""," ").concat(e.descripcionCartel||"").toLowerCase().includes(i.toLowerCase())),d=c.length>0?(s.length-c.length)/c.length*100:0;if(d>20){const e=t.filter(e=>n.M.obtenerDatos("LineasContratadas").filter(a=>a.idContrato===e.idContrato).some(e=>{const a=n.M.obtenerDatos("DetalleLineaCartel").find(a=>a.numeroCartel===e.numeroCartel&&a.numeroLinea===e.numeroLinea);return!!a&&a.descripcionLinea.toLowerCase().includes(i.toLowerCase())})),a=We().sumBy(e,e=>n.M.obtenerMontoContratoPreciso(e))||0;o.push({tipo:"crecimiento",titulo:"Sector ".concat(i.toUpperCase()," en Expansi\xf3n"),descripcion:"El sector ".concat(i," muestra un crecimiento de ").concat(d.toFixed(1),"% interanual, indicando demanda creciente"),potencial:d>50?"Alto":"Medio",montoEstimado:a,metricas:[{label:"Crecimiento",value:"".concat(d.toFixed(1),"%")},{label:"Licitaciones actuales",value:s.length.toString()},{label:"Monto de mercado",value:"\u20a1".concat((a/1e6).toFixed(1),"M")}],recomendaciones:["Sector con demanda creciente - considerar entrada o expansi\xf3n","Preparar capacidades t\xe9cnicas para aprovechar la tendencia","Monitorear requisitos y especificaciones recurrentes"]})}});const c=We().groupBy(e,"codigoInstitucion"),d=We().map(c,(e,a)=>{const i=r.find(e=>e.codigoInstitucion===a),s=t.filter(e=>e.codigoInstitucion===a),o=We().sumBy(s,e=>n.M.obtenerMontoContratoPreciso(e))||0;return{codigo:a,nombre:(null===i||void 0===i?void 0:i.nombreInstitucion)||"Desconocida",cantidadCarteles:e.length,montoTotal:o}}).filter(e=>e.cantidadCarteles>=10).sort((e,a)=>a.montoTotal-e.montoTotal).slice(0,5);d.length>0&&o.push({tipo:"alta_demanda",titulo:"Clientes Institucionales de Alto Valor",descripcion:"Se identificaron ".concat(d.length," instituciones con alta actividad y presupuesto significativo"),potencial:"Alto",montoEstimado:We().sumBy(d,"montoTotal"),metricas:[{label:"Instituciones clave",value:d.length.toString()},{label:"Licitaciones totales",value:We().sumBy(d,"cantidadCarteles").toString()},{label:"Presupuesto combinado",value:"\u20a1".concat((We().sumBy(d,"montoTotal")/1e6).toFixed(1),"M")}],recomendaciones:["Priorizar relaciones con: ".concat(d.slice(0,3).map(e=>e.nombre).join(", ")),"Analizar historial de compras para identificar necesidades recurrentes","Desarrollar propuestas especializadas para estas instituciones"]});return["digital","cloud","remoto","virtual","sostenible","renovable","inteligencia artificial","ciberseguridad"].forEach(a=>{const i=e.filter(e=>"".concat(e.nombreCartel||""," ").concat(e.descripcionCartel||"").toLowerCase().includes(a.toLowerCase()));if(i.length>=5){const s=t.filter(t=>{const i=e.find(e=>e.numeroCartel===t.numeroCartel);if(!i)return!1;return"".concat(i.nombreCartel||""," ").concat(i.descripcionCartel||"").toLowerCase().includes(a.toLowerCase())}),r=We().sumBy(s,e=>n.M.obtenerMontoContratoPreciso(e))||0;o.push({tipo:"emergente",titulo:"Tecnolog\xeda Emergente: ".concat(a.toUpperCase()),descripcion:"Tendencia emergente con ".concat(i.length," licitaciones relacionadas con ").concat(a),potencial:"Medio",montoEstimado:r,metricas:[{label:"Licitaciones",value:i.length.toString()},{label:"Contratos",value:s.length.toString()},{label:"Monto estimado",value:"\u20a1".concat((r/1e6).toFixed(1),"M")}],recomendaciones:["Sector emergente - posible ventana de oportunidad para early adopters","Considerar desarrollo de capacidades en esta \xe1rea","Monitorear evoluci\xf3n de requisitos t\xe9cnicos"]})}}),We().orderBy(o,[e=>"Alto"===e.potencial?3:"Medio"===e.potencial?2:1,"montoEstimado"],["desc","desc"]).slice(0,10)},[a]),s=(0,i.useMemo)(()=>({total:t.length,altas:t.filter(e=>"Alto"===e.potencial).length,medias:t.filter(e=>"Medio"===e.potencial).length,bajas:t.filter(e=>"Bajo"===e.potencial).length,montoTotal:We().sumBy(t,"montoEstimado")}),[t]),r=e=>"Alto"===e?"high":"Medio"===e?"medium":"low";return(0,u.jsxs)("div",{className:"opportunities-report",children:[(0,u.jsx)("h2",{className:"report-title",children:"\ud83c\udfaf Identificaci\xf3n de Oportunidades de Negocio"}),(0,u.jsxs)("div",{className:"opportunities-summary",children:[(0,u.jsxs)("div",{className:"summary-card total",children:[(0,u.jsx)("div",{className:"summary-icon",children:"\ud83d\udca1"}),(0,u.jsxs)("div",{className:"summary-content",children:[(0,u.jsx)("div",{className:"summary-value",children:s.total}),(0,u.jsx)("div",{className:"summary-label",children:"Oportunidades Identificadas"})]})]}),(0,u.jsxs)("div",{className:"summary-card high",children:[(0,u.jsx)("div",{className:"summary-icon",children:"\ud83d\udd25"}),(0,u.jsxs)("div",{className:"summary-content",children:[(0,u.jsx)("div",{className:"summary-value",children:s.altas}),(0,u.jsx)("div",{className:"summary-label",children:"Potencial Alto"})]})]}),(0,u.jsxs)("div",{className:"summary-card medium",children:[(0,u.jsx)("div",{className:"summary-icon",children:"\u2b50"}),(0,u.jsxs)("div",{className:"summary-content",children:[(0,u.jsx)("div",{className:"summary-value",children:s.medias}),(0,u.jsx)("div",{className:"summary-label",children:"Potencial Medio"})]})]}),(0,u.jsxs)("div",{className:"summary-card value",children:[(0,u.jsx)("div",{className:"summary-icon",children:"\ud83d\udcb0"}),(0,u.jsxs)("div",{className:"summary-content",children:[(0,u.jsxs)("div",{className:"summary-value",children:["\u20a1",(s.montoTotal/1e6).toFixed(1),"M"]}),(0,u.jsx)("div",{className:"summary-label",children:"Valor Total Estimado"})]})]})]}),(0,u.jsx)("div",{className:"opportunities-list",children:t.map((e,a)=>{return(0,u.jsxs)("div",{className:"opportunity-card ".concat(r(e.potencial)),children:[(0,u.jsxs)("div",{className:"opportunity-header",children:[(0,u.jsx)("div",{className:"opportunity-icon",children:(t=e.tipo,{nicho:"\ud83c\udfaf",crecimiento:"\ud83d\udcc8",poca_competencia:"\ud83d\ude80",alta_demanda:"\ud83d\udcbc",emergente:"\u26a1"}[t]||"\ud83d\udca1")}),(0,u.jsxs)("div",{className:"opportunity-title-section",children:[(0,u.jsx)("div",{className:"opportunity-title",children:e.titulo}),(0,u.jsx)("div",{className:"opportunity-type-badge",children:e.tipo.replace("_"," ").toUpperCase()})]}),(0,u.jsxs)("div",{className:"opportunity-potential ".concat(r(e.potencial)),children:["Potencial ",e.potencial]})]}),(0,u.jsx)("div",{className:"opportunity-description",children:e.descripcion}),(0,u.jsx)("div",{className:"opportunity-metrics",children:e.metricas.map((e,a)=>(0,u.jsxs)("div",{className:"opportunity-metric",children:[(0,u.jsx)("div",{className:"metric-label",children:e.label}),(0,u.jsx)("div",{className:"metric-value",children:e.value})]},a))}),(0,u.jsxs)("div",{className:"opportunity-recommendations",children:[(0,u.jsx)("div",{className:"recommendations-title",children:"\ud83d\udca1 Acciones Recomendadas:"}),(0,u.jsx)("ul",{children:e.recomendaciones.map((e,a)=>(0,u.jsx)("li",{children:e},a))})]})]},a);var t})}),0===t.length&&(0,u.jsxs)("div",{className:"no-opportunities",children:[(0,u.jsx)("div",{className:"no-opportunities-icon",children:"\ud83d\udd0d"}),(0,u.jsx)("div",{className:"no-opportunities-text",children:"No se identificaron oportunidades significativas en el per\xedodo seleccionado. Intente ajustar los filtros o ampliar el rango de fechas."})]}),t.length>0&&(0,u.jsxs)("div",{className:"report-section insights",children:[(0,u.jsx)("h3",{children:"\ud83d\udca1 Insights Estrat\xe9gicos"}),(0,u.jsxs)("div",{className:"insights-grid",children:[(0,u.jsxs)("div",{className:"insight-card",children:[(0,u.jsx)("div",{className:"insight-icon",children:"\ud83c\udfaf"}),(0,u.jsxs)("div",{className:"insight-content",children:[(0,u.jsx)("div",{className:"insight-title",children:"Foco Estrat\xe9gico"}),(0,u.jsxs)("div",{className:"insight-text",children:["Priorizar las ",s.altas," oportunidades de alto potencial para maximizar retorno de inversi\xf3n"]})]})]}),(0,u.jsxs)("div",{className:"insight-card",children:[(0,u.jsx)("div",{className:"insight-icon",children:"\u23f1\ufe0f"}),(0,u.jsxs)("div",{className:"insight-content",children:[(0,u.jsx)("div",{className:"insight-title",children:"Ventana de Oportunidad"}),(0,u.jsx)("div",{className:"insight-text",children:"Los sectores emergentes representan oportunidades tempranas antes de que aumente la competencia"})]})]}),(0,u.jsxs)("div",{className:"insight-card",children:[(0,u.jsx)("div",{className:"insight-icon",children:"\ud83e\udd1d"}),(0,u.jsxs)("div",{className:"insight-content",children:[(0,u.jsx)("div",{className:"insight-title",children:"Alianzas Estrat\xe9gicas"}),(0,u.jsx)("div",{className:"insight-text",children:"Para nichos especializados, considerar joint ventures o alianzas para cumplir requisitos complejos"})]})]})]})]})]})};We().mixin({std:e=>{const a=We().mean(e)||0,t=We().mean(e.map(e=>Math.pow(e-a,2)))||0;return Math.sqrt(t)}});const pa=e=>{let{filters:a}=e;const t=(0,i.useMemo)(()=>{const e=n.M.obtenerDatos("DetalleCarteles").filter(e=>e.fechaPublicacion&&e.fechaPublicacion>=a.periodo.inicio&&e.fechaPublicacion<=a.periodo.fin),t=n.M.obtenerDatos("Contratos").filter(e=>e.fechaFirma&&e.fechaFirma>=a.periodo.inicio&&e.fechaFirma<=a.periodo.fin),i=n.M.obtenerDatos("Ofertas"),s=n.M.obtenerDatos("LineasRecibidas"),r=n.M.obtenerDatos("LineasAdjudicadas"),o=n.M.obtenerDatos("FechaPorEtapas"),l=e.length||1,c=t.length/l*100,d=e.map(e=>{const a=o.find(a=>a.numeroCartel===e.numeroCartel);if(!a||!a.fechaPublicacion||!a.fechaAdjudicacion)return null;const t=new Date(a.fechaPublicacion);return(new Date(a.fechaAdjudicacion).getTime()-t.getTime())/864e5}).filter(e=>null!==e&&e>0),p=We().mean(d)||0,h=We().meanBy(s,"cantidadOfertasRecibidas")||0,m=We().meanBy(t,e=>n.M.obtenerMontoContratoPreciso(e))||0,x=i.length||1,g=t.length/x*100,u=We().groupBy(t,"idProveedor"),f=We().sumBy(t,e=>n.M.obtenerMontoContratoPreciso(e))||1,b=We().sumBy(Object.values(u),e=>{const a=We().sumBy(e,e=>n.M.obtenerMontoContratoPreciso(e))/f*100;return Math.pow(a,2)}),v=s.filter(e=>e.cantidadOfertasRecibidas>0).length,j=r.filter(a=>!!e.find(e=>e.numeroCartel===a.numeroCartel)).length,y=v>0?j/v*100:0,N=r.map(e=>e.precioAdjudicado).filter(e=>e>0),C=N.length>1?We().std(N):0;return{tasaAdjudicacion:c,tiempoPromedio:p,competenciaPromedio:h,montoPromedio:m,tasaExitoGlobal:g,hhi:b,eficienciaAdjudicacion:y,coeficienteVariacion:We().mean(N)?C/We().mean(N)*100:0,totalLicitaciones:e.length,totalContratos:t.length,totalOfertas:x,montoTotal:f}},[a]),s=(0,i.useMemo)(()=>{const e=n.M.obtenerDatos("DetalleCarteles").filter(e=>e.fechaPublicacion&&e.fechaPublicacion>=a.periodo.inicio&&e.fechaPublicacion<=a.periodo.fin),t=n.M.obtenerDatos("Contratos").filter(e=>e.fechaFirma&&e.fechaFirma>=a.periodo.inicio&&e.fechaFirma<=a.periodo.fin),i=n.M.obtenerDatos("InstitucionesRegistradas"),s=n.M.obtenerDatos("FechaPorEtapas"),r=We().groupBy(e,"codigoInstitucion");return We().map(r,(e,a)=>{const r=i.find(e=>e.codigoInstitucion===a),o=t.filter(e=>e.codigoInstitucion===a),l=e.map(e=>{const a=s.find(a=>a.numeroCartel===e.numeroCartel);if(!a||!a.fechaPublicacion||!a.fechaAdjudicacion)return null;const t=new Date(a.fechaPublicacion);return(new Date(a.fechaAdjudicacion).getTime()-t.getTime())/864e5}).filter(e=>null!==e&&e>0),c=We().sumBy(o,e=>n.M.obtenerMontoContratoPreciso(e))||0;return{codigo:a,nombre:(null===r||void 0===r?void 0:r.nombreInstitucion)||"Desconocida",cantidadLicitaciones:e.length,cantidadContratos:o.length,montoTotal:c,tiempoPromedio:We().mean(l)||0,tasaConversion:e.length>0?o.length/e.length*100:0}}).filter(e=>e.cantidadLicitaciones>=5).sort((e,a)=>a.montoTotal-e.montoTotal).slice(0,10)},[a]),r=(0,i.useMemo)(()=>{const e=n.M.obtenerDatos("Contratos").filter(e=>e.fechaFirma&&e.fechaFirma>=a.periodo.inicio&&e.fechaFirma<=a.periodo.fin),t=We().groupBy(e,e=>{const a=e.fechaFirma;return a?"".concat(a.getFullYear(),"-").concat(String(a.getMonth()+1).padStart(2,"0")):"Sin fecha"});return We().map(t,(e,a)=>({periodo:a,cantidad:e.length,monto:We().sumBy(e,e=>n.M.obtenerMontoContratoPreciso(e))||0,promedio:We().meanBy(e,e=>n.M.obtenerMontoContratoPreciso(e))||0})).filter(e=>"Sin fecha"!==e.periodo).sort((e,a)=>e.periodo.localeCompare(a.periodo))},[a]),o=(e,a)=>{switch(e){case"tasaAdjudicacion":return a>=70?"excelente":a>=50?"bueno":a>=30?"regular":"bajo";case"competenciaPromedio":return a>=5?"excelente":a>=3?"bueno":a>=2?"regular":"bajo";case"tiempoPromedio":return a<=30?"excelente":a<=60?"bueno":a<=90?"regular":"bajo";case"hhi":return a<1500?"excelente":a<2500?"bueno":"regular";default:return"regular"}};return(0,u.jsxs)("div",{className:"performance-metrics-report",children:[(0,u.jsx)("h2",{className:"report-title",children:"\ud83d\udcc8 M\xe9tricas de Desempe\xf1o"}),(0,u.jsxs)("div",{className:"report-section",children:[(0,u.jsx)("h3",{children:"\ud83d\udcca Indicadores Clave de Rendimiento (KPIs)"}),(0,u.jsxs)("div",{className:"kpis-grid",children:[(0,u.jsxs)("div",{className:"kpi-card ".concat(o("tasaAdjudicacion",t.tasaAdjudicacion)),children:[(0,u.jsx)("div",{className:"kpi-icon",children:"\ud83c\udfaf"}),(0,u.jsxs)("div",{className:"kpi-content",children:[(0,u.jsx)("div",{className:"kpi-label",children:"Tasa de Adjudicaci\xf3n"}),(0,u.jsxs)("div",{className:"kpi-value",children:[t.tasaAdjudicacion.toFixed(1),"%"]}),(0,u.jsxs)("div",{className:"kpi-description",children:[t.totalContratos," de ",t.totalLicitaciones," licitaciones"]})]})]}),(0,u.jsxs)("div",{className:"kpi-card ".concat(o("tiempoPromedio",t.tiempoPromedio)),children:[(0,u.jsx)("div",{className:"kpi-icon",children:"\u23f1\ufe0f"}),(0,u.jsxs)("div",{className:"kpi-content",children:[(0,u.jsx)("div",{className:"kpi-label",children:"Tiempo Promedio"}),(0,u.jsxs)("div",{className:"kpi-value",children:[t.tiempoPromedio.toFixed(0)," d\xedas"]}),(0,u.jsx)("div",{className:"kpi-description",children:"Desde publicaci\xf3n a adjudicaci\xf3n"})]})]}),(0,u.jsxs)("div",{className:"kpi-card ".concat(o("competenciaPromedio",t.competenciaPromedio)),children:[(0,u.jsx)("div",{className:"kpi-icon",children:"\ud83c\udfe2"}),(0,u.jsxs)("div",{className:"kpi-content",children:[(0,u.jsx)("div",{className:"kpi-label",children:"Competencia Promedio"}),(0,u.jsx)("div",{className:"kpi-value",children:t.competenciaPromedio.toFixed(1)}),(0,u.jsx)("div",{className:"kpi-description",children:"Ofertas por l\xednea"})]})]}),(0,u.jsxs)("div",{className:"kpi-card",children:[(0,u.jsx)("div",{className:"kpi-icon",children:"\ud83d\udcb0"}),(0,u.jsxs)("div",{className:"kpi-content",children:[(0,u.jsx)("div",{className:"kpi-label",children:"Monto Promedio"}),(0,u.jsxs)("div",{className:"kpi-value",children:["\u20a1",(t.montoPromedio/1e6).toFixed(2),"M"]}),(0,u.jsx)("div",{className:"kpi-description",children:"Por contrato"})]})]}),(0,u.jsxs)("div",{className:"kpi-card",children:[(0,u.jsx)("div",{className:"kpi-icon",children:"\ud83d\udcc8"}),(0,u.jsxs)("div",{className:"kpi-content",children:[(0,u.jsx)("div",{className:"kpi-label",children:"Tasa de \xc9xito Global"}),(0,u.jsxs)("div",{className:"kpi-value",children:[t.tasaExitoGlobal.toFixed(1),"%"]}),(0,u.jsx)("div",{className:"kpi-description",children:"Contratos / Ofertas totales"})]})]}),(0,u.jsxs)("div",{className:"kpi-card ".concat(o("hhi",t.hhi)),children:[(0,u.jsx)("div",{className:"kpi-icon",children:"\ud83d\udcca"}),(0,u.jsxs)("div",{className:"kpi-content",children:[(0,u.jsx)("div",{className:"kpi-label",children:"\xcdndice HHI"}),(0,u.jsx)("div",{className:"kpi-value",children:t.hhi.toFixed(0)}),(0,u.jsx)("div",{className:"kpi-description",children:t.hhi<1500?"Mercado competitivo":t.hhi<2500?"Moderadamente concentrado":"Alta concentraci\xf3n"})]})]}),(0,u.jsxs)("div",{className:"kpi-card",children:[(0,u.jsx)("div",{className:"kpi-icon",children:"\u2705"}),(0,u.jsxs)("div",{className:"kpi-content",children:[(0,u.jsx)("div",{className:"kpi-label",children:"Eficiencia de Adjudicaci\xf3n"}),(0,u.jsxs)("div",{className:"kpi-value",children:[t.eficienciaAdjudicacion.toFixed(1),"%"]}),(0,u.jsx)("div",{className:"kpi-description",children:"L\xedneas con ofertas que se adjudican"})]})]}),(0,u.jsxs)("div",{className:"kpi-card",children:[(0,u.jsx)("div",{className:"kpi-icon",children:"\ud83d\udcc9"}),(0,u.jsxs)("div",{className:"kpi-content",children:[(0,u.jsx)("div",{className:"kpi-label",children:"Variabilidad de Precios"}),(0,u.jsxs)("div",{className:"kpi-value",children:[t.coeficienteVariacion.toFixed(1),"%"]}),(0,u.jsx)("div",{className:"kpi-description",children:"Coeficiente de variaci\xf3n"})]})]})]})]}),(0,u.jsxs)("div",{className:"report-section",children:[(0,u.jsx)("h3",{children:"\ud83c\udfdb\ufe0f Benchmarking por Instituci\xf3n (Top 10)"}),(0,u.jsxs)("div",{className:"benchmarking-table",children:[(0,u.jsxs)("div",{className:"benchmarking-header",children:[(0,u.jsx)("div",{className:"inst-col",children:"Instituci\xf3n"}),(0,u.jsx)("div",{className:"licit-col",children:"Licitaciones"}),(0,u.jsx)("div",{className:"cont-col",children:"Contratos"}),(0,u.jsx)("div",{className:"monto-col",children:"Monto Total"}),(0,u.jsx)("div",{className:"tiempo-col",children:"Tiempo Prom."}),(0,u.jsx)("div",{className:"conv-col",children:"Tasa Conv."})]}),s.map((e,a)=>(0,u.jsxs)("div",{className:"benchmarking-row",children:[(0,u.jsxs)("div",{className:"inst-col",children:[(0,u.jsx)("div",{className:"inst-name",children:e.nombre}),(0,u.jsx)("div",{className:"inst-code",children:e.codigo})]}),(0,u.jsx)("div",{className:"licit-col",children:e.cantidadLicitaciones}),(0,u.jsx)("div",{className:"cont-col",children:e.cantidadContratos}),(0,u.jsx)("div",{className:"monto-col",children:(0,u.jsxs)("div",{className:"monto-value",children:["\u20a1",(e.montoTotal/1e6).toFixed(1),"M"]})}),(0,u.jsx)("div",{className:"tiempo-col",children:(0,u.jsxs)("div",{className:"tiempo-badge ".concat(e.tiempoPromedio<=45?"fast":e.tiempoPromedio<=75?"medium":"slow"),children:[e.tiempoPromedio.toFixed(0)," d\xedas"]})}),(0,u.jsx)("div",{className:"conv-col",children:(0,u.jsxs)("div",{className:"conversion-bar",children:[(0,u.jsx)("div",{className:"conversion-fill",style:{width:"".concat(Math.min(e.tasaConversion,100),"%")}}),(0,u.jsxs)("span",{className:"conversion-text",children:[e.tasaConversion.toFixed(0),"%"]})]})})]},e.codigo))]})]}),(0,u.jsxs)("div",{className:"report-section",children:[(0,u.jsx)("h3",{children:"\ud83d\udcc8 Evoluci\xf3n Temporal"}),(0,u.jsx)("div",{className:"temporal-evolution",children:(0,u.jsx)("div",{className:"evolution-chart",children:r.map((e,a)=>{const t=Math.max(...r.map(e=>e.monto)),i=e.monto/t*100;return(0,u.jsxs)("div",{className:"evolution-bar",children:[(0,u.jsx)("div",{className:"bar-container",children:(0,u.jsx)("div",{className:"bar-fill",style:{height:"".concat(i,"%")},title:"\u20a1".concat((e.monto/1e6).toFixed(1),"M")})}),(0,u.jsxs)("div",{className:"bar-stats",children:[(0,u.jsxs)("div",{className:"bar-monto",children:["\u20a1",(e.monto/1e6).toFixed(1),"M"]}),(0,u.jsxs)("div",{className:"bar-cantidad",children:[e.cantidad," contratos"]})]}),(0,u.jsx)("div",{className:"bar-label",children:e.periodo})]},e.periodo)})})})]}),(0,u.jsxs)("div",{className:"report-section insights",children:[(0,u.jsx)("h3",{children:"\ud83d\udca1 An\xe1lisis de Desempe\xf1o"}),(0,u.jsxs)("div",{className:"insights-grid",children:[(0,u.jsxs)("div",{className:"insight-card ".concat(o("tasaAdjudicacion",t.tasaAdjudicacion)),children:[(0,u.jsx)("div",{className:"insight-icon",children:"\ud83c\udfaf"}),(0,u.jsxs)("div",{className:"insight-content",children:[(0,u.jsx)("div",{className:"insight-title",children:"Eficiencia de Adjudicaci\xf3n"}),(0,u.jsx)("div",{className:"insight-text",children:t.tasaAdjudicacion>=70?"Excelente tasa de adjudicaci\xf3n - Proceso eficiente":t.tasaAdjudicacion>=50?"Tasa de adjudicaci\xf3n aceptable - Margen de mejora":"Tasa de adjudicaci\xf3n baja - Requiere optimizaci\xf3n del proceso"})]})]}),(0,u.jsxs)("div",{className:"insight-card ".concat(o("competenciaPromedio",t.competenciaPromedio)),children:[(0,u.jsx)("div",{className:"insight-icon",children:"\ud83c\udfe2"}),(0,u.jsxs)("div",{className:"insight-content",children:[(0,u.jsx)("div",{className:"insight-title",children:"Nivel de Competencia"}),(0,u.jsx)("div",{className:"insight-text",children:t.competenciaPromedio>=5?"Alta competencia - Mercado saludable y competitivo":t.competenciaPromedio>=3?"Competencia moderada - Oportunidades disponibles":"Baja competencia - Posibles barreras de entrada o nichos especializados"})]})]}),(0,u.jsxs)("div",{className:"insight-card ".concat(o("tiempoPromedio",t.tiempoPromedio)),children:[(0,u.jsx)("div",{className:"insight-icon",children:"\u23f1\ufe0f"}),(0,u.jsxs)("div",{className:"insight-content",children:[(0,u.jsx)("div",{className:"insight-title",children:"Velocidad de Proceso"}),(0,u.jsx)("div",{className:"insight-text",children:t.tiempoPromedio<=30?"Procesos muy \xe1giles - Tiempo de adjudicaci\xf3n \xf3ptimo":t.tiempoPromedio<=60?"Tiempo de proceso aceptable - Dentro de est\xe1ndares":"Procesos lentos - Considerar optimizaci\xf3n de tiempos"})]})]}),(0,u.jsxs)("div",{className:"insight-card ".concat(o("hhi",t.hhi)),children:[(0,u.jsx)("div",{className:"insight-icon",children:"\ud83d\udcca"}),(0,u.jsxs)("div",{className:"insight-content",children:[(0,u.jsx)("div",{className:"insight-title",children:"Concentraci\xf3n de Mercado"}),(0,u.jsx)("div",{className:"insight-text",children:t.hhi<1500?"Mercado desconcentrado - Alta competitividad":t.hhi<2500?"Concentraci\xf3n moderada - Algunos players dominantes":"Alta concentraci\xf3n - Mercado oligop\xf3lico"})]})]})]})]}),(0,u.jsxs)("div",{className:"report-section recommendations",children:[(0,u.jsx)("h3",{children:"\ud83d\udca1 Recomendaciones de Mejora"}),(0,u.jsxs)("ul",{className:"recommendations-list",children:[t.tasaAdjudicacion<50&&(0,u.jsx)("li",{children:"Revisar requisitos de licitaciones para mejorar tasa de adjudicaci\xf3n"}),t.tiempoPromedio>60&&(0,u.jsx)("li",{children:"Implementar mejoras en procesos para reducir tiempo de adjudicaci\xf3n"}),t.competenciaPromedio<3&&(0,u.jsx)("li",{children:"Analizar barreras de entrada que limitan la competencia"}),t.hhi>2500&&(0,u.jsx)("li",{children:"Fomentar participaci\xf3n de nuevos proveedores para desconcentrar mercado"}),(0,u.jsx)("li",{children:"Establecer benchmarks internos basados en instituciones de mejor desempe\xf1o"}),(0,u.jsx)("li",{children:"Implementar sistema de monitoreo continuo de KPIs cr\xedticos"})]})]})]})},ha=()=>{const{estadisticasGenerales:e}=(0,s.M)(),[a,t]=(0,i.useState)("executive"),[o,l]=(0,i.useState)({periodo:{inicio:new Date((new Date).setFullYear((new Date).getFullYear()-1)),fin:new Date},sectores:[],categorias:[],incluirOportunidades:!0}),[c,d]=(0,i.useState)("pdf"),p=(0,i.useMemo)(()=>{try{return na.S.generarReporteEjecutivo({periodo:o.periodo,sectores:o.sectores.length>0?o.sectores:void 0,incluirOportunidades:o.incluirOportunidades})}catch(e){return console.error("Error generando reporte ejecutivo:",e),null}},[o]),h=(0,i.useMemo)(()=>{try{return n.M.getManualCategoryNames()}catch(e){return console.error("Error obteniendo categor\xedas manuales:",e),[]}},[]);return(0,u.jsxs)("div",{className:"reports-panel",children:[(0,u.jsxs)("div",{className:"reports-header",children:[(0,u.jsxs)("div",{className:"reports-title",children:[(0,u.jsx)("h1",{children:"\ud83d\udccb Generaci\xf3n de Reportes Ejecutivos"}),(0,u.jsx)("p",{children:"An\xe1lisis avanzado y reportes personalizados"})]}),(0,u.jsxs)("div",{className:"reports-actions",children:[(0,u.jsxs)("select",{className:"export-format-select",value:c,onChange:e=>d(e.target.value),children:[(0,u.jsx)("option",{value:"pdf",children:"\ud83d\udcc4 PDF"}),(0,u.jsx)("option",{value:"excel",children:"\ud83d\udcca Excel"}),(0,u.jsx)("option",{value:"json",children:"\ud83d\udccb JSON"})]}),(0,u.jsx)("button",{className:"export-button",onClick:()=>{alert("Exportando reporte en formato ".concat(c.toUpperCase(),"..."))},children:"\ud83d\udcbe Exportar Reporte"})]})]}),(0,u.jsxs)("div",{className:"reports-filters",children:[(0,u.jsxs)("div",{className:"filter-group",children:[(0,u.jsx)("label",{children:"\ud83d\udcc5 Per\xedodo:"}),(0,u.jsx)("input",{type:"date",value:o.periodo.inicio.toISOString().split("T")[0],onChange:e=>l(a=>(0,r.A)((0,r.A)({},a),{},{periodo:(0,r.A)((0,r.A)({},a.periodo),{},{inicio:new Date(e.target.value)})}))}),(0,u.jsx)("span",{children:"a"}),(0,u.jsx)("input",{type:"date",value:o.periodo.fin.toISOString().split("T")[0],onChange:e=>l(a=>(0,r.A)((0,r.A)({},a),{},{periodo:(0,r.A)((0,r.A)({},a.periodo),{},{fin:new Date(e.target.value)})}))})]}),(0,u.jsxs)("div",{className:"filter-group",children:[(0,u.jsx)("label",{children:"\ud83c\udfed Sectores:"}),(0,u.jsx)("div",{className:"sectors-filter",children:["medicamentos","salud","educaci\xf3n","tecnolog\xeda","construcci\xf3n","transporte","seguridad","alimentos","servicios","consultor\xeda"].map(e=>(0,u.jsx)("button",{className:"sector-tag ".concat(o.sectores.includes(e)?"active":""),onClick:()=>(e=>{l(a=>(0,r.A)((0,r.A)({},a),{},{sectores:a.sectores.includes(e)?a.sectores.filter(a=>a!==e):[...a.sectores,e]}))})(e),children:e},e))})]}),h.length>0&&(0,u.jsxs)("div",{className:"filter-group",children:[(0,u.jsx)("label",{children:"\ud83c\udff7\ufe0f Categor\xedas Personalizadas:"}),(0,u.jsx)("div",{className:"sectors-filter",children:h.map(e=>(0,u.jsx)("button",{className:"sector-tag ".concat(o.categorias.includes(e)?"active":""),onClick:()=>(e=>{l(a=>(0,r.A)((0,r.A)({},a),{},{categorias:a.categorias.includes(e)?a.categorias.filter(a=>a!==e):[...a.categorias,e]}))})(e),children:e},e))}),o.categorias.length>0&&(0,u.jsxs)("div",{className:"filter-info",children:["\u2139\ufe0f Filtrando por ",o.categorias.length," categor\xeda",o.categorias.length>1?"s":""]})]})]}),(0,u.jsx)("div",{className:"reports-menu",children:[{id:"executive",icon:"\ud83d\udcca",titulo:"Resumen Ejecutivo",descripcion:"Vista general del mercado"},{id:"sector",icon:"\ud83c\udfed",titulo:"An\xe1lisis por Sector",descripcion:"Desglose detallado por industria"},{id:"competence",icon:"\ud83c\udfe2",titulo:"Competencia",descripcion:"Ranking y cuota de mercado"},{id:"prices",icon:"\ud83d\udcb0",titulo:"Tendencias de Precios",descripcion:"Hist\xf3rico y proyecciones"},{id:"opportunities",icon:"\ud83c\udfaf",titulo:"Oportunidades",descripcion:"Nichos y mercados emergentes"},{id:"performance",icon:"\ud83d\udcc8",titulo:"M\xe9tricas de Desempe\xf1o",descripcion:"KPIs y benchmarking"}].map(e=>(0,u.jsxs)("button",{className:"report-menu-item ".concat(a===e.id?"active":""),onClick:()=>t(e.id),children:[(0,u.jsx)("div",{className:"menu-item-icon",children:e.icon}),(0,u.jsxs)("div",{className:"menu-item-content",children:[(0,u.jsx)("div",{className:"menu-item-title",children:e.titulo}),(0,u.jsx)("div",{className:"menu-item-description",children:e.descripcion})]})]},e.id))}),(0,u.jsxs)("div",{className:"reports-content",children:["executive"===a&&(()=>{if(!p)return(0,u.jsx)("div",{className:"report-error",children:"Error al generar el reporte ejecutivo"});const{resumenGeneral:e,tendenciasMercado:a,analisisCompetencia:t}=p;return(0,u.jsxs)("div",{className:"executive-report",children:[(0,u.jsx)("h2",{className:"report-title",children:"\ud83d\udcca Resumen Ejecutivo"}),(0,u.jsxs)("div",{className:"metrics-grid",children:[(0,u.jsxs)("div",{className:"metric-card primary",children:[(0,u.jsx)("div",{className:"metric-icon",children:"\ud83d\udccb"}),(0,u.jsxs)("div",{className:"metric-content",children:[(0,u.jsx)("div",{className:"metric-value",children:e.totalLicitaciones.toLocaleString()}),(0,u.jsx)("div",{className:"metric-label",children:"Licitaciones"})]})]}),(0,u.jsxs)("div",{className:"metric-card success",children:[(0,u.jsx)("div",{className:"metric-icon",children:"\ud83d\udcdd"}),(0,u.jsxs)("div",{className:"metric-content",children:[(0,u.jsx)("div",{className:"metric-value",children:e.totalContratos.toLocaleString()}),(0,u.jsx)("div",{className:"metric-label",children:"Contratos"})]})]}),(0,u.jsxs)("div",{className:"metric-card warning",children:[(0,u.jsx)("div",{className:"metric-icon",children:"\ud83d\udcb0"}),(0,u.jsxs)("div",{className:"metric-content",children:[(0,u.jsxs)("div",{className:"metric-value",children:["\u20a1",(e.montoTotalAdjudicado/1e6).toFixed(1),"M"]}),(0,u.jsx)("div",{className:"metric-label",children:"Monto Total"})]})]}),(0,u.jsxs)("div",{className:"metric-card info",children:[(0,u.jsx)("div",{className:"metric-icon",children:"\ud83d\udcc8"}),(0,u.jsxs)("div",{className:"metric-content",children:[(0,u.jsxs)("div",{className:"metric-value",children:[e.crecimientoAnual>0?"+":"",Math.min(Math.max(e.crecimientoAnual,-999),999).toFixed(1),"%"]}),(0,u.jsx)("div",{className:"metric-label",children:"Crecimiento Anual"})]})]})]}),(0,u.jsxs)("div",{className:"report-section",children:[(0,u.jsx)("h3",{children:"\ud83c\udfdb\ufe0f Instituciones M\xe1s Activas"}),(0,u.jsx)("div",{className:"institutions-list",children:e.institucionesMasActivas.slice(0,5).map((e,a)=>(0,u.jsxs)("div",{className:"institution-item",children:[(0,u.jsxs)("div",{className:"institution-rank",children:["#",a+1]}),(0,u.jsxs)("div",{className:"institution-info",children:[(0,u.jsx)("div",{className:"institution-name",children:e.nombre}),(0,u.jsxs)("div",{className:"institution-stats",children:[e.cantidad," licitaciones \u2022 \u20a1",(e.monto/1e6).toFixed(1),"M"]})]})]},a))})]}),(0,u.jsxs)("div",{className:"report-section",children:[(0,u.jsx)("h3",{children:"\ud83c\udfed Sectores Principales"}),(0,u.jsx)("div",{className:"sectors-chart",children:e.sectoresPrincipales.map((e,a)=>(0,u.jsxs)("div",{className:"sector-bar",children:[(0,u.jsx)("div",{className:"sector-label",children:e.sector}),(0,u.jsxs)("div",{className:"sector-progress",children:[(0,u.jsx)("div",{className:"sector-fill",style:{width:"".concat(e.participacion,"%")}}),(0,u.jsxs)("span",{className:"sector-percentage",children:[e.participacion.toFixed(1),"%"]})]})]},a))})]}),(0,u.jsxs)("div",{className:"report-section",children:[(0,u.jsx)("h3",{children:"\ud83d\udcca Indicadores del Mercado"}),(0,u.jsxs)("div",{className:"market-indicators",children:[(0,u.jsxs)("div",{className:"indicator",children:[(0,u.jsx)("div",{className:"indicator-icon",children:"\ud83c\udfaf"}),(0,u.jsx)("div",{className:"indicator-label",children:"Competencia Promedio"}),(0,u.jsxs)("div",{className:"indicator-value",children:[a.competenciaPromedio.toFixed(1)," ofertas/l\xednea"]})]}),(0,u.jsxs)("div",{className:"indicator",children:[(0,u.jsx)("div",{className:"indicator-icon",children:"\u23f1\ufe0f"}),(0,u.jsx)("div",{className:"indicator-label",children:"Tiempo Promedio"}),(0,u.jsxs)("div",{className:"indicator-value",children:[a.tiempoPromedioProceso.toFixed(0)," d\xedas"]})]}),(0,u.jsxs)("div",{className:"indicator",children:[(0,u.jsx)("div",{className:"indicator-icon",children:"\ud83c\udfc6"}),(0,u.jsx)("div",{className:"indicator-label",children:"Concentraci\xf3n Top 5"}),(0,u.jsxs)("div",{className:"indicator-value",children:[t.concentracionMercado.toFixed(1),"%"]})]})]})]}),p.recomendaciones.length>0&&(0,u.jsxs)("div",{className:"report-section recommendations",children:[(0,u.jsx)("h3",{children:"\ud83d\udca1 Recomendaciones Estrat\xe9gicas"}),(0,u.jsx)("ul",{className:"recommendations-list",children:p.recomendaciones.map((e,a)=>(0,u.jsx)("li",{children:e},a))})]})]})})(),"sector"===a&&(0,u.jsx)(oa,{filters:o}),"competence"===a&&(0,u.jsx)(la,{filters:o}),"prices"===a&&(0,u.jsx)(ca,{filters:o}),"opportunities"===a&&(0,u.jsx)(da,{filters:o}),"performance"===a&&(0,u.jsx)(pa,{filters:o})]})]})},ma=e=>{var a,t;let{onGoBackToWelcome:r}=e;const{estadisticasGenerales:n,error:o}=(0,s.M)(),[l,c]=(0,i.useState)("dashboard");return(0,u.jsxs)("div",{className:"demo-panel-container",children:[(0,u.jsxs)("div",{className:"modern-header",children:[(0,u.jsxs)("div",{className:"header-background",children:[(0,u.jsx)("div",{className:"header-pattern"}),(0,u.jsx)("div",{className:"header-orb header-orb-1"}),(0,u.jsx)("div",{className:"header-orb header-orb-2"})]}),(0,u.jsxs)("div",{className:"header-content",children:[(0,u.jsxs)("div",{className:"header-logo-section",children:[(0,u.jsx)("img",{src:"".concat("https://jeyrellt.github.io/SicoApp","/logo-hq-analytics.png"),alt:"HQ Analytics Logo",className:"header-logo"}),(0,u.jsxs)("div",{className:"header-company-info",children:[(0,u.jsx)("div",{className:"company-name",children:"Saenz Fallas S.A."}),(0,u.jsx)("div",{className:"company-tagline",children:"HQ Analytics\u2122 - High Technology Quality Analytics"})]})]}),(0,u.jsxs)("h1",{className:"header-title",children:[(0,u.jsx)("span",{className:"header-icon",children:"\ud83c\udfdb\ufe0f"}),(0,u.jsx)("span",{className:"header-title-text",children:"SICOP Analytics - Sistema de An\xe1lisis"})]}),(0,u.jsxs)("p",{className:"header-subtitle",children:[(0,u.jsx)("span",{children:"An\xe1lisis Inteligente de Licitaciones P\xfablicas de Costa Rica"}),(0,u.jsxs)("span",{className:"stat-badge",children:["\ud83d\udccb ",(0,u.jsx)("span",{className:"stat-number",children:null===(a=n.carteles)||void 0===a?void 0:a.toLocaleString()})," Carteles"]}),(0,u.jsxs)("span",{className:"stat-badge",children:["\ud83d\udcc4 ",(0,u.jsx)("span",{className:"stat-number",children:null===(t=n.contratos)||void 0===t?void 0:t.toLocaleString()})," Contratos"]})]}),r&&(0,u.jsxs)("button",{className:"back-to-welcome-button",onClick:r,title:"Volver al Men\xfa Principal",children:[(0,u.jsx)("span",{className:"back-icon",children:"\ud83c\udfe0"}),(0,u.jsx)("span",{className:"back-text",children:"Men\xfa Principal"})]})]})]}),o&&(0,u.jsxs)("div",{className:"error-banner",children:[(0,u.jsx)("span",{className:"error-icon",children:"\u26a0\ufe0f"}),(0,u.jsx)("span",{children:o})]}),(0,u.jsx)("div",{className:"modern-tabs-container",children:(0,u.jsxs)("div",{className:"modern-tabs",children:[(0,u.jsx)("button",{className:"tab-button ".concat("dashboard"===l?"active":""),onClick:()=>c("dashboard"),children:(0,u.jsxs)("div",{className:"tab-button-content",children:[(0,u.jsx)("span",{className:"tab-icon",children:"\ud83d\udcca"}),(0,u.jsx)("span",{children:"Dashboard"})]})}),(0,u.jsx)("button",{className:"tab-button ".concat("instituciones"===l?"active":""),onClick:()=>c("instituciones"),children:(0,u.jsxs)("div",{className:"tab-button-content",children:[(0,u.jsx)("span",{className:"tab-icon",children:"\ud83c\udfe2"}),(0,u.jsx)("span",{children:"Instituciones"})]})}),(0,u.jsx)("button",{className:"tab-button ".concat("analysis"===l?"active":""),onClick:()=>c("analysis"),children:(0,u.jsxs)("div",{className:"tab-button-content",children:[(0,u.jsx)("span",{className:"tab-icon",children:"\ud83d\udd0d"}),(0,u.jsx)("span",{children:"SICOP"})]})}),(0,u.jsx)("button",{className:"tab-button ".concat("categorias"===l?"active":""),onClick:()=>c("categorias"),children:(0,u.jsxs)("div",{className:"tab-button-content",children:[(0,u.jsx)("span",{className:"tab-icon",children:"\ud83c\udff7\ufe0f"}),(0,u.jsx)("span",{children:"Categor\xedas"})]})}),(0,u.jsx)("button",{className:"tab-button ".concat("reports"===l?"active":""),onClick:()=>c("reports"),children:(0,u.jsxs)("div",{className:"tab-button-content",children:[(0,u.jsx)("span",{className:"tab-icon",children:"\ud83d\udccb"}),(0,u.jsx)("span",{children:"Reportes"})]})})]})}),(0,u.jsxs)("div",{className:"tab-content",children:["dashboard"===l&&(0,u.jsx)(le,{}),"instituciones"===l&&(0,u.jsxs)("div",{children:[(0,u.jsx)("h2",{children:"\ud83c\udfe2 Dashboard por Instituci\xf3n"}),(0,u.jsx)(Re,{})]}),"analysis"===l&&(0,u.jsxs)("div",{children:[(0,u.jsx)("h2",{children:"\ud83d\udd0d B\xfasqueda Espec\xedfica por SICOP"}),(0,u.jsx)(Ie,{})]}),"categorias"===l&&(0,u.jsx)(ra,{}),"reports"===l&&(0,u.jsx)(ha,{})]}),(0,u.jsx)("footer",{className:"app-footer",children:(0,u.jsxs)("div",{className:"footer-content",children:[(0,u.jsxs)("div",{className:"footer-logo-section",children:[(0,u.jsx)("img",{src:"".concat("https://jeyrellt.github.io/SicoApp","/logo-hq-analytics.png"),alt:"HQ Analytics Logo",className:"footer-logo"}),(0,u.jsxs)("div",{className:"footer-company",children:[(0,u.jsx)("strong",{children:"Saenz Fallas S.A."}),(0,u.jsx)("span",{children:"HQ Analytics\u2122"})]})]}),(0,u.jsxs)("div",{className:"footer-info",children:[(0,u.jsx)("p",{className:"copyright",children:"\xa9 2025 Saenz Fallas S.A. - Todos los derechos reservados"}),(0,u.jsx)("p",{className:"footer-tagline",children:"High Technology Quality Analytics - Innovaci\xf3n en An\xe1lisis de Datos"})]}),(0,u.jsxs)("div",{className:"footer-links",children:[(0,u.jsx)("span",{className:"footer-version",children:"v1.0.0"}),(0,u.jsx)("span",{className:"footer-separator",children:"\u2022"}),(0,u.jsx)("span",{children:"SICOP Analytics"})]})]})})]})},xa=ma},6615:(e,a,t)=>{t.d(a,{M:()=>g});var i=t(1397),s=t.n(i),r=t(7939),n=t(9031);const o="sicop.manualCategories.v1",l="sicop.categoryGroups.v1",c="sicop.categoryConfiguration.v1",d="sicop.subcategoryConfiguration.v1",p="manual_categories",h="category_groups",m="category_configuration",x="subcategory_configuration";const g=new class{async persistRulesToCache(e){try{await n.q.setCustomData(p,e),console.log("\u2705 Categor\xedas manuales guardadas en cache")}catch(a){console.error("\u274c Error guardando categor\xedas en cache:",a)}}async persistGroupsToCache(e){try{await n.q.setCustomData(h,e),console.log("\u2705 Grupos de categor\xedas guardados en cache")}catch(a){console.error("\u274c Error guardando grupos en cache:",a)}}async persistConfigToCache(e){try{await n.q.setCustomData(m,e),console.log("\u2705 Configuraci\xf3n de categor\xedas guardada en cache")}catch(a){console.error("\u274c Error guardando configuraci\xf3n en cache:",a)}}async loadRulesFromCache(){try{const e=await n.q.getCustomData(p);if(e&&Array.isArray(e))return console.log("\u2705 Categor\xedas cargadas desde cache"),e}catch(e){console.warn("\u26a0\ufe0f Error cargando desde cache, usando localStorage:",e)}return this.loadRulesFromLocalStorage()}async loadGroupsFromCache(){try{const e=await n.q.getCustomData(h);if(e&&Array.isArray(e))return console.log("\u2705 Grupos cargados desde cache"),e}catch(e){console.warn("\u26a0\ufe0f Error cargando grupos desde cache, usando localStorage:",e)}return this.loadGroupsFromLocalStorage()}async loadConfigFromCache(){try{const e=await n.q.getCustomData(m);if(e)return console.log("\u2705 Configuraci\xf3n cargada desde cache"),e}catch(e){console.warn("\u26a0\ufe0f Error cargando configuraci\xf3n desde cache, usando localStorage:",e)}return this.loadConfigFromLocalStorage()}loadRulesFromLocalStorage(){try{const e=localStorage.getItem(o);if(!e)return[];const a=JSON.parse(e);return Array.isArray(a)?a:[]}catch(e){return[]}}loadGroupsFromLocalStorage(){try{const e=localStorage.getItem(l);if(!e)return[];const a=JSON.parse(e);return Array.isArray(a)?a:[]}catch(e){return[]}}loadConfigFromLocalStorage(){try{const e=localStorage.getItem(c);if(!e)return null;return JSON.parse(e)}catch(e){return null}}getAllRules(){return this.loadRulesFromLocalStorage()}async getAllRulesAsync(){return await this.loadRulesFromCache()}saveRules(e){localStorage.setItem(o,JSON.stringify(e)),this.persistRulesToCache(e),this.notifyDataManagerUpdate()}notifyDataManagerUpdate(){"undefined"!==typeof window&&window.dispatchEvent(new CustomEvent("manualCategoriesUpdated"))}upsertRule(e){const a=this.getAllRules(),t=a.findIndex(a=>a.id===e.id);t>=0?a[t]=e:a.push(e),this.saveRules(a)}deleteRule(e){const a=this.getAllRules().filter(a=>a.id!==e);this.saveRules(a)}getAllGroups(){return this.loadGroupsFromLocalStorage()}async getAllGroupsAsync(){return await this.loadGroupsFromCache()}saveGroups(e){localStorage.setItem(l,JSON.stringify(e)),this.persistGroupsToCache(e)}upsertGroup(e){const a=this.getAllGroups(),t=a.findIndex(a=>a.id===e.id);t>=0?a[t]=e:a.push(e),this.saveGroups(a)}deleteGroup(e){const a=this.getAllGroups().filter(a=>a.id!==e);this.saveGroups(a)}sugerirDesdeKeywords(e){const a=(e.palabras||[]).map(e=>e.trim().toLowerCase()).filter(Boolean);if(!a.length)return[];const t=r.M.obtenerDatos("DetalleCarteles")||[],i=r.M.obtenerDatos("DetalleLineaCartel")||[],n=e.instituciones&&e.instituciones.length?new Set(e.instituciones):null,o=s().groupBy(i,"numeroCartel"),l=e=>{const t=(e||"").toLowerCase(),i=a.filter(e=>t.includes(e));return{score:i.length/a.length,hits:i}},c=[];for(const s of t){if(n&&!n.has(s.codigoInstitucion))continue;const e="".concat(s.nombreCartel||""," ").concat(s.descripcionCartel||"");let{score:a,hits:t}=l(e);const i=o[s.numeroCartel]||[];for(const s of i){const e=l(s.descripcionLinea||"");e.score>a&&(a=e.score,t=e.hits)}a>0&&c.push({numeroCartel:s.numeroCartel,texto:e.trim(),score:a,coincidencias:t})}return s().orderBy(c,"score","desc").slice(0,e.limit||100)}async getCategoryConfiguration(){const e=await this.loadConfigFromCache();return e||{version:"1.0",categorias:{},lastModified:(new Date).toISOString()}}saveCategoryConfiguration(e){e.lastModified=(new Date).toISOString(),localStorage.setItem(c,JSON.stringify(e)),this.persistConfigToCache(e),"undefined"!==typeof window&&window.dispatchEvent(new CustomEvent("categoryConfigurationUpdated")),this.notifyDataManagerUpdate()}async toggleCategory(e,a){const t=await this.getCategoryConfiguration();t.categorias[e]=a,this.saveCategoryConfiguration(t)}async isCategoryActive(e){return!1!==(await this.getCategoryConfiguration()).categorias[e]}async getAllCategoriesWithConfig(){var e;const a=await this.getCategoryConfiguration(),t=await this.getAllRulesAsync(),i=(null===(e=r.M.getSystemCategoryNames)||void 0===e?void 0:e.call(r.M))||[],s=[];for(const r of i){const e=r;s.push({id:e,nombre:r,tipo:"sistema",activa:!1!==a.categorias[e]})}for(const r of t)s.push({id:r.id,nombre:r.nombre,tipo:"manual",activa:!1!==a.categorias[r.id],palabrasClave:r.palabrasClave,descripcion:r.descripcion,color:r.color});return s}async activateAllCategories(){const e=await this.getCategoryConfiguration();e.categorias={},this.saveCategoryConfiguration(e)}async deactivateAllCategories(){const e=await this.getAllCategoriesWithConfig(),a=await this.getCategoryConfiguration();for(const t of e)a.categorias[t.id]=!1;this.saveCategoryConfiguration(a)}async getSubcategoryConfiguration(){try{const e=await n.q.getCustomData(x);if(e)return e}catch(e){console.warn("\u26a0\ufe0f Error cargando subcategor\xedas desde cache:",e)}try{const e=localStorage.getItem(d);return e?JSON.parse(e):{version:"1.0",overrides:{},lastModified:(new Date).toISOString()}}catch(a){return{version:"1.0",overrides:{},lastModified:(new Date).toISOString()}}}saveSubcategoryConfiguration(e){e.lastModified=(new Date).toISOString(),localStorage.setItem(d,JSON.stringify(e)),n.q.setCustomData(x,e),"undefined"!==typeof window&&window.dispatchEvent(new CustomEvent("subcategoryConfigurationUpdated")),this.notifyDataManagerUpdate()}async updateSubcategories(e,a){const t=await this.getSubcategoryConfiguration();t.overrides[e]=a,this.saveSubcategoryConfiguration(t)}async getSubcategoriesForCategory(e){return(await this.getSubcategoryConfiguration()).overrides[e]||[]}}}}]);