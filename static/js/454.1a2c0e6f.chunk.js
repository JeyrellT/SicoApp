/*! For license information please see 454.1a2c0e6f.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunksicop_app=self.webpackChunksicop_app||[]).push([[454],{2454:(e,n,a)=>{a.r(n),a.d(n,{DataManagementHub:()=>oe,default:()=>re});var t=a(9950),s=a(9379),i=a(847),o=a.n(i),r=a(7834),l=a(6230);const c=(0,l.A)("file",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);var d=a(6479),p=a(2828),m=a(5833),h=a(9031),g=a(991);const u=[{type:"InstitucionesRegistradas",requiredFields:["CEDULA","NOMBRE_INSTITUCION"],optionalFields:["ZONA_GEO_INST","FECHA_INGRESO","FECHA_MOD"],description:"Cat\xe1logo de instituciones p\xfablicas registradas en SICOP"},{type:"Proveedores_unido",requiredFields:["C\xe9dula Proveedor","Nombre Proveedor"],optionalFields:["Tipo Proveedor","Tama\xf1o Proveedor","Codigo Postal","Provincia","Canton","Distrito"],description:"Cat\xe1logo unificado de proveedores (separador: punto y coma)"},{type:"ProcedimientoAdjudicacion",requiredFields:["CEDULA","INSTITUCION","NUMERO_PROCEDIMIENTO"],optionalFields:["ANO","DESCR_PROCEDIMIENTO","LINEA","PROD_ID","DESCR_BIEN_SERVICIO","CANTIDAD","UNIDAD_MEDIDA","MONTO_UNITARIO","MONEDA_PRECIO_EST","MONEDA_ADJUDICADA","MONTO_ADJU_LINEA","MONTO_ADJU_LINEA_CRC","MONTO_ADJU_LINEA_USD","FECHA_ADJUD_FIRME","FECHA_SOL_CONTRA","CEDULA_PROVEEDOR","NOMBRE_PROVEEDOR","PERFIL_PROV","CEDULA_REPRESENTANTE","REPRESENTANTE","OBJETO_GASTO","NRO_SICOP","TIPO_PROCEDIMIENTO","MODALIDAD_PROCEDIMIENTO","fecha_rev","FECHA_SOL_CONTRA_CL","PROD_ID_CL"],description:"Procedimientos de adjudicaci\xf3n y licitaciones (~3,885 registros)"},{type:"ProcedimientoADM",requiredFields:["NRO_SICOP","NUMERO_PROCEDIMIENTO","NUMERO_PA"],optionalFields:["NOMBRE_PROVEEDOR","NOMBRE_INSTITUCION","CEDULA_INSTITUCION","CEDULA_PROVEEDOR","FECHA_NOTIFICACION","INHAB_APERC","MULTA_CAUSULA"],description:"Procedimientos administrativos (~5 registros)"},{type:"Sistemas",requiredFields:["NRO_SICOP","NUMERO_LINEA","NUMERO_PARTIDA"],optionalFields:["DESC_LINEA","CEDULA_INSTITUCION","NRO_PROCEDIMIENTO","TIPO_PROCEDIMIENTO","FECHA_PUBLICACION"],description:"Sistemas asociados a carteles y l\xedneas (~8,664 registros)"},{type:"SistemaEvaluacionOfertas",requiredFields:["NRO_SICOP"],optionalFields:["EVAL_ITEM_SEQNO","FACTOR_EVAL","PORC_EVAL","fecha_registro"],description:"Metodolog\xedas de evaluaci\xf3n de ofertas (~4,965 registros)"},{type:"DetalleCarteles",requiredFields:["NRO_SICOP","CEDULA_INSTITUCION","NRO_PROCEDIMIENTO"],optionalFields:["FECHA_PUBLICACION","TIPO_PROCEDIMIENTO","MODALIDAD_PROCEDIMIENTO","CARTEL_STAT","CARTEL_NM","FECHAH_APERTURA","CODIGO_BPIP","CLAS_OBJ","COD_EXCEPCION","DES_EXCEPCION","MONTO_EST","FECHA_MOD"],description:"Detalle de carteles de licitaci\xf3n (~1,555 registros)"},{type:"DetalleLineaCartel",requiredFields:["NRO_SICOP","NUMERO_LINEA","NUMERO_PARTIDA"],optionalFields:["CANTIDAD_SOLICITADA","PRECIO_UNITARIO_ESTIMADO","TIPO_MONEDA","TIPO_CAMBIO_CRC","TIPO_CAMBIO_DOLAR","CODIGO_IDENTIFICACION","MONTO_RESERVADO","DESC_LINEA"],description:"L\xedneas de detalle de carteles (~8,664 registros)"},{type:"FechaPorEtapas",requiredFields:["NRO_SICOP","NUMERO_PROCEDIMIENTO"],optionalFields:["FECHA_PUBLICACION","FECHA_APERTURA_OFERTAS","FECHA_ADJUDICACION","FECHA_FIRMA_CONTRATO"],description:"Cronograma de etapas de procedimientos (~8,664 registros)"},{type:"Ofertas",requiredFields:["NRO_SICOP","NUMERO_OFERTA","CEDULA_PROVEEDOR"],optionalFields:["NRO_PROCEDIMIENTO","CEDULA_INSTITUCION","FECHA_OFERTA","TIPO_MONEDA","CONSORCIO","DESC_CONSORCIO","fecha_registro"],description:"Ofertas presentadas por proveedores (~11,609 registros)"},{type:"LineasOfertadas",requiredFields:["NRO_SICOP","NUMERO_LINEA","NUMERO_OFERTA"],optionalFields:["CEDULA_PROVEEDOR","CANTIDAD_OFERTADA","PRECIO_UNITARIO","TIPO_MONEDA","CODIGO_PRODUCTO","MARCA","TIPO_CAMBIO_CRC","TIPO_CAMBIO_DOLAR","FECHA_FABRICACION","fecha_registro"],description:"L\xedneas ofertadas en cada propuesta (~13,576 registros)"},{type:"LineasRecibidas",requiredFields:["NRO_SICOP","NUMERO_LINEA"],optionalFields:["CODIGO_PRODUCTO","CANTIDAD_RECIBIDA","PRECIO_UNITARIO","TIPO_MONEDA","TIPO_CAMBIO_CRC","TIPO_CAMBIO_DOLAR","fecha_registro"],description:"L\xedneas recibidas en apertura de ofertas (~2,939 registros)"},{type:"InvitacionProcedimiento",requiredFields:["NRO_SICOP","CEDULA_PROVEEDOR"],optionalFields:["FECHA_INVITACION","fecha_registro"],description:"Proveedores invitados a procedimientos (~736,295 registros)"},{type:"LineasAdjudicadas",requiredFields:["NRO_SICOP","NUMERO_LINEA","CEDULA_PROVEEDOR"],optionalFields:["NUMERO_OFERTA","CODIGO_PRODUCTO","NUMERO_ACTO","CANTIDAD_ADJUDICADA","PRECIO_UNITARIO_ADJUDICADO","TIPO_MONEDA","TIPO_CAMBIO_CRC","TIPO_CAMBIO_DOLAR","DESC_PRODUCTO","fecha_registro"],description:"L\xedneas adjudicadas a proveedores ganadores (~4,611 registros)"},{type:"AdjudicacionesFirme",requiredFields:["NRO_SICOP","FECHA_ADJUDICACION_FIRME"],optionalFields:["NUMERO_ACTO","PERMITE_RECURSOS","DESIERTO","fecha_registro"],description:"Adjudicaciones en firme y definitivas (~3,899 registros)"},{type:"Contratos",requiredFields:["NRO_CONTRATO","CEDULA_INSTITUCION","CEDULA_PROVEEDOR"],optionalFields:["SECUENCIA","NUMERO_PROCEDIMIENTO","NRO_SICOP","TIPO_CONTRATO","TIPO_MODIFICACION","FECHA_NOTIFICACION","FECHA_ELABORACION","TIPO_AUTORIZACION","TIPO_DISMINUCION","VIGENCIA","MONEDA","FECHA_INI_SUSP","FECHA_REINI_CONT","PLAZO_SUSP","FECHA_MODIFICACION","FECHA_INI_PRORR","FECHA_FIN_PRORR","NRO_CONTRATO_WEB"],description:"Contratos formalizados y firmados (~2,420 registros)"},{type:"LineasContratadas",requiredFields:["NRO_SICOP","NRO_CONTRATO","NRO_LINEA_CONTRATO"],optionalFields:["NRO_LINEA_CARTEL","SECUENCIA","CEDULA_PROVEEDOR","CODIGO_PRODUCTO","CANTIDAD_CONTRATADA","PRECIO_UNITARIO","TIPO_MONEDA","DESCUENTO","IVA","OTROS_IMPUESTOS","ACARREOS","TIPO_CAMBIO_CRC","TIPO_CAMBIO_DOLAR","NRO_ACTO","DESC_PRODUCTO","cantidad_aumentada","cantidad_disminuida","monto_aumentado","monto_disminuido"],description:"Detalle de l\xedneas contratadas (~3,926 registros)"},{type:"OrdenPedido",requiredFields:["NRO_SICOP","NRO_ORDEN_PEDIDO","NRO_CONTRATO"],optionalFields:["NUMERO_PROCEDIMIENTO","FECHA_ORDEN","MONTO_ORDEN","MONEDA_ORDEN","ESTADO_ORDEN","LINEA_ORD_PEDIDO","TIPO_CAMBIO_CRC","TIPO_CAMBIO_DOLAR","fecha_registro"],description:"\xd3rdenes de compra emitidas (~23,533 registros)"},{type:"Recepciones",requiredFields:["NRO_SICOP","NRO_CONTRATO","NRO_RECEPCION"],optionalFields:["NRO_ORDEN_PEDIDO","FECHA_RECEPCION","CANTIDAD_RECIBIDA","CODIGO_PRODUCTO","NUMERO_LINEA","MONTO_RECEPCION","fecha_registro"],description:"Recepci\xf3n de bienes y servicios (~1,394 registros)"},{type:"ReajustePrecios",requiredFields:["NRO_CONTRATO","NUMERO_REAJUSTE"],optionalFields:["FECHA_REAJUSTE","PORCENTAJE","MONTO","fecha_registro"],description:"Reajustes de precios en contratos (~3 registros)"},{type:"Garantias",requiredFields:["CEDULA_PROVEEDOR","TIPO_GARANTIA"],optionalFields:["NRO_CONTRATO","NRO_SICOP","MONTO","FECHA_INICIO","FECHA_VENCIMIENTO","NUMERO_POLIZA","ENTIDAD_EMISORA","fecha_registro"],description:"Garant\xedas de cumplimiento y participaci\xf3n (~1,077 registros)"},{type:"RecursosObjecion",requiredFields:["NRO_SICOP","NUMERO_RECURSO"],optionalFields:["CEDULA_PROVEEDOR","FECHA_PRESENTACION","MOTIVO_RECURSO","DETALLE_RESULTADO","ESTADO_RECURSO","fecha_registro"],description:"Recursos de objeci\xf3n presentados (~261 registros)"},{type:"FuncionariosInhibicion",requiredFields:["CEDULA_INSTITUCION","CEDULA_FUNCIONARIO"],optionalFields:["NOMBRE_FUNCIONARIO","FECHA_INICIO","FECHA_FIN","fecha_registro"],description:"Inhibiciones de funcionarios p\xfablicos (~86,340 registros)"},{type:"SancionProveedores",requiredFields:["CEDULA_PROVEEDOR","NOMBRE_PROVEEDOR"],optionalFields:["NOMBRE_INSTITUCION","CEDULA_INSTITUCION","CODIGO_PRODUCTO","DESCRIP_PRODUCTO","TIPO_SANCION","DESCR_SANCION","INICIO_SANCION","FINAL_SANCION","ESTADO","NO_RESOLUCION","fecha_registro"],description:"Sanciones aplicadas a proveedores (~7 registros)"},{type:"Remates",requiredFields:["NUMERO_REMATE"],optionalFields:["DESCRIPCION","FECHA_REMATE","CEDULA_INSTITUCION","fecha_registro"],description:"Remates de bienes del Estado (~0 registros)"}],x={InstitucionesRegistradas:"Cat\xe1logos base",Proveedores_unido:"Cat\xe1logos base",ProcedimientoAdjudicacion:"Procesos y carteles",ProcedimientoADM:"Procesos y carteles",DetalleCarteles:"Procesos y carteles",DetalleLineaCartel:"Procesos y carteles",FechaPorEtapas:"Procesos y carteles",InvitacionProcedimiento:"Procesos y carteles",Sistemas:"Procesos y carteles",SistemaEvaluacionOfertas:"Procesos y carteles",Ofertas:"Ofertas y adjudicaciones",LineasOfertadas:"Ofertas y adjudicaciones",LineasRecibidas:"Ofertas y adjudicaciones",LineasAdjudicadas:"Ofertas y adjudicaciones",AdjudicacionesFirme:"Ofertas y adjudicaciones",Contratos:"Contrataci\xf3n y ejecuci\xf3n",LineasContratadas:"Contrataci\xf3n y ejecuci\xf3n",OrdenPedido:"Contrataci\xf3n y ejecuci\xf3n",Recepciones:"Contrataci\xf3n y ejecuci\xf3n",ReajustePrecios:"Contrataci\xf3n y ejecuci\xf3n",Garantias:"Contrataci\xf3n y ejecuci\xf3n",RecursosObjecion:"Control y sanciones",SancionProveedores:"Control y sanciones",FuncionariosInhibicion:"Control y sanciones",Remates:"Control y sanciones"},f=["Cat\xe1logos base","Procesos y carteles","Ofertas y adjudicaciones","Contrataci\xf3n y ejecuci\xf3n","Control y sanciones","Otros"],b=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];const v=new class{normalizeKey(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/[^a-z0-9]/g,"")}getFieldCandidates(e,n){const a=new Set,t=e.trim(),s=t.toLowerCase(),i=s.replace(/\s+/g,"_"),o=s.replace(/[^a-z0-9]/g,"");[t,s,i,o].forEach(e=>{e.length>0&&a.add(e)});const r=g.W.getMapping(n);return r&&(r[s]&&a.add(r[s]),r[i]&&a.add(r[i]),Object.entries(r).forEach(e=>{let[n,t]=e;(s.includes(n)||n.includes(s)||i.includes(n))&&a.add(t)})),Array.from(a)}findMatchingField(e,n,a){const t=this.getFieldCandidates(e,n);if(0===t.length)return;const s=t.map(e=>e.toLowerCase()),i=t.map(e=>this.normalizeKey(e));for(const o of a)if(s.includes(o.lower)||i.includes(o.normalized))return o.original}getSchema(e){return u.find(n=>n.type===e)}async validateFile(e){const n=await h.q.getFile(e);if(!n)return{fileId:e,fileName:"Unknown",type:"Unknown",isValid:!1,issues:[{type:"error",message:"Archivo no encontrado en cach\xe9"}],stats:{totalRecords:0,validRecords:0,emptyFields:{},fieldsCoverage:{}}};const{fileInfo:a,data:t}=n,s=this.getSchema(a.type),i=[],o={},r={};if(s||i.push({type:"warning",message:'No hay esquema definido para el tipo "'.concat(a.type,'"')}),!t||0===t.length)return i.push({type:"error",message:"El archivo no contiene datos"}),{fileId:e,fileName:a.fileName,type:a.type,isValid:!1,issues:i,stats:{totalRecords:0,validRecords:0,emptyFields:o,fieldsCoverage:r}};const l=Object.keys(t[0]||{}),c=l.map(e=>({original:e,lower:e.toLowerCase(),normalized:this.normalizeKey(e)})),d={};if(s){const e=s.requiredFields.filter(e=>!this.findMatchingField(e,a.type,c));e.length>0&&i.push({type:"error",message:"Campos requeridos faltantes: ".concat(e.join(", ")),count:e.length}),s.requiredFields.forEach(e=>{const n=this.findMatchingField(e,a.type,c);if(d[e]=n,n){const a=t.filter(e=>{const a=e[n];return null!==a&&void 0!==a&&""!==a}).length,s=a/t.length*100;r[e]=s,s<50&&i.push({type:"warning",field:e,message:'Campo "'.concat(e,'" tiene solo ').concat(s.toFixed(1),"% de datos completos"),count:t.length-a}),o[e]=t.length-a}else r[e]=0,o[e]=t.length})}const p=l.filter(e=>e.toLowerCase().includes("id")||e.toLowerCase().includes("numero")||e.toLowerCase().includes("codigo"));if(p.length>0){const e=p[0],n=t.map(n=>n[e]).filter(e=>e),a=new Set(n);if(n.length!==a.size){const t=n.length-a.size;i.push({type:"warning",field:e,message:"Posibles ".concat(t,' registros duplicados en campo "').concat(e,'"'),count:t})}}let m=0;s?(m=t.filter(e=>s.requiredFields.every(n=>{const a=d[n];if(!a)return!1;const t=e[a];return null!==t&&void 0!==t&&""!==t})).length,m<t.length&&i.push({type:"info",message:"".concat(t.length-m," registros tienen campos requeridos vac\xedos"),count:t.length-m})):m=t.length;const g=0===i.filter(e=>"error"===e.type).length;return{fileId:e,fileName:a.fileName,type:a.type,isValid:g,issues:i,stats:{totalRecords:t.length,validRecords:m,emptyFields:o,fieldsCoverage:r}}}async analyzeAllFiles(e,n){const a=await h.q.getMetadata();let t=a.files;(e||n)&&(t=a.files.filter(a=>{const t=a.month.toString().padStart(2,"0"),s=a.year.toString();return(!e||t===e)&&(!n||s===n)}));const s=[];for(const h of t){const e=await this.validateFile(h.id);s.push(e)}const i=new Set(t.map(e=>e.type)),o=u.map(e=>e.type).filter(e=>!i.has(e)),r=s.filter(e=>0===e.issues.filter(e=>"error"===e.type).length).length,l=s.filter(e=>e.issues.some(e=>"error"===e.type)).length,c=s.filter(e=>e.issues.some(e=>"warning"===e.type)&&!e.issues.some(e=>"error"===e.type)).length,d=l+c,p=u.length>0?i.size/u.length*100:0,m=[];o.length>0&&m.push("Cargar ".concat(o.length," tipos de archivos faltantes: ").concat(o.slice(0,3).join(", ")).concat(o.length>3?"...":"")),l>0&&m.push("Corregir errores cr\xedticos en ".concat(l," archivo(s) antes de proceder con el an\xe1lisis"));const g=s.filter(e=>{const n=Object.values(e.stats.fieldsCoverage);if(0===n.length)return!1;return n.reduce((e,n)=>e+n,0)/n.length<70});g.length>0&&m.push("Revisar ".concat(g.length," archivo(s) con baja cobertura de datos (<70%)")),p<50&&m.push("Completitud actual: ".concat(p.toFixed(1),"%. Se recomienda cargar m\xe1s tipos de archivos para an\xe1lisis completo"));const v=new Map;u.forEach(e=>{const n=x[e.type]||"Otros";v.has(n)||v.set(n,{totalTypes:0,loadedTypes:new Set,missingTypes:[]});const a=v.get(n);a.totalTypes+=1,i.has(e.type)?a.loadedTypes.add(e.type):a.missingTypes.push(e.type)});const y=Array.from(v.entries()).map(e=>{let[n,a]=e;return{group:n,totalTypes:a.totalTypes,loadedTypes:Array.from(a.loadedTypes).sort(),missingTypes:a.missingTypes.sort(),completion:a.totalTypes>0?a.loadedTypes.size/a.totalTypes*100:0}}).sort((e,n)=>{const a=f.indexOf(e.group),t=f.indexOf(n.group),s=-1===a?f.length:a,i=-1===t?f.length:t;return s!==i?s-i:e.group.localeCompare(n.group)}),j=new Map;if(t.forEach(e=>{const n=Number(e.year),a=Number(e.month);if(!Number.isFinite(n)||!Number.isFinite(a))return;j.has(n)||j.set(n,new Map);const t=j.get(n);t.has(a)||t.set(a,new Set),t.get(a).add(e.type)}),n){const e=parseInt(n,10);Number.isNaN(e)||j.has(e)||j.set(e,new Map)}const N=Array.from(j.entries()).map(e=>{let[n,a]=e;const t=b.map((e,n)=>{const t=n+1,s=a.get(t),i=s?Array.from(s).sort():[];return{month:t,monthLabel:e,hasData:i.length>0,types:i}}),s=t.filter(e=>e.hasData).length;return{year:n,monthsWithData:s,monthsMissing:t.length-s,completion:t.length>0?s/t.length*100:0,detail:t}}).sort((e,n)=>n.year-e.year);return{totalFiles:t.length,validFiles:r,filesWithIssues:d,filesWithErrors:l,filesWithWarnings:c,missingFileTypes:o,fileValidations:s,recommendations:m,completeness:p,groupSummaries:y,yearCoverage:N}}async generateValidationReport(){const e=await this.analyzeAllFiles();let n="=== REPORTE DE VALIDACI\xd3N DE ARCHIVOS ===\n\n";return n+="\ud83d\udcca RESUMEN GENERAL\n",n+="  Total de archivos: ".concat(e.totalFiles,"\n"),n+="  Archivos v\xe1lidos: ".concat(e.validFiles,"\n"),n+="  Archivos con problemas: ".concat(e.filesWithIssues,"\n"),n+="  Completitud: ".concat(e.completeness.toFixed(1),"%\n\n"),e.missingFileTypes.length>0&&(n+="\u26a0\ufe0f  TIPOS DE ARCHIVOS FALTANTES (".concat(e.missingFileTypes.length,"):\n"),e.missingFileTypes.forEach(e=>{const a=u.find(n=>n.type===e);n+="  - ".concat(e).concat(a?": "+a.description:"","\n")}),n+="\n"),n+="\ud83d\udccb VALIDACI\xd3N POR ARCHIVO:\n\n",e.fileValidations.forEach(e=>{const a=e.isValid?"\u2705":"\u274c";n+="".concat(a," ").concat(e.fileName," (").concat(e.type,")\n"),n+="   Registros: ".concat(e.stats.totalRecords," (").concat(e.stats.validRecords," v\xe1lidos)\n"),e.issues.length>0&&e.issues.forEach(e=>{const a="error"===e.type?"\u274c":"warning"===e.type?"\u26a0\ufe0f":"\u2139\ufe0f";n+="   ".concat(a," ").concat(e.message,"\n")}),n+="\n"}),e.recommendations.length>0&&(n+="\ud83d\udca1 RECOMENDACIONES:\n",e.recommendations.forEach((e,a)=>{n+="  ".concat(a+1,". ").concat(e,"\n")})),n}async getMissingFileTypes(){const e=await h.q.getMetadata(),n=new Set(e.files.map(e=>e.type));return u.filter(e=>!n.has(e.type)).map(e=>({type:e.type,description:e.description}))}async getValidationStatsByType(){const e=await this.analyzeAllFiles(),n={};return e.fileValidations.forEach(e=>{n[e.type]||(n[e.type]={fileCount:0,totalRecords:0,validRecords:0,hasErrors:!1,hasWarnings:!1}),n[e.type].fileCount++,n[e.type].totalRecords+=e.stats.totalRecords,n[e.type].validRecords+=e.stats.validRecords,e.issues.some(e=>"error"===e.type)&&(n[e.type].hasErrors=!0),e.issues.some(e=>"warning"===e.type)&&(n[e.type].hasWarnings=!0)}),n}};var y=a(4414);const j=["InstitucionesRegistradas","Proveedores_unido","ProcedimientoAdjudicacion","ProcedimientoADM","Sistemas","SistemaEvaluacionOfertas","DetalleCarteles","DetalleLineaCartel","FechaPorEtapas","Ofertas","LineasOfertadas","LineasRecibidas","InvitacionProcedimiento","LineasAdjudicadas","AdjudicacionesFirme","Contratos","LineasContratadas","OrdenPedido","Recepciones","ReajustePrecios","Garantias","RecursosObjecion","FuncionariosInhibicion","SancionProveedores","Remates"],N=new Set(["InvitacionProcedimiento","Garantias","RecursosObjecion","SancionProveedores","Remates"]),C=e=>{let{onUploadComplete:n}=e;const[a,i]=(0,t.useState)([]),[l,u]=(0,t.useState)(!1),x=(new Date).getFullYear(),f=(new Date).getMonth()+1,[b,C]=(0,t.useState)(x),[A,w]=(0,t.useState)(f),O=e=>{const n=e.replace(/\.[^/.]+$/i,"").toLowerCase().replace(/[^a-z0-9]/g,""),a=j.find(e=>{const a=e.toLowerCase().replace(/[^a-z0-9]/g,"");return n.includes(a)});return a||console.warn('\u2753 No se pudo detectar el tipo de archivo para "'.concat(e,'": usando "Desconocido"')),a||"Desconocido"},E=(0,t.useCallback)(e=>{if(!e)return;const n=Array.from(e).filter(e=>e.name.endsWith(".csv")).map(e=>({file:e,year:b,month:A,type:O(e.name),status:"pending"}));i(e=>[...e,...n])},[b,A]),R=(0,t.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?u(!0):"dragleave"===e.type&&u(!1)},[]),S=(0,t.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),u(!1),E(e.dataTransfer.files)},[E]),k=(0,t.useCallback)((e,n)=>{if(!e)return e;const a=e.includes("\r\n")?"\r\n":"\n",t=n||(e.includes(";")?";":",");let s=e.replace(/^\uFEFF/,"").split(/\r?\n/);const i=(e,n)=>{let a=0,t=!1;for(let s=0;s<e.length;s++){const i=e[s];if('"'===i){const n=e[s+1];t&&'"'===n?s+=1:t=!t}else t||i!==n||(a+=1)}return a},o=e=>{const n=e.trim();return n.length>=2&&n.startsWith('"')&&n.endsWith('"')?n.slice(1,-1).replace(/""/g,'"'):e},r=s.slice(0,Math.min(s.length,10)).filter(e=>e.trim().length>0),l=r.length>0&&r.every(e=>{const n=e.trim();return n.length>1&&n.startsWith('"')&&n.endsWith('"')&&0===i(n,t)}),c=s.slice(1,Math.min(s.length,11)).filter(e=>e.trim().length>0),d=!l&&c.length>0&&c.every(e=>{const n=e.trim();return n.length>1&&n.startsWith('"')&&n.endsWith('"')&&0===i(n,t)});if(l?(console.log("\ud83d\udd27 Todas las l\xedneas est\xe1n envueltas en comillas, desempaquetando..."),s=s.map(e=>o(e))):d&&(console.log("\ud83d\udd27 Registros envueltos en comillas dobles detectados, desempaquetando registros..."),s=s.map((e,n)=>0===n?e:o(e))),s.length>1){var p,m,h,g;const e=null!==(p=null===(m=s[0])||void 0===m?void 0:m.trim())&&void 0!==p?p:"",n=null!==(h=null===(g=s[1])||void 0===g?void 0:g.trim())&&void 0!==h?h:"";if(e&&n){const a=i(e,t),o=i(n,t);0===a&&o>0&&(console.log('\ud83d\udd27 Eliminando l\xednea de t\xedtulo corrupta: "'.concat(e.substring(0,50),'..."')),s.shift())}}return s.join(a)},[]),I=(0,t.useCallback)(async(e,n)=>{const a="Proveedores_unido"===n?";":",";try{const n=(await e.slice(0,8192).text()).split(/\r?\n|\r/g).map(e=>e.trim()).filter(e=>e.length>0);if(n.length<2)return a;const t=(e,n)=>{let a=0,t=!1;for(let s=0;s<e.length;s++){const i=e[s];if('"'===i){const n=e[s+1];if(t&&'"'===n){s++;continue}t=!t}else i!==n||t||a++}return a},s=n[0],i=n.slice(1,Math.min(n.length,6)),o=t(s,";"),r=t(s,",");if(o>0&&o>r){if(i.reduce((e,n)=>e+t(n,";"),0)/Math.max(i.length,1)>=.8*o)return";"}if(r>0&&r>o){if(i.reduce((e,n)=>e+t(n,","),0)/Math.max(i.length,1)>=.8*r)return","}return a}catch(t){return console.warn("No fue posible detectar el delimitador, usando valor por defecto:",a,t),a}},[]),T=(0,t.useCallback)(async(e,n)=>new Promise(async(a,t)=>{const s=await e.text(),i=k(s,n.delimiter),r={header:!0,skipEmptyLines:!0,quoteChar:'"',escapeChar:'"',comments:!1,complete:e=>{const s=e.errors.filter(e=>"FieldMismatch"===e.type||"Quotes"===e.type),i=e.errors.filter(e=>"FieldMismatch"!==e.type&&"Quotes"!==e.type);if(0===i.length&&e.data&&e.data.length>0)a({data:e.data,delimiterUsed:e.meta.delimiter||n.delimiter||",",warnings:s});else{if(i.length>0){const e=i[0].message||"Error desconocido";return void t(new Error("Error parseando CSV (".concat(i[0].type,"): ").concat(e)))}a({data:e.data,delimiterUsed:e.meta.delimiter||n.delimiter||",",warnings:s})}}};n.delimiter&&(r.delimiter=n.delimiter),o().parse(i,r)}),[k]),z=(0,t.useCallback)(async e=>{const n=await I(e.file,e.type),a=[n,";"===n?",":";"];let t=null,s=null;for(const o of a)try{const n=await T(e.file,{delimiter:o});if(n.data&&n.data.length>0){if(n.warnings.every(e=>"FieldMismatch"===e.type||"Quotes"===e.type)||0===n.warnings.length)return console.log("\u2705 CSV ".concat(e.file.name,' parseado con delimitador "').concat(o,'"')),n;(!s||n.data.length>s.data.length)&&(s=n)}}catch(i){t=i instanceof Error?i:new Error(String(i)),console.warn('Fallo parseando con delimitador "'.concat(o,'" para ').concat(e.file.name,":"),t.message)}if(s&&s.data.length>0)return console.log("\u2705 CSV ".concat(e.file.name,' parseado con delimitador "').concat(s.delimiterUsed,'" (con ').concat(s.warnings.length," advertencias)")),s;try{const n=await T(e.file,{});if(n.data&&n.data.length>0)return console.info("\u2705 Se utiliz\xf3 detecci\xf3n autom\xe1tica de delimitador para ".concat(e.file.name,": ").concat(n.delimiterUsed)),n}catch(i){const e=i instanceof Error?i.message:"Error desconocido";throw new Error("Error parseando CSV tras probar delimitadores ".concat(a.join(", "),": ").concat(e))}throw new Error("No se pudo parsear el archivo ".concat(e.file.name," despu\xe9s de intentar m\xfaltiples m\xe9todos"))},[I,T]),D=(e,n)=>{i(a=>a.map((a,t)=>t===e?(0,s.A)((0,s.A)({},a),n):a))},_=async(e,n)=>{D(n,{status:"uploading"});try{const{data:a,delimiterUsed:t,warnings:s}=await z(e);s.length>0?console.warn("\u26a0\ufe0f Advertencias al parsear ".concat(e.file.name," (").concat(t,"):"),s):console.log("\u2705 CSV ".concat(e.file.name,' parseado con delimitador "').concat(t,'"'));const i=g.W.normalizeRecords(a,e.type);console.log("\u2705 Normalizando headers para ".concat(e.type,":"),{registrosOriginales:a.length,registrosNormalizados:i.length,primerRegistroOriginal:a[0]?Object.keys(a[0]):[],primerRegistroNormalizado:i[0]?Object.keys(i[0]):[]}),await h.q.saveFile(e.file.name,i,e.year,e.month,e.type),D(n,{status:"success",recordCount:i.length})}catch(a){const t=N.has(e.type),s=a instanceof Error?a.message:"Error desconocido";t&&(s.includes("string length")||s.includes("tama\xf1o"))?(D(n,{status:"skipped",error:"Archivo opcional no cargado (excede l\xedmite de tama\xf1o)"}),console.info("\u2139\ufe0f ".concat(e.type," omitido (archivo opcional): ").concat(s))):(D(n,{status:"error",error:s}),console.error("\u274c Error cargando ".concat(e.type,":"),s))}},M=e=>{if(0===e)return"0 Bytes";const n=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,n)*100)/100+" "+["Bytes","KB","MB","GB"][n]},F=Array.from({length:10},(e,n)=>x-n),P=[{value:1,label:"Enero"},{value:2,label:"Febrero"},{value:3,label:"Marzo"},{value:4,label:"Abril"},{value:5,label:"Mayo"},{value:6,label:"Junio"},{value:7,label:"Julio"},{value:8,label:"Agosto"},{value:9,label:"Septiembre"},{value:10,label:"Octubre"},{value:11,label:"Noviembre"},{value:12,label:"Diciembre"}];return(0,y.jsxs)("div",{className:"file-uploader",children:[(0,y.jsx)("style",{children:"\n        .file-uploader {\n          max-width: 1200px;\n          margin: 0 auto;\n          padding: 20px;\n        }\n\n        .global-metadata {\n          background: #f8f9fa;\n          border: 1px solid #dee2e6;\n          border-radius: 8px;\n          padding: 20px;\n          margin-bottom: 30px;\n        }\n\n        .global-metadata h3 {\n          margin: 0 0 15px 0;\n          color: #333;\n          font-size: 1.1em;\n        }\n\n        .global-metadata-fields {\n          display: grid;\n          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n          gap: 15px;\n          margin-bottom: 10px;\n        }\n\n        .global-metadata-info {\n          margin: 10px 0 0 0;\n          color: #666;\n          font-size: 0.9em;\n          font-style: italic;\n        }\n\n        .upload-zone {\n          border: 2px dashed #ccc;\n          border-radius: 8px;\n          padding: 40px;\n          text-align: center;\n          background: #fafafa;\n          transition: all 0.3s ease;\n          cursor: pointer;\n        }\n\n        .upload-zone.drag-active {\n          border-color: #4CAF50;\n          background: #e8f5e9;\n        }\n\n        .upload-zone:hover {\n          border-color: #999;\n          background: #f5f5f5;\n        }\n\n        .upload-icon {\n          margin: 0 auto 20px;\n          color: #666;\n        }\n\n        .upload-input {\n          display: none;\n        }\n\n        .files-list {\n          margin-top: 30px;\n        }\n\n        .file-item {\n          background: white;\n          border: 1px solid #e0e0e0;\n          border-radius: 8px;\n          padding: 15px;\n          margin-bottom: 15px;\n          box-shadow: 0 2px 4px rgba(0,0,0,0.05);\n        }\n\n        .file-header {\n          display: flex;\n          align-items: center;\n          justify-content: space-between;\n          margin-bottom: 15px;\n        }\n\n        .file-info {\n          display: flex;\n          align-items: center;\n          gap: 10px;\n          flex: 1;\n        }\n\n        .file-name {\n          font-weight: 500;\n          color: #333;\n        }\n\n        .file-size {\n          color: #666;\n          font-size: 0.9em;\n        }\n\n        .file-metadata {\n          display: grid;\n          grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n          gap: 15px;\n          margin-bottom: 10px;\n        }\n\n        .metadata-field {\n          display: flex;\n          flex-direction: column;\n          gap: 5px;\n        }\n\n        .metadata-label {\n          font-size: 0.85em;\n          color: #666;\n          font-weight: 500;\n        }\n\n        .metadata-select,\n        .metadata-input {\n          padding: 8px 12px;\n          border: 1px solid #ddd;\n          border-radius: 4px;\n          font-size: 0.95em;\n          background: white;\n        }\n\n        .metadata-select:focus,\n        .metadata-input:focus {\n          outline: none;\n          border-color: #4CAF50;\n        }\n\n        .metadata-value {\n          padding: 8px 12px;\n          background: #f5f5f5;\n          border-radius: 4px;\n          font-size: 0.95em;\n          color: #666;\n        }\n\n        .file-status {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n          padding: 8px 12px;\n          border-radius: 4px;\n          font-size: 0.9em;\n        }\n\n        .status-pending {\n          background: #fff9e6;\n          color: #f57c00;\n        }\n\n        .status-uploading {\n          background: #e3f2fd;\n          color: #1976d2;\n        }\n\n        .status-success {\n          background: #e8f5e9;\n          color: #388e3c;\n        }\n\n        .status-skipped {\n          background: #fff3e0;\n          color: #f57c00;\n        }\n\n        .status-error {\n          background: #ffebee;\n          color: #d32f2f;\n        }\n\n        .remove-btn {\n          background: none;\n          border: none;\n          color: #999;\n          cursor: pointer;\n          padding: 5px;\n          display: flex;\n          align-items: center;\n          transition: color 0.2s;\n        }\n\n        .remove-btn:hover {\n          color: #d32f2f;\n        }\n\n        .upload-actions {\n          margin-top: 20px;\n          display: flex;\n          gap: 15px;\n          justify-content: flex-end;\n        }\n\n        .btn {\n          padding: 12px 24px;\n          border: none;\n          border-radius: 6px;\n          font-size: 1em;\n          cursor: pointer;\n          transition: all 0.2s;\n          display: flex;\n          align-items: center;\n          gap: 8px;\n        }\n\n        .btn-primary {\n          background: #4CAF50;\n          color: white;\n        }\n\n        .btn-primary:hover {\n          background: #45a049;\n        }\n\n        .btn-primary:disabled {\n          background: #ccc;\n          cursor: not-allowed;\n        }\n\n        .btn-secondary {\n          background: #f5f5f5;\n          color: #333;\n        }\n\n        .btn-secondary:hover {\n          background: #e0e0e0;\n        }\n\n        .error-message {\n          color: #d32f2f;\n          font-size: 0.85em;\n          margin-top: 5px;\n        }\n      "}),(0,y.jsx)("h2",{children:"Cargar Archivos CSV"}),(0,y.jsxs)("div",{className:"global-metadata",children:[(0,y.jsx)("h3",{children:"Per\xedodo de Datos"}),(0,y.jsxs)("div",{className:"global-metadata-fields",children:[(0,y.jsxs)("div",{className:"metadata-field",children:[(0,y.jsx)("label",{className:"metadata-label",children:"A\xf1o"}),(0,y.jsx)("select",{className:"metadata-select",value:b,onChange:e=>C(parseInt(e.target.value)),children:F.map(e=>(0,y.jsx)("option",{value:e,children:e},e))})]}),(0,y.jsxs)("div",{className:"metadata-field",children:[(0,y.jsx)("label",{className:"metadata-label",children:"Mes"}),(0,y.jsx)("select",{className:"metadata-select",value:A,onChange:e=>w(parseInt(e.target.value)),children:P.map(e=>(0,y.jsx)("option",{value:e.value,children:e.label},e.value))})]})]}),(0,y.jsx)("p",{className:"global-metadata-info",children:"Este per\xedodo se aplicar\xe1 a todos los archivos que cargues en este grupo"})]}),(0,y.jsxs)("div",{className:"upload-zone ".concat(l?"drag-active":""),onDragEnter:R,onDragLeave:R,onDragOver:R,onDrop:S,onClick:()=>{var e;return null===(e=document.getElementById("file-input"))||void 0===e?void 0:e.click()},children:[(0,y.jsx)(r.A,{size:48,className:"upload-icon"}),(0,y.jsx)("h3",{children:"Arrastra archivos CSV aqu\xed"}),(0,y.jsx)("p",{children:"o haz clic para seleccionar archivos"}),(0,y.jsx)("input",{id:"file-input",type:"file",multiple:!0,accept:".csv",className:"upload-input",onChange:e=>E(e.target.files)})]}),a.length>0&&(0,y.jsxs)("div",{className:"files-list",children:[(0,y.jsxs)("h3",{children:["Archivos a cargar (",a.length,")"]}),a.map((e,n)=>{var a;return(0,y.jsxs)("div",{className:"file-item",children:[(0,y.jsxs)("div",{className:"file-header",children:[(0,y.jsxs)("div",{className:"file-info",children:[(0,y.jsx)(c,{size:20}),(0,y.jsxs)("div",{children:[(0,y.jsx)("div",{className:"file-name",children:e.file.name}),(0,y.jsxs)("div",{className:"file-size",children:[M(e.file.size),e.recordCount&&" \u2022 ".concat(e.recordCount.toLocaleString()," registros")]})]})]}),(0,y.jsx)("button",{className:"remove-btn",onClick:()=>(e=>{i(n=>n.filter((n,a)=>a!==e))})(n),disabled:"uploading"===e.status,children:(0,y.jsx)(d.A,{size:20})})]}),(0,y.jsxs)("div",{className:"file-metadata",children:[(0,y.jsxs)("div",{className:"metadata-field",children:[(0,y.jsx)("label",{className:"metadata-label",children:"Tipo de archivo"}),(0,y.jsx)("select",{className:"metadata-select",value:e.type,onChange:e=>D(n,{type:e.target.value}),disabled:"pending"!==e.status,children:j.map(e=>(0,y.jsx)("option",{value:e,children:e},e))})]}),(0,y.jsxs)("div",{className:"metadata-field",children:[(0,y.jsx)("label",{className:"metadata-label",children:"Per\xedodo"}),(0,y.jsxs)("div",{className:"metadata-value",children:[null===(a=P.find(n=>n.value===e.month))||void 0===a?void 0:a.label," ",e.year]})]})]}),(0,y.jsxs)("div",{className:"file-status status-".concat(e.status),children:["pending"===e.status&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(p.A,{size:16}),(0,y.jsx)("span",{children:"Pendiente"})]}),"uploading"===e.status&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:"spinner"}),(0,y.jsx)("span",{children:"Subiendo..."})]}),"success"===e.status&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(m.A,{size:16}),(0,y.jsx)("span",{children:"Cargado exitosamente"})]}),"skipped"===e.status&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(p.A,{size:16}),(0,y.jsx)("span",{children:"No cargado (opcional)"})]}),"error"===e.status&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(p.A,{size:16}),(0,y.jsx)("span",{children:"Error al cargar"})]})]}),e.error&&(0,y.jsx)("div",{className:"error-message",children:e.error})]},n)}),(0,y.jsxs)("div",{className:"upload-actions",children:[(0,y.jsx)("button",{className:"btn btn-secondary",onClick:()=>i([]),disabled:a.some(e=>"uploading"===e.status),children:"Limpiar lista"}),(0,y.jsxs)("button",{className:"btn btn-primary",onClick:async()=>{for(let n=0;n<a.length;n++)"pending"===a[n].status&&await _(a[n],n);if(a.filter(e=>"success"===e.status).length>0){console.log("Generando reporte de validaci\xf3n...");try{const e=await v.generateValidationReport();console.log("=== REPORTE DE VALIDACI\xd3N ==="),console.log(e);const n=await v.analyzeAllFiles();n.missingFileTypes.length>0&&console.warn("\u26a0\ufe0f Tipos de archivos faltantes: ".concat(n.missingFileTypes.join(", "))),n.recommendations.length>0&&(console.info("\ud83d\udca1 Recomendaciones:"),n.recommendations.forEach((e,n)=>{console.info("  ".concat(n+1,". ").concat(e))}))}catch(t){console.error("Error generando reporte de validaci\xf3n:",t)}}const e=a.filter(e=>"success"===e.status);if(n&&e.length>0){const e=await h.q.getMetadata();n(e.files)}},disabled:0===a.length||a.every(e=>"pending"!==e.status)||a.some(e=>"uploading"===e.status),children:[(0,y.jsx)(r.A,{size:20}),"Cargar archivos (",a.filter(e=>"pending"===e.status).length,")"]})]})]})]})},A=(0,l.A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var w=a(3270),O=a(4814),E=a(6355),R=a(7637);const S=(0,l.A)("archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]),k=(0,l.A)("hard-drive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);var I=a(9201),T=a(8134),z=a(6890);const D=(0,l.A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),_=(0,l.A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);var M=a(1337);const F=new class{constructor(){this.EXPECTED_TYPES=Object.values(M.d$),this.KEY_FIELDS={Contratos:["NumeroContrato"],Proveedores:["Cedula","idProveedor"],LineasContratadas:["NumeroContrato","NumeroLinea"],LineasAdjudicadas:["NumeroCartel","NumeroLinea"],DetalleCarteles:["NumeroCartel"],ProcedimientoAdjudicacion:["NumeroCartel"],InstitucionesRegistradas:["CodigoInstitucion"],Ofertas:["NumeroCartel","IdProveedor"],AdjudicacionesFirme:["NumeroCartel","NumeroLinea"],DetalleLineaCartel:["NumeroCartel","NumeroLinea"],FechaPorEtapas:["NumeroCartel","Etapa"],FuncionariosInhibicion:["Cedula"],Garantias:["NumeroContrato","TipoGarantia"],InvitacionProcedimiento:["NumeroCartel","IdProveedor"],LineasOfertadas:["NumeroCartel","NumeroLinea","IdProveedor"],LineasRecibidas:["NumeroCartel","NumeroLinea"],OrdenPedido:["NumeroOrden"],ProcedimientoADM:["NumeroCartel"],Recepciones:["NumeroContrato","NumeroRecepcion"],ReajustePrecios:["NumeroContrato","Periodo"],RecursosObjecion:["NumeroCartel","IdRecurso"],Remates:["NumeroRemate"],SancionProveedores:["Cedula","FechaSancion"],Sistemas:["CodigoSistema"],SistemaEvaluacionOfertas:["NumeroCartel"]},this.METADATA_FIELDS=["_YEAR","_MONTH","_FILE_SOURCE","_UPLOAD_DATE"]}async validateCacheDataManagerSync(){const e=[],n=[];console.log("\ud83d\udd0d Validando sincronizaci\xf3n Cache \u2194 DataManager...");const a=await h.q.getMetadata(),t=[...new Set(a.files.map(e=>e.type))].sort(),s=this.EXPECTED_TYPES.sort(),i=s.filter(e=>!t.includes(e)),o=t.filter(e=>!s.includes(e)),r={};a.files.forEach(e=>{r[e.type]=(r[e.type]||0)+e.recordCount}),i.length>0&&(e.push("Tipos de archivo faltantes en cache: ".concat(i.join(", "))),e.push("DataManager puede generar fallbacks para algunos tipos faltantes (ej: Proveedores)")),o.length>0&&(e.push("Tipos de archivo en cache no reconocidos por DataManager: ".concat(o.join(", "))),e.push("Estos archivos ser\xe1n ignorados durante la carga"));for(const c of t)this.KEY_FIELDS[c]||e.push('Tipo "'.concat(c,'" no tiene campos clave definidos para deduplicaci\xf3n'));const l=0===n.length;return console.log(l?"\u2705 Validaci\xf3n exitosa":"\u274c Validaci\xf3n con errores"),console.log("\ud83d\udcca Tipos en cache: ".concat(t.length," | Tipos esperados: ").concat(s.length)),{isValid:l,warnings:e,errors:n,stats:{expectedTypes:s,cachedTypes:t,missingTypes:i,extraTypes:o,totalCachedRecords:a.totalRecords,typeBreakdown:r}}}async checkCacheIntegrity(){console.log("\ud83d\udd0e Verificando integridad de datos en cache...");const e=await h.q.getMetadata(),n={duplicateKeys:[],missingRequiredFields:[],invalidDataTypes:[]},a=[],t=new Map;e.files.forEach(e=>{t.has(e.type)||t.set(e.type,[]),t.get(e.type).push(e)});for(const[i,o]of t.entries()){console.log("  \ud83d\udcc1 Verificando ".concat(i,"..."));const e=[];for(const n of o){const a=await h.q.getFile(n.id);a&&a.data&&e.push(...a.data)}if(0===e.length)continue;const t=this.KEY_FIELDS[i];if(t){const s=new Map;e.forEach(e=>{const n=t.map(n=>String(e[n]||"")).join("|");s.set(n,(s.get(n)||0)+1)});const o=Array.from(s.entries()).filter(e=>{let[n,a]=e;return a>1});o.length>0&&(o.forEach(e=>{let[a,t]=e;n.duplicateKeys.push({type:i,key:a,count:t})}),a.push('Ejecutar deduplicaci\xf3n en tipo "'.concat(i,'" (').concat(o.length," claves duplicadas)"))),t.forEach(a=>{const t=e.filter(e=>!e[a]||""===String(e[a]).trim());t.length>0&&n.missingRequiredFields.push({type:i,field:a,recordsAffected:t.length})})}this.METADATA_FIELDS.forEach(t=>{const s=e.filter(e=>!e[t]);s.length>0&&(n.missingRequiredFields.push({type:i,field:t,recordsAffected:s.length}),s.length===e.length&&a.push('CR\xcdTICO: Tipo "'.concat(i,'" no tiene campos de metadatos. ')+"Estos datos pueden no haberse guardado correctamente en cache."))})}const s=0===n.duplicateKeys.length&&0===n.missingRequiredFields.length&&0===n.invalidDataTypes.length;return console.log(s?"\u2705 Cache \xedntegro":"\u26a0\ufe0f Issues detectados en cache"),{isHealthy:s,issues:n,recommendations:a}}async generateSyncReport(){console.log("\n\ud83d\udccb === REPORTE DE SINCRONIZACI\xd3N CACHE \u2194 DATAMANAGER ===\n");const e=await this.validateCacheDataManagerSync(),n=await this.checkCacheIntegrity(),a=[];return e.stats.missingTypes.length>0&&a.push("\ud83d\udce5 Subir archivos CSV para los tipos faltantes: "+e.stats.missingTypes.join(", ")),e.stats.extraTypes.length>0&&a.push("\ud83d\uddd1\ufe0f Considerar remover tipos no reconocidos del cache: "+e.stats.extraTypes.join(", ")),n.isHealthy||a.push(...n.recommendations),e.isValid&&n.isHealthy&&(a.push("\u2705 Cache y DataManager est\xe1n perfectamente sincronizados"),a.push("\ud83d\ude80 Puede cargar datos con confianza usando DataLoaderService")),console.log("\n\ud83d\udcca RESUMEN:"),console.log("  \u2022 Tipos en cache: ".concat(e.stats.cachedTypes.length)),console.log("  \u2022 Tipos esperados: ".concat(e.stats.expectedTypes.length)),console.log("  \u2022 Registros totales: ".concat(e.stats.totalCachedRecords.toLocaleString())),console.log("  \u2022 Validaci\xf3n: ".concat(e.isValid?"\u2705":"\u274c")),console.log("  \u2022 Integridad: ".concat(n.isHealthy?"\u2705":"\u26a0\ufe0f")),e.warnings.length>0&&(console.log("\n\u26a0\ufe0f ADVERTENCIAS:"),e.warnings.forEach(e=>console.log("  \u2022 ".concat(e)))),e.errors.length>0&&(console.log("\n\u274c ERRORES:"),e.errors.forEach(e=>console.log("  \u2022 ".concat(e)))),a.length>0&&(console.log("\n\ud83d\udca1 RECOMENDACIONES:"),a.forEach(e=>console.log("  \u2022 ".concat(e)))),console.log("\n"+"=".repeat(60)+"\n"),{validation:e,integrity:n,recommendations:a}}isTypeSupported(e){return this.EXPECTED_TYPES.includes(e)}getKeyFieldsForType(e){return this.KEY_FIELDS[e]}hasRequiredMetadata(e){return this.METADATA_FIELDS.every(n=>void 0!==e[n])}async getCacheUsageStats(){const e=await h.q.getMetadata(),n={},a=new Set,t=new Set,s=new Map;e.files.forEach(e=>{n[e.type]||(n[e.type]={files:0,records:0}),n[e.type].files++,n[e.type].records+=e.recordCount,a.add(e.year),t.add(e.month);const i="".concat(e.year,"-").concat(e.month);s.set(i,(s.get(i)||0)+1)});const i=Array.from(s.entries()).map(e=>{let[n,a]=e;const[t,s]=n.split("-").map(Number);return{year:t,month:s,files:a}}).sort((e,n)=>e.year-n.year||e.month-n.month),o=e.files.reduce((e,n)=>e+n.size,0)/1048576;return{totalFiles:e.files.length,totalRecords:e.totalRecords,sizeEstimateMB:Math.round(100*o)/100,typeDistribution:n,temporalCoverage:{years:Array.from(a).sort(),months:Array.from(t).sort(),yearMonthCombinations:i}}}async getTypeMappingStatus(){const e=await h.q.getMetadata(),n=new Set([...this.EXPECTED_TYPES,...e.files.map(e=>e.type)]),a={};for(const t of n){const n=e.files.filter(e=>e.type===t),s=n.reduce((e,n)=>e+n.recordCount,0);a[t]={inCache:n.length>0,supported:this.isTypeSupported(t),filesCount:n.length,recordsCount:s,hasKeyFields:void 0!==this.KEY_FIELDS[t]}}return a}};var P=a(1397),L=a.n(P);const U=new class{async consolidateData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{years:n,months:a,types:t,deduplicateBy:i,sortBy:o,sortOrder:r="asc"}=e;if(t&&t.length>0){const e=t.filter(e=>!F.isTypeSupported(e));e.length>0&&console.warn("\u26a0\ufe0f Tipos no soportados por DataManager: ".concat(e.join(", "),". ")+"Estos datos pueden no cargarse correctamente.")}let l=(await h.q.getMetadata()).files;n&&n.length>0&&(l=l.filter(e=>n.includes(e.year))),a&&a.length>0&&(l=l.filter(e=>a.includes(e.month))),t&&t.length>0&&(l=l.filter(e=>t.includes(e.type)));const c=await Promise.all(l.map(e=>h.q.getFile(e.id)));let d=[];c.forEach(e=>{if(e&&e.data){const n=e.data.map(n=>(0,s.A)((0,s.A)({},n),{},{_YEAR:e.fileInfo.year,_MONTH:e.fileInfo.month,_FILE_SOURCE:e.fileInfo.fileName,_UPLOAD_DATE:e.fileInfo.uploadDate}));d=d.concat(n)}});const p=l.map(e=>e.year),m=l.map(e=>e.month),g=[...new Set(l.map(e=>e.type))];if(i&&d.length>0){const e=d.length;d=L().uniqBy(d,i);const n=d.length;e>n&&console.log('\ud83d\udd27 Deduplicaci\xf3n manual por "'.concat(i,'": ')+"".concat(e," \u2192 ").concat(n," registros ")+"(removidos ".concat(e-n," duplicados)"))}return o&&d.length>0&&(d=L().orderBy(d,[o],[r])),{data:d,metadata:{totalRecords:d.length,filesIncluded:l.length,yearRange:{min:Math.min(...p),max:Math.max(...p)},monthRange:{min:Math.min(...m),max:Math.max(...m)},types:g,consolidatedAt:(new Date).toISOString()}}}async consolidateByType(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.consolidateData((0,s.A)((0,s.A)({},n),{},{types:[e]}))}async consolidateByYear(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.consolidateData((0,s.A)((0,s.A)({},n),{},{years:[e]}))}async consolidateByMonth(e,n){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.consolidateData((0,s.A)((0,s.A)({},a),{},{years:[e],months:[n]}))}async consolidateByYearRange(e,n){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const t=[];for(let s=e;s<=n;s++)t.push(s);return this.consolidateData((0,s.A)((0,s.A)({},a),{},{years:t}))}async consolidateAll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.consolidateData(e)}async consolidateAndGroupBy(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=await this.consolidateData(n);return L().groupBy(a.data,e)}async consolidateAndAggregate(e,n,a){let t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const s=await this.consolidateData(t);if(a){const t=L().groupBy(s.data,a),i={};return Object.keys(t).forEach(a=>{const s=t[a].map(n=>parseFloat(n[e])).filter(e=>!isNaN(e));switch(n){case"sum":i[a]=L().sum(s);break;case"avg":i[a]=L().mean(s);break;case"min":i[a]=L().min(s);break;case"max":i[a]=L().max(s);break;case"count":i[a]=s.length}}),i}{const a=s.data.map(n=>parseFloat(n[e])).filter(e=>!isNaN(e));switch(n){case"sum":return L().sum(a);case"avg":return L().mean(a);case"min":return L().min(a);case"max":return L().max(a);case"count":return a.length;default:return null}}}async getConsolidatedStats(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=await this.consolidateData(e),a=new Blob([JSON.stringify(n.data)]).size/1048576;return{totalRecords:n.metadata.totalRecords,filesIncluded:n.metadata.filesIncluded,yearRange:"".concat(n.metadata.yearRange.min," - ").concat(n.metadata.yearRange.max),monthRange:"".concat(n.metadata.monthRange.min," - ").concat(n.metadata.monthRange.max),types:n.metadata.types,sizeInMB:Math.round(100*a)/100}}async exportConsolidatedCSV(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=await this.consolidateData(e);if(0===n.data.length)return"";const a=Object.keys(n.data[0]);return[a.join(","),...n.data.map(e=>a.map(n=>{const a=e[n];return"string"===typeof a&&(a.includes(",")||a.includes('"'))?'"'.concat(a.replace(/"/g,'""'),'"'):null!==a&&void 0!==a?a:""}).join(","))].join("\n")}async downloadConsolidatedCSV(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"datos_consolidados.csv",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=await this.exportConsolidatedCSV(n),t=new Blob([a],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),i=URL.createObjectURL(t);s.setAttribute("href",i),s.setAttribute("download",e),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s)}async saveConsolidatedAsCache(e,n,a,t){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const i=await this.consolidateData(s);return await h.q.saveFile(e,i.data,n,a,t)}async comparePerio(e,n,a,t,s,i){const o=await this.consolidateByMonth(e,n,{types:[s]}),r=await this.consolidateByMonth(a,t,{types:[s]}),l=await this.consolidateAndAggregate(i,"sum",void 0,{years:[e],months:[n],types:[s]}),c=await this.consolidateAndAggregate(i,"sum",void 0,{years:[a],months:[t],types:[s]}),d=c-l,p=0!==l?d/l*100:0;return{period1:{year:e,month:n,value:l,count:o.metadata.totalRecords},period2:{year:a,month:t,value:c,count:r.metadata.totalRecords},difference:d,percentageChange:p}}},V=e=>{let{onDataChange:n}=e;const[a,s]=(0,t.useState)(null),[i,o]=(0,t.useState)(new Set),[r,l]=(0,t.useState)(new Set),[c,d]=(0,t.useState)(!0),[m,g]=(0,t.useState)(null),[u,x]=(0,t.useState)(null),[f,b]=(0,t.useState)(null),[v,j]=(0,t.useState)(null),[N,C]=(0,t.useState)(null),[M,F]=(0,t.useState)([]),[P,L]=(0,t.useState)(!1),V=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],q=(0,t.useMemo)(()=>a?[...new Set(a.files.map(e=>e.year))].sort((e,n)=>n-e):[],[a]),B=(0,t.useMemo)(()=>{if(!a)return[];let e=a.files.map(e=>e.month);return null!==u&&(e=a.files.filter(e=>e.year===u).map(e=>e.month)),[...new Set(e)].sort((e,n)=>e-n)},[a,u]),H=(0,t.useMemo)(()=>a?[...new Set(a.files.map(e=>e.type))].sort():[],[a]),Y=(0,t.useMemo)(()=>{if(!a)return{};let e=a.files;null!==u&&(e=e.filter(e=>e.year===u)),null!==f&&(e=e.filter(e=>e.month===f)),null!==v&&(e=e.filter(e=>e.type===v));const n={};return e.forEach(e=>{n[e.year]||(n[e.year]={}),n[e.year][e.month]||(n[e.year][e.month]={}),n[e.year][e.month][e.type]||(n[e.year][e.month][e.type]=[]),n[e.year][e.month][e.type].push(e)}),n},[a,u,f,v]),G=(0,t.useMemo)(()=>{if(!a||0===a.files.length)return null;const e={totalYears:q.length,totalMonths:new Set(a.files.map(e=>e.month)).size,byYear:{},byType:{},trends:[]};if(q.forEach(n=>{const t=a.files.filter(e=>e.year===n),s=[...new Set(t.map(e=>e.month))];e.byYear[n]={totalFiles:t.length,totalRecords:t.reduce((e,n)=>e+n.recordCount,0),months:s.length,avgRecordsPerFile:Math.round(t.reduce((e,n)=>e+n.recordCount,0)/t.length),types:[...new Set(t.map(e=>e.type))]}}),H.forEach(n=>{const t=a.files.filter(e=>e.type===n),s=[...new Set(t.map(e=>e.year))];e.byType[n]={totalFiles:t.length,totalRecords:t.reduce((e,n)=>e+n.recordCount,0),years:s.length,avgRecordsPerFile:Math.round(t.reduce((e,n)=>e+n.recordCount,0)/t.length),coverage:"".concat(s.length,"/").concat(q.length," a\xf1os")}}),q.length>1){const n=q[0],a=q[1],t=e.byYear[n].totalRecords,s=e.byYear[a].totalRecords,i=t-s,o=(i/s*100).toFixed(1);e.trends.push({type:"yearly",description:"Cambio de ".concat(a," a ").concat(n),value:i>0?"+".concat(o,"%"):"".concat(o,"%"),positive:i>0})}return e},[a,q,H]),W=async()=>{d(!0);try{const e=await h.q.getMetadata(),n=await h.q.getCacheStats();s(e),g(n)}catch(e){console.error("Error loading cache data:",e)}finally{d(!1)}};(0,t.useEffect)(()=>{W()},[]);const J=()=>{C(null),F([])},$=async(e,n,a)=>{try{const t={};e&&(t.years=[e]),n&&(t.months=[n]),a&&(t.types=[a]);const s="consolidado_".concat(a||"todos","_").concat(e||"todos","_").concat(n||"todos",".csv");await U.downloadConsolidatedCSV(s,t)}catch(t){console.error("Error downloading consolidated data:",t),alert("Error al descargar datos consolidados")}},X=e=>{if(0===e)return"0 Bytes";const n=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,n)*100)/100+" "+["Bytes","KB","MB","GB"][n]};return c?(0,y.jsx)("div",{className:"cache-manager loading",children:"Cargando datos del cach\xe9..."}):(0,y.jsxs)("div",{className:"cache-manager",children:[(0,y.jsx)("style",{children:"\n        .cache-manager {\n          max-width: 1600px;\n          margin: 0 auto;\n          padding: 20px;\n          background: #f5f7fa;\n          min-height: 100vh;\n        }\n\n        .cache-header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          margin-bottom: 30px;\n          padding: 25px;\n          background: white;\n          border-radius: 12px;\n          box-shadow: 0 2px 8px rgba(0,0,0,0.08);\n        }\n\n        .cache-title {\n          display: flex;\n          align-items: center;\n          gap: 12px;\n          font-size: 1.8em;\n          font-weight: 700;\n          color: #1a1a1a;\n        }\n\n        .cache-actions {\n          display: flex;\n          gap: 10px;\n        }\n\n        /* Filtros */\n        .filters-section {\n          background: white;\n          border-radius: 12px;\n          padding: 20px;\n          margin-bottom: 25px;\n          box-shadow: 0 2px 8px rgba(0,0,0,0.08);\n        }\n\n        .filters-header {\n          display: flex;\n          align-items: center;\n          gap: 10px;\n          margin-bottom: 15px;\n          font-size: 1.1em;\n          font-weight: 600;\n          color: #333;\n        }\n\n        .filters-grid {\n          display: grid;\n          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n          gap: 15px;\n          margin-bottom: 15px;\n        }\n\n        .filter-group {\n          display: flex;\n          flex-direction: column;\n          gap: 6px;\n        }\n\n        .filter-label {\n          font-size: 0.85em;\n          font-weight: 500;\n          color: #666;\n        }\n\n        .filter-select {\n          padding: 10px 12px;\n          border: 2px solid #e0e0e0;\n          border-radius: 8px;\n          font-size: 0.95em;\n          background: white;\n          cursor: pointer;\n          transition: all 0.2s;\n        }\n\n        .filter-select:hover {\n          border-color: #4CAF50;\n        }\n\n        .filter-select:focus {\n          outline: none;\n          border-color: #4CAF50;\n          box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);\n        }\n\n        .filter-actions {\n          display: flex;\n          gap: 10px;\n          align-items: center;\n        }\n\n        .active-filters {\n          font-size: 0.9em;\n          color: #4CAF50;\n          font-weight: 500;\n        }\n\n        /* Estad\xedsticas mejoradas */\n        .cache-stats {\n          display: grid;\n          grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));\n          gap: 20px;\n          margin-bottom: 30px;\n        }\n\n        .stat-card {\n          background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);\n          border: 1px solid #e8e8e8;\n          border-radius: 12px;\n          padding: 24px;\n          box-shadow: 0 4px 12px rgba(0,0,0,0.06);\n          transition: transform 0.2s, box-shadow 0.2s;\n          position: relative;\n          overflow: hidden;\n        }\n\n        .stat-card::before {\n          content: '';\n          position: absolute;\n          top: 0;\n          left: 0;\n          width: 4px;\n          height: 100%;\n          background: linear-gradient(180deg, #4CAF50, #2196F3);\n        }\n\n        .stat-card:hover {\n          transform: translateY(-4px);\n          box-shadow: 0 8px 20px rgba(0,0,0,0.12);\n        }\n\n        .stat-label {\n          display: flex;\n          align-items: center;\n          gap: 10px;\n          font-size: 0.9em;\n          color: #666;\n          margin-bottom: 12px;\n          font-weight: 500;\n        }\n\n        .stat-value {\n          font-size: 2.2em;\n          font-weight: 800;\n          color: #1a1a1a;\n          margin-bottom: 4px;\n        }\n\n        .stat-subvalue {\n          font-size: 0.85em;\n          color: #888;\n          margin-top: 8px;\n          font-weight: 500;\n        }\n\n        /* An\xe1lisis de consistencia */\n        .consistency-section {\n          background: white;\n          border-radius: 12px;\n          padding: 25px;\n          margin-bottom: 25px;\n          box-shadow: 0 2px 8px rgba(0,0,0,0.08);\n        }\n\n        .consistency-header {\n          display: flex;\n          align-items: center;\n          gap: 10px;\n          margin-bottom: 20px;\n          font-size: 1.3em;\n          font-weight: 700;\n          color: #1a1a1a;\n        }\n\n        .consistency-grid {\n          display: grid;\n          grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n          gap: 20px;\n        }\n\n        .consistency-card {\n          background: #f8f9fa;\n          border-radius: 10px;\n          padding: 18px;\n          border-left: 4px solid #4CAF50;\n        }\n\n        .consistency-card-title {\n          font-weight: 600;\n          color: #333;\n          margin-bottom: 12px;\n          font-size: 1.05em;\n        }\n\n        .consistency-item {\n          display: flex;\n          justify-content: space-between;\n          padding: 8px 0;\n          border-bottom: 1px solid #e0e0e0;\n          font-size: 0.9em;\n        }\n\n        .consistency-item:last-child {\n          border-bottom: none;\n        }\n\n        .consistency-label {\n          color: #666;\n        }\n\n        .consistency-value {\n          font-weight: 600;\n          color: #333;\n        }\n\n        .trend-card {\n          display: flex;\n          align-items: center;\n          gap: 12px;\n          background: #e8f5e9;\n          padding: 15px;\n          border-radius: 8px;\n          margin-top: 10px;\n        }\n\n        .trend-card.negative {\n          background: #ffebee;\n        }\n\n        .trend-value {\n          font-size: 1.3em;\n          font-weight: 700;\n          color: #2e7d32;\n        }\n\n        .trend-value.negative {\n          color: #c62828;\n        }\n\n        /* Grupos de archivos mejorados */\n        .year-group {\n          background: white;\n          border: 1px solid #e0e0e0;\n          border-radius: 12px;\n          margin-bottom: 20px;\n          overflow: hidden;\n          box-shadow: 0 2px 8px rgba(0,0,0,0.06);\n          transition: all 0.2s;\n        }\n\n        .year-group:hover {\n          box-shadow: 0 4px 12px rgba(0,0,0,0.1);\n        }\n\n        .year-header {\n          display: flex;\n          align-items: center;\n          justify-content: space-between;\n          padding: 18px 24px;\n          background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);\n          cursor: pointer;\n          transition: background 0.2s;\n          border-bottom: 2px solid #e0e0e0;\n        }\n\n        .year-header:hover {\n          background: linear-gradient(135deg, #e9ecef 0%, #dee2e6 100%);\n        }\n\n        .year-info {\n          display: flex;\n          align-items: center;\n          gap: 15px;\n          flex: 1;\n        }\n\n        .year-title {\n          font-size: 1.3em;\n          font-weight: 700;\n          color: #1a1a1a;\n        }\n\n        .year-badge {\n          background: linear-gradient(135deg, #4CAF50, #45a049);\n          color: white;\n          padding: 6px 14px;\n          border-radius: 16px;\n          font-size: 0.85em;\n          font-weight: 600;\n          box-shadow: 0 2px 4px rgba(76, 175, 80, 0.3);\n        }\n\n        .year-actions {\n          display: flex;\n          gap: 10px;\n        }\n\n        .month-group {\n          border-top: 1px solid #e8e8e8;\n          background: #fafafa;\n        }\n\n        .month-header {\n          display: flex;\n          align-items: center;\n          justify-content: space-between;\n          padding: 14px 24px 14px 48px;\n          cursor: pointer;\n          transition: background 0.2s;\n        }\n\n        .month-header:hover {\n          background: #f0f0f0;\n        }\n\n        .month-info {\n          display: flex;\n          align-items: center;\n          gap: 12px;\n          flex: 1;\n        }\n\n        .month-title {\n          font-size: 1.1em;\n          font-weight: 600;\n          color: #333;\n        }\n\n        .month-badge {\n          background: linear-gradient(135deg, #2196F3, #1976D2);\n          color: white;\n          padding: 4px 12px;\n          border-radius: 12px;\n          font-size: 0.8em;\n          font-weight: 600;\n          box-shadow: 0 2px 4px rgba(33, 150, 243, 0.3);\n        }\n\n        .type-group {\n          padding: 12px 24px 12px 72px;\n          border-top: 1px solid #e8e8e8;\n        }\n\n        .type-header {\n          display: flex;\n          align-items: center;\n          justify-content: space-between;\n          padding: 10px 0;\n          margin-bottom: 10px;\n        }\n\n        .type-title {\n          display: flex;\n          align-items: center;\n          gap: 10px;\n          font-weight: 600;\n          color: #555;\n          font-size: 1.05em;\n        }\n\n        .file-list {\n          display: flex;\n          flex-direction: column;\n          gap: 10px;\n        }\n\n        .file-item {\n          display: flex;\n          align-items: center;\n          justify-content: space-between;\n          padding: 14px 18px;\n          background: white;\n          border: 2px solid #e8e8e8;\n          border-radius: 10px;\n          transition: all 0.2s;\n        }\n\n        .file-item:hover {\n          border-color: #4CAF50;\n          box-shadow: 0 4px 12px rgba(76, 175, 80, 0.15);\n          transform: translateX(4px);\n        }\n\n        .file-info {\n          display: flex;\n          flex-direction: column;\n          gap: 6px;\n          flex: 1;\n        }\n\n        .file-name {\n          font-size: 0.95em;\n          font-weight: 600;\n          color: #1a1a1a;\n        }\n\n        .file-meta {\n          display: flex;\n          gap: 18px;\n          font-size: 0.85em;\n          color: #888;\n        }\n\n        .file-actions {\n          display: flex;\n          gap: 8px;\n        }\n\n        /* Previsualizaci\xf3n modal */\n        .preview-modal {\n          position: fixed;\n          top: 0;\n          left: 0;\n          right: 0;\n          bottom: 0;\n          background: rgba(0, 0, 0, 0.7);\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          z-index: 1000;\n          padding: 20px;\n        }\n\n        .preview-content {\n          background: white;\n          border-radius: 12px;\n          max-width: 95%;\n          max-height: 90%;\n          overflow: hidden;\n          box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\n        }\n\n        .preview-header {\n          display: flex;\n          align-items: center;\n          justify-content: space-between;\n          padding: 20px 25px;\n          background: #f8f9fa;\n          border-bottom: 2px solid #e0e0e0;\n        }\n\n        .preview-header h3 {\n          display: flex;\n          align-items: center;\n          gap: 10px;\n          margin: 0;\n          font-size: 1.3em;\n          color: #1a1a1a;\n        }\n\n        .btn-close {\n          background: #f44336;\n          color: white;\n          border: none;\n          border-radius: 50%;\n          width: 36px;\n          height: 36px;\n          font-size: 1.5em;\n          cursor: pointer;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          transition: all 0.2s;\n        }\n\n        .btn-close:hover {\n          background: #d32f2f;\n          transform: scale(1.1);\n        }\n\n        .preview-table-container {\n          overflow: auto;\n          max-height: calc(90vh - 100px);\n          padding: 20px;\n        }\n\n        .preview-table {\n          width: 100%;\n          border-collapse: collapse;\n          font-size: 0.9em;\n        }\n\n        .preview-table th {\n          background: #4CAF50;\n          color: white;\n          padding: 12px;\n          text-align: left;\n          font-weight: 600;\n          position: sticky;\n          top: 0;\n          z-index: 10;\n        }\n\n        .preview-table td {\n          padding: 12px;\n          border-bottom: 1px solid #e0e0e0;\n        }\n\n        .preview-table tr:hover {\n          background: #f5f5f5;\n        }\n\n        /* Botones mejorados */\n        .btn {\n          padding: 10px 18px;\n          border: none;\n          border-radius: 8px;\n          font-size: 0.9em;\n          font-weight: 600;\n          cursor: pointer;\n          transition: all 0.2s;\n          display: flex;\n          align-items: center;\n          gap: 8px;\n          white-space: nowrap;\n        }\n\n        .btn-icon {\n          padding: 8px;\n          background: none;\n          border: none;\n          cursor: pointer;\n          color: #666;\n          transition: all 0.2s;\n          display: flex;\n          align-items: center;\n          border-radius: 6px;\n        }\n\n        .btn-icon:hover {\n          color: #333;\n          background: rgba(0, 0, 0, 0.05);\n        }\n\n        .btn-preview {\n          background: #2196F3;\n          color: white;\n        }\n\n        .btn-preview:hover {\n          background: #1976D2;\n          box-shadow: 0 4px 8px rgba(33, 150, 243, 0.3);\n        }\n\n        .btn-danger {\n          background: #f44336;\n          color: white;\n        }\n\n        .btn-danger:hover {\n          background: #d32f2f;\n          box-shadow: 0 4px 8px rgba(244, 67, 54, 0.3);\n        }\n\n        .btn-primary {\n          background: #4CAF50;\n          color: white;\n        }\n\n        .btn-primary:hover {\n          background: #45a049;\n          box-shadow: 0 4px 8px rgba(76, 175, 80, 0.3);\n        }\n\n        .btn-secondary {\n          background: #f5f5f5;\n          color: #333;\n          border: 2px solid #e0e0e0;\n        }\n\n        .btn-secondary:hover {\n          background: #e0e0e0;\n          border-color: #ccc;\n        }\n\n        .empty-state {\n          text-align: center;\n          padding: 80px 20px;\n          background: white;\n          border-radius: 12px;\n          box-shadow: 0 2px 8px rgba(0,0,0,0.08);\n        }\n\n        .empty-state-icon {\n          margin: 0 auto 20px;\n          color: #ddd;\n        }\n\n        .empty-state h3 {\n          color: #666;\n          margin-bottom: 10px;\n        }\n\n        .empty-state p {\n          color: #999;\n        }\n\n        .chevron-icon {\n          transition: transform 0.2s;\n        }\n\n        .chevron-icon.expanded {\n          transform: rotate(90deg);\n        }\n\n        @media (max-width: 768px) {\n          .cache-header {\n            flex-direction: column;\n            gap: 15px;\n          }\n\n          .filters-grid {\n            grid-template-columns: 1fr;\n          }\n\n          .cache-stats {\n            grid-template-columns: 1fr;\n          }\n        }\n      "}),(0,y.jsxs)("div",{className:"cache-header",children:[(0,y.jsxs)("div",{className:"cache-title",children:[(0,y.jsx)(w.A,{size:32}),(0,y.jsx)("span",{children:"Gestor de Archivos en Cach\xe9"})]}),(0,y.jsxs)("div",{className:"cache-actions",children:[(0,y.jsx)("button",{className:"btn btn-secondary",onClick:W,children:"Actualizar"}),a&&a.files.length>0&&(0,y.jsxs)("button",{className:"btn btn-danger",onClick:async()=>{if(confirm("\xbfELIMINAR TODOS los archivos del cach\xe9? Esta acci\xf3n no se puede deshacer."))try{await h.q.clearCache(),await W(),null===n||void 0===n||n()}catch(e){console.error("Error clearing cache:",e),alert("Error al limpiar el cach\xe9")}},children:[(0,y.jsx)(O.A,{size:16}),"Limpiar todo"]})]})]}),a&&a.files.length>0&&(0,y.jsxs)("div",{className:"filters-section",children:[(0,y.jsxs)("div",{className:"filters-header",children:[(0,y.jsx)(E.A,{size:20}),(0,y.jsx)("span",{children:"Filtros de B\xfasqueda"})]}),(0,y.jsxs)("div",{className:"filters-grid",children:[(0,y.jsxs)("div",{className:"filter-group",children:[(0,y.jsx)("label",{className:"filter-label",children:"A\xf1o"}),(0,y.jsxs)("select",{className:"filter-select",value:u||"",onChange:e=>x(e.target.value?Number(e.target.value):null),children:[(0,y.jsx)("option",{value:"",children:"Todos los a\xf1os"}),q.map(e=>(0,y.jsx)("option",{value:e,children:e},e))]})]}),(0,y.jsxs)("div",{className:"filter-group",children:[(0,y.jsx)("label",{className:"filter-label",children:"Mes"}),(0,y.jsxs)("select",{className:"filter-select",value:f||"",onChange:e=>b(e.target.value?Number(e.target.value):null),children:[(0,y.jsx)("option",{value:"",children:"Todos los meses"}),B.map(e=>(0,y.jsx)("option",{value:e,children:V[e-1]},e))]})]}),(0,y.jsxs)("div",{className:"filter-group",children:[(0,y.jsx)("label",{className:"filter-label",children:"Tipo de Archivo"}),(0,y.jsxs)("select",{className:"filter-select",value:v||"",onChange:e=>j(e.target.value||null),children:[(0,y.jsx)("option",{value:"",children:"Todos los tipos"}),H.map(e=>(0,y.jsx)("option",{value:e,children:e},e))]})]})]}),(0,y.jsx)("div",{className:"filter-actions",children:(u||f||v)&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("span",{className:"active-filters",children:["Filtros activos: ",[u,f&&V[f-1],v].filter(Boolean).join(" / ")]}),(0,y.jsx)("button",{className:"btn btn-secondary",onClick:()=>{x(null),b(null),j(null)},children:"Limpiar filtros"})]})})]}),m&&(0,y.jsxs)("div",{className:"cache-stats",children:[(0,y.jsxs)("div",{className:"stat-card",children:[(0,y.jsxs)("div",{className:"stat-label",children:[(0,y.jsx)(R.A,{size:20}),"Total de Archivos"]}),(0,y.jsx)("div",{className:"stat-value",children:m.totalFiles})]}),(0,y.jsxs)("div",{className:"stat-card",children:[(0,y.jsxs)("div",{className:"stat-label",children:[(0,y.jsx)(S,{size:20}),"Total de Registros"]}),(0,y.jsx)("div",{className:"stat-value",children:m.totalRecords.toLocaleString()})]}),(0,y.jsxs)("div",{className:"stat-card",children:[(0,y.jsxs)("div",{className:"stat-label",children:[(0,y.jsx)(k,{size:20}),"Tama\xf1o del Cach\xe9"]}),(0,y.jsx)("div",{className:"stat-value",children:X(m.totalSize)})]}),(0,y.jsxs)("div",{className:"stat-card",children:[(0,y.jsxs)("div",{className:"stat-label",children:[(0,y.jsx)(I.A,{size:20}),"Rango de A\xf1os"]}),(0,y.jsx)("div",{className:"stat-value",children:m.yearsList.length>0?"".concat(Math.min(...m.yearsList)," - ").concat(Math.max(...m.yearsList)):"N/A"}),(0,y.jsxs)("div",{className:"stat-subvalue",children:[m.yearsList.length," a\xf1o(s)"]})]})]}),G&&a&&a.files.length>0&&(0,y.jsxs)("div",{className:"consistency-section",children:[(0,y.jsxs)("div",{className:"consistency-header",children:[(0,y.jsx)(T.A,{size:24}),(0,y.jsx)("span",{children:"An\xe1lisis de Consistencia de Datos"})]}),(0,y.jsxs)("div",{className:"consistency-grid",children:[(0,y.jsxs)("div",{className:"consistency-card",children:[(0,y.jsx)("div",{className:"consistency-card-title",children:"Resumen por A\xf1o"}),Object.keys(G.byYear).map(e=>(0,y.jsxs)("div",{className:"consistency-item",children:[(0,y.jsxs)("span",{className:"consistency-label",children:["A\xf1o ",e]}),(0,y.jsxs)("span",{className:"consistency-value",children:[G.byYear[e].totalFiles," archivos / ",G.byYear[e].totalRecords.toLocaleString()," registros"]})]},e))]}),(0,y.jsxs)("div",{className:"consistency-card",children:[(0,y.jsx)("div",{className:"consistency-card-title",children:"Cobertura por Tipo de Archivo"}),Object.keys(G.byType).slice(0,5).map(e=>(0,y.jsxs)("div",{className:"consistency-item",children:[(0,y.jsx)("span",{className:"consistency-label",children:e}),(0,y.jsx)("span",{className:"consistency-value",children:G.byType[e].coverage})]},e))]}),G.trends.length>0&&(0,y.jsxs)("div",{className:"consistency-card",children:[(0,y.jsx)("div",{className:"consistency-card-title",children:"Tendencias"}),G.trends.map((e,n)=>(0,y.jsxs)("div",{className:"trend-card ".concat(e.positive?"":"negative"),children:[(0,y.jsx)(z.A,{size:20}),(0,y.jsxs)("div",{children:[(0,y.jsx)("div",{style:{fontSize:"0.85em",color:"#666"},children:e.description}),(0,y.jsx)("div",{className:"trend-value ".concat(e.positive?"":"negative"),children:e.value})]})]},n))]}),(0,y.jsxs)("div",{className:"consistency-card",children:[(0,y.jsxs)("div",{className:"consistency-card-title",children:[(0,y.jsx)(p.A,{size:18,style:{marginRight:"6px"}}),"Estado de Consistencia"]}),(0,y.jsxs)("div",{className:"consistency-item",children:[(0,y.jsx)("span",{className:"consistency-label",children:"Total de A\xf1os"}),(0,y.jsx)("span",{className:"consistency-value",children:G.totalYears})]}),(0,y.jsxs)("div",{className:"consistency-item",children:[(0,y.jsx)("span",{className:"consistency-label",children:"Meses \xfanicos"}),(0,y.jsx)("span",{className:"consistency-value",children:G.totalMonths})]}),(0,y.jsxs)("div",{className:"consistency-item",children:[(0,y.jsx)("span",{className:"consistency-label",children:"Tipos de archivo"}),(0,y.jsx)("span",{className:"consistency-value",children:Object.keys(G.byType).length})]})]})]})]}),a&&0===a.files.length?(0,y.jsxs)("div",{className:"empty-state",children:[(0,y.jsx)(w.A,{size:64,className:"empty-state-icon"}),(0,y.jsx)("h3",{children:"No hay archivos en cach\xe9"}),(0,y.jsx)("p",{children:"Comienza cargando archivos CSV para organizarlos por a\xf1o y mes"})]}):(0,y.jsx)("div",{className:"files-tree",children:Object.keys(Y).map(Number).sort((e,n)=>n-e).map(e=>{const a=Y[e],t=Object.values(a).reduce((e,n)=>e+Object.values(n).reduce((e,n)=>e+n.length,0),0);return(0,y.jsxs)("div",{className:"year-group",children:[(0,y.jsxs)("div",{className:"year-header",onClick:()=>(e=>{const n=new Set(i);n.has(e)?n.delete(e):n.add(e),o(n)})(e),children:[(0,y.jsxs)("div",{className:"year-info",children:[(0,y.jsx)(D,{size:20,className:"chevron-icon ".concat(i.has(e)?"expanded":"")}),(0,y.jsx)(I.A,{size:20}),(0,y.jsx)("span",{className:"year-title",children:e}),(0,y.jsxs)("span",{className:"year-badge",children:[t," archivos"]})]}),(0,y.jsxs)("div",{className:"year-actions",onClick:e=>e.stopPropagation(),children:[(0,y.jsx)("button",{className:"btn-icon",onClick:()=>$(e),title:"Descargar consolidado del a\xf1o",children:(0,y.jsx)(_,{size:18})}),(0,y.jsx)("button",{className:"btn-icon",onClick:()=>(async e=>{if(confirm("\xbfEliminar todos los archivos del a\xf1o ".concat(e,"?")))try{await h.q.deleteFilesByYear(e),await W(),null===n||void 0===n||n()}catch(a){console.error("Error deleting year:",a),alert("Error al eliminar los archivos del a\xf1o")}})(e),title:"Eliminar todos los archivos del a\xf1o",children:(0,y.jsx)(O.A,{size:18})})]})]}),i.has(e)&&Object.keys(a).map(Number).sort((e,n)=>n-e).map(t=>{const s=a[t],i=Object.values(s).reduce((e,n)=>e+n.length,0),o="".concat(e,"-").concat(t);return(0,y.jsxs)("div",{className:"month-group",children:[(0,y.jsxs)("div",{className:"month-header",onClick:()=>((e,n)=>{const a="".concat(e,"-").concat(n),t=new Set(r);t.has(a)?t.delete(a):t.add(a),l(t)})(e,t),children:[(0,y.jsxs)("div",{className:"month-info",children:[(0,y.jsx)(D,{size:18,className:"chevron-icon ".concat(r.has(o)?"expanded":"")}),(0,y.jsx)("span",{className:"month-title",children:V[t-1]}),(0,y.jsxs)("span",{className:"month-badge",children:[i," archivos"]})]}),(0,y.jsxs)("div",{className:"year-actions",onClick:e=>e.stopPropagation(),children:[(0,y.jsx)("button",{className:"btn-icon",onClick:()=>$(e,t),title:"Descargar consolidado del mes",children:(0,y.jsx)(_,{size:16})}),(0,y.jsx)("button",{className:"btn-icon",onClick:()=>(async(e,a)=>{if(confirm("\xbfEliminar todos los archivos de ".concat(V[a-1]," ").concat(e,"?")))try{await h.q.deleteFilesByMonth(e,a),await W(),null===n||void 0===n||n()}catch(t){console.error("Error deleting month:",t),alert("Error al eliminar los archivos del mes")}})(e,t),title:"Eliminar todos los archivos del mes",children:(0,y.jsx)(O.A,{size:16})})]})]}),r.has(o)&&Object.keys(s).sort().map(a=>{const i=s[a];return(0,y.jsxs)("div",{className:"type-group",children:[(0,y.jsxs)("div",{className:"type-header",children:[(0,y.jsxs)("div",{className:"type-title",children:[(0,y.jsx)(R.A,{size:16}),(0,y.jsx)("span",{children:a}),(0,y.jsxs)("span",{style:{color:"#999",fontSize:"0.9em"},children:["(",i.length,")"]})]}),(0,y.jsx)("button",{className:"btn-icon",onClick:()=>$(e,t,a),title:"Descargar consolidado del tipo",children:(0,y.jsx)(_,{size:14})})]}),(0,y.jsx)("div",{className:"file-list",children:i.map(e=>(0,y.jsxs)("div",{className:"file-item",children:[(0,y.jsxs)("div",{className:"file-info",children:[(0,y.jsx)("div",{className:"file-name",children:e.fileName}),(0,y.jsxs)("div",{className:"file-meta",children:[(0,y.jsxs)("span",{children:[e.recordCount.toLocaleString()," registros"]}),(0,y.jsx)("span",{children:X(e.size)}),(0,y.jsx)("span",{children:new Date(e.uploadDate).toLocaleDateString()})]})]}),(0,y.jsxs)("div",{className:"file-actions",children:[(0,y.jsxs)("button",{className:"btn btn-preview",onClick:()=>(async e=>{L(!0);try{const n=await h.q.getFile(e);n&&n.data&&(F(n.data.slice(0,5)),C(e))}catch(n){console.error("Error loading preview:",n),alert("Error al cargar la previsualizaci\xf3n")}finally{L(!1)}})(e.id),title:"Previsualizar datos",children:[(0,y.jsx)(A,{size:16}),"Ver datos"]}),(0,y.jsx)("button",{className:"btn-icon",onClick:()=>(async e=>{if(confirm("\xbfEst\xe1s seguro de que deseas eliminar este archivo?"))try{await h.q.deleteFile(e),await W(),null===n||void 0===n||n()}catch(a){console.error("Error deleting file:",a),alert("Error al eliminar el archivo")}})(e.id),title:"Eliminar archivo",children:(0,y.jsx)(O.A,{size:16})})]})]},e.id))})]},a)})]},o)})]},e)})}),N&&(()=>{if(!M||0===M.length)return null;const e=Object.keys(M[0]);return(0,y.jsx)("div",{className:"preview-modal",children:(0,y.jsxs)("div",{className:"preview-content",children:[(0,y.jsxs)("div",{className:"preview-header",children:[(0,y.jsxs)("h3",{children:[(0,y.jsx)(A,{size:20}),"Previsualizaci\xf3n de Datos (Primeras 5 filas)"]}),(0,y.jsx)("button",{className:"btn-close",onClick:J,children:"\xd7"})]}),(0,y.jsx)("div",{className:"preview-table-container",children:(0,y.jsxs)("table",{className:"preview-table",children:[(0,y.jsx)("thead",{children:(0,y.jsx)("tr",{children:e.map((e,n)=>(0,y.jsx)("th",{children:e},n))})}),(0,y.jsx)("tbody",{children:M.map((n,a)=>(0,y.jsx)("tr",{children:e.map((e,a)=>(0,y.jsx)("td",{children:n[e]},a))},a))})]})})]})})})(),P&&(0,y.jsx)("div",{className:"preview-modal",children:(0,y.jsx)("div",{style:{color:"white",fontSize:"1.2em"},children:"Cargando previsualizaci\xf3n..."})})]})};var q=a(9318);const B=()=>{const[e,n]=(0,t.useState)(!1),[a,i]=(0,t.useState)(null),o=(0,t.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(!0),i(null);try{return await U.consolidateData(e)}catch(a){const e=a instanceof Error?a:new Error("Error consolidating data");throw i(e),e}finally{n(!1)}},[]),r=(0,t.useCallback)(async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o((0,s.A)((0,s.A)({},n),{},{types:[e]}))},[o]),l=(0,t.useCallback)(async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o((0,s.A)((0,s.A)({},n),{},{years:[e]}))},[o]),c=(0,t.useCallback)(async function(e,n){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return o((0,s.A)((0,s.A)({},a),{},{years:[e],months:[n]}))},[o]),d=(0,t.useCallback)(async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n(!0),i(null);try{await U.downloadConsolidatedCSV(e,a)}catch(t){const e=t instanceof Error?t:new Error("Error downloading CSV");throw i(e),e}finally{n(!1)}},[]),p=(0,t.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(!0),i(null);try{return await U.getConsolidatedStats(e)}catch(a){const e=a instanceof Error?a:new Error("Error getting stats");throw i(e),e}finally{n(!1)}},[]);return{loading:e,error:a,consolidate:o,consolidateByType:r,consolidateByYear:l,consolidateByMonth:c,downloadCSV:d,getStats:p}},H=["Contratos","Proveedores_unido","LineasContratadas","LineasAdjudicadas","Ofertas","ProcedimientoAdjudicacion","InstitucionesRegistradas"],Y=()=>{const{consolidate:e,downloadCSV:n,loading:a}=B(),i=(new Date).getFullYear(),[o,r]=(0,t.useState)({years:[i],months:[],types:[],deduplicateBy:"",sortBy:"",sortOrder:"asc"}),[l,c]=(0,t.useState)(null),d=Array.from({length:10},(e,n)=>i-n);return(0,y.jsxs)("div",{className:"advanced-consolidation",children:[(0,y.jsx)("style",{children:"\n        .advanced-consolidation {\n          max-width: 1400px;\n          margin: 0 auto;\n          padding: 30px;\n        }\n\n        .page-header {\n          display: flex;\n          align-items: center;\n          gap: 15px;\n          margin-bottom: 30px;\n        }\n\n        .page-title {\n          font-size: 2em;\n          font-weight: 700;\n          color: #333;\n        }\n\n        .filters-container {\n          display: grid;\n          grid-template-columns: 300px 1fr;\n          gap: 30px;\n        }\n\n        .filters-panel {\n          background: white;\n          border-radius: 8px;\n          padding: 25px;\n          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\n          height: fit-content;\n          position: sticky;\n          top: 20px;\n        }\n\n        .filter-section {\n          margin-bottom: 25px;\n        }\n\n        .filter-section:last-child {\n          margin-bottom: 0;\n        }\n\n        .filter-title {\n          font-size: 1.1em;\n          font-weight: 600;\n          color: #333;\n          margin-bottom: 15px;\n          display: flex;\n          align-items: center;\n          gap: 8px;\n        }\n\n        .checkbox-group {\n          display: flex;\n          flex-direction: column;\n          gap: 10px;\n        }\n\n        .checkbox-item {\n          display: flex;\n          align-items: center;\n          gap: 10px;\n          padding: 8px;\n          border-radius: 4px;\n          transition: background 0.2s;\n        }\n\n        .checkbox-item:hover {\n          background: #f5f5f5;\n        }\n\n        .checkbox-input {\n          width: 18px;\n          height: 18px;\n          cursor: pointer;\n        }\n\n        .checkbox-label {\n          flex: 1;\n          cursor: pointer;\n          user-select: none;\n        }\n\n        .input-field {\n          width: 100%;\n          padding: 10px 12px;\n          border: 1px solid #ddd;\n          border-radius: 6px;\n          font-size: 0.95em;\n          margin-top: 8px;\n        }\n\n        .input-field:focus {\n          outline: none;\n          border-color: #667eea;\n        }\n\n        .select-field {\n          width: 100%;\n          padding: 10px 12px;\n          border: 1px solid #ddd;\n          border-radius: 6px;\n          font-size: 0.95em;\n          margin-top: 8px;\n          background: white;\n        }\n\n        .select-field:focus {\n          outline: none;\n          border-color: #667eea;\n        }\n\n        .action-buttons {\n          display: flex;\n          flex-direction: column;\n          gap: 10px;\n          margin-top: 25px;\n        }\n\n        .btn {\n          width: 100%;\n          padding: 12px 20px;\n          border: none;\n          border-radius: 6px;\n          font-size: 1em;\n          font-weight: 500;\n          cursor: pointer;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          gap: 8px;\n          transition: all 0.2s;\n        }\n\n        .btn-primary {\n          background: #667eea;\n          color: white;\n        }\n\n        .btn-primary:hover:not(:disabled) {\n          background: #5568d3;\n        }\n\n        .btn-secondary {\n          background: #4CAF50;\n          color: white;\n        }\n\n        .btn-secondary:hover:not(:disabled) {\n          background: #45a049;\n        }\n\n        .btn:disabled {\n          background: #ccc;\n          cursor: not-allowed;\n        }\n\n        .results-panel {\n          background: white;\n          border-radius: 8px;\n          padding: 25px;\n          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\n        }\n\n        .results-header {\n          display: flex;\n          align-items: center;\n          justify-content: space-between;\n          margin-bottom: 25px;\n          padding-bottom: 15px;\n          border-bottom: 2px solid #f0f0f0;\n        }\n\n        .results-title {\n          font-size: 1.3em;\n          font-weight: 600;\n          color: #333;\n          display: flex;\n          align-items: center;\n          gap: 10px;\n        }\n\n        .stats-grid {\n          display: grid;\n          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n          gap: 20px;\n        }\n\n        .stat-card {\n          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n          color: white;\n          padding: 20px;\n          border-radius: 8px;\n          box-shadow: 0 4px 6px rgba(102, 126, 234, 0.3);\n        }\n\n        .stat-label {\n          font-size: 0.9em;\n          opacity: 0.9;\n          margin-bottom: 8px;\n        }\n\n        .stat-value {\n          font-size: 2em;\n          font-weight: 700;\n        }\n\n        .stat-subvalue {\n          font-size: 0.85em;\n          opacity: 0.8;\n          margin-top: 5px;\n        }\n\n        .empty-results {\n          text-align: center;\n          padding: 60px 20px;\n          color: #999;\n        }\n\n        .badge {\n          display: inline-block;\n          padding: 4px 12px;\n          background: #667eea;\n          color: white;\n          border-radius: 12px;\n          font-size: 0.85em;\n          font-weight: 500;\n        }\n      "}),(0,y.jsxs)("div",{className:"page-header",children:[(0,y.jsx)(q.A,{size:32,color:"#667eea"}),(0,y.jsx)("h1",{className:"page-title",children:"Consolidaci\xf3n Avanzada"})]}),(0,y.jsxs)("div",{className:"filters-container",children:[(0,y.jsxs)("div",{className:"filters-panel",children:[(0,y.jsxs)("div",{className:"filter-section",children:[(0,y.jsxs)("div",{className:"filter-title",children:[(0,y.jsx)(E.A,{size:18}),"A\xf1os"]}),(0,y.jsx)("div",{className:"checkbox-group",children:d.map(e=>(0,y.jsxs)("label",{className:"checkbox-item",children:[(0,y.jsx)("input",{type:"checkbox",className:"checkbox-input",checked:o.years.includes(e),onChange:()=>(e=>{r(n=>(0,s.A)((0,s.A)({},n),{},{years:n.years.includes(e)?n.years.filter(n=>n!==e):[...n.years,e]}))})(e)}),(0,y.jsx)("span",{className:"checkbox-label",children:e})]},e))})]}),(0,y.jsxs)("div",{className:"filter-section",children:[(0,y.jsx)("div",{className:"filter-title",children:"Meses"}),(0,y.jsx)("div",{className:"checkbox-group",children:[{value:1,label:"Enero"},{value:2,label:"Febrero"},{value:3,label:"Marzo"},{value:4,label:"Abril"},{value:5,label:"Mayo"},{value:6,label:"Junio"},{value:7,label:"Julio"},{value:8,label:"Agosto"},{value:9,label:"Septiembre"},{value:10,label:"Octubre"},{value:11,label:"Noviembre"},{value:12,label:"Diciembre"}].map(e=>(0,y.jsxs)("label",{className:"checkbox-item",children:[(0,y.jsx)("input",{type:"checkbox",className:"checkbox-input",checked:o.months.includes(e.value),onChange:()=>(e=>{r(n=>(0,s.A)((0,s.A)({},n),{},{months:n.months.includes(e)?n.months.filter(n=>n!==e):[...n.months,e]}))})(e.value)}),(0,y.jsx)("span",{className:"checkbox-label",children:e.label})]},e.value))})]}),(0,y.jsxs)("div",{className:"filter-section",children:[(0,y.jsx)("div",{className:"filter-title",children:"Tipos de Archivo"}),(0,y.jsx)("div",{className:"checkbox-group",children:H.map(e=>(0,y.jsxs)("label",{className:"checkbox-item",children:[(0,y.jsx)("input",{type:"checkbox",className:"checkbox-input",checked:o.types.includes(e),onChange:()=>(e=>{r(n=>(0,s.A)((0,s.A)({},n),{},{types:n.types.includes(e)?n.types.filter(n=>n!==e):[...n.types,e]}))})(e)}),(0,y.jsx)("span",{className:"checkbox-label",children:e})]},e))})]}),(0,y.jsxs)("div",{className:"filter-section",children:[(0,y.jsx)("div",{className:"filter-title",children:"Deduplicar por campo"}),(0,y.jsx)("input",{type:"text",className:"input-field",placeholder:"ej: id, codigo, etc.",value:o.deduplicateBy,onChange:e=>r(n=>(0,s.A)((0,s.A)({},n),{},{deduplicateBy:e.target.value}))})]}),(0,y.jsxs)("div",{className:"filter-section",children:[(0,y.jsx)("div",{className:"filter-title",children:"Ordenar por"}),(0,y.jsx)("input",{type:"text",className:"input-field",placeholder:"Nombre del campo",value:o.sortBy,onChange:e=>r(n=>(0,s.A)((0,s.A)({},n),{},{sortBy:e.target.value}))}),(0,y.jsxs)("select",{className:"select-field",value:o.sortOrder,onChange:e=>r(n=>(0,s.A)((0,s.A)({},n),{},{sortOrder:e.target.value})),children:[(0,y.jsx)("option",{value:"asc",children:"Ascendente"}),(0,y.jsx)("option",{value:"desc",children:"Descendente"})]})]}),(0,y.jsxs)("div",{className:"action-buttons",children:[(0,y.jsxs)("button",{className:"btn btn-primary",onClick:async()=>{try{const n={};o.years.length>0&&(n.years=o.years),o.months.length>0&&(n.months=o.months),o.types.length>0&&(n.types=o.types),o.deduplicateBy&&(n.deduplicateBy=o.deduplicateBy),o.sortBy&&(n.sortBy=o.sortBy,n.sortOrder=o.sortOrder);const a=await e(n);c(a)}catch(n){console.error("Error consolidating:",n),alert("Error al consolidar datos")}},disabled:a||0===o.years.length,children:[(0,y.jsx)(z.A,{size:18}),a?"Consolidando...":"Consolidar"]}),(0,y.jsxs)("button",{className:"btn btn-secondary",onClick:async()=>{try{const e={};o.years.length>0&&(e.years=o.years),o.months.length>0&&(e.months=o.months),o.types.length>0&&(e.types=o.types);const a="consolidado_".concat(o.years.join("-"),"_").concat(Date.now(),".csv");await n(a,e)}catch(e){console.error("Error downloading:",e),alert("Error al descargar archivo")}},disabled:a||0===o.years.length,children:[(0,y.jsx)(_,{size:18}),"Descargar CSV"]})]})]}),(0,y.jsx)("div",{className:"results-panel",children:l?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{className:"results-header",children:[(0,y.jsxs)("div",{className:"results-title",children:[(0,y.jsx)(z.A,{size:24}),"Resultados"]}),(0,y.jsxs)("span",{className:"badge",children:[l.metadata.filesIncluded," archivos"]})]}),(0,y.jsxs)("div",{className:"stats-grid",children:[(0,y.jsxs)("div",{className:"stat-card",children:[(0,y.jsx)("div",{className:"stat-label",children:"Total de Registros"}),(0,y.jsx)("div",{className:"stat-value",children:l.metadata.totalRecords.toLocaleString()})]}),(0,y.jsxs)("div",{className:"stat-card",children:[(0,y.jsx)("div",{className:"stat-label",children:"Rango de A\xf1os"}),(0,y.jsxs)("div",{className:"stat-value",children:[l.metadata.yearRange.min," - ",l.metadata.yearRange.max]})]}),(0,y.jsxs)("div",{className:"stat-card",children:[(0,y.jsx)("div",{className:"stat-label",children:"Rango de Meses"}),(0,y.jsxs)("div",{className:"stat-value",children:[l.metadata.monthRange.min," - ",l.metadata.monthRange.max]})]}),(0,y.jsxs)("div",{className:"stat-card",children:[(0,y.jsx)("div",{className:"stat-label",children:"Tipos Incluidos"}),(0,y.jsx)("div",{className:"stat-value",children:l.metadata.types.length}),(0,y.jsx)("div",{className:"stat-subvalue",children:l.metadata.types.join(", ")})]})]})]}):(0,y.jsxs)("div",{className:"empty-results",children:[(0,y.jsx)(E.A,{size:64,style:{margin:"0 auto 20px",color:"#ddd"}}),(0,y.jsx)("h3",{children:"Sin resultados"}),(0,y.jsx)("p",{children:'Selecciona filtros y haz clic en "Consolidar" para ver los resultados'})]})})]})]})};var G=a(5924);const W=(0,l.A)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),J=(0,l.A)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),$=(0,l.A)("calendar-check",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]),X=()=>{const[e,n]=(0,t.useState)(null),[a,s]=(0,t.useState)(!0),[i,o]=(0,t.useState)(new Set),[r,l]=(0,t.useState)(""),[c,d]=(0,t.useState)(""),h=(0,t.useCallback)(async()=>{s(!0);try{const e=await v.analyzeAllFiles(r,c);n(e)}catch(e){console.error("Error analyzing files:",e)}finally{s(!1)}},[r,c]);(0,t.useEffect)(()=>{h()},[h]);const g=e=>{switch(e){case"error":return(0,y.jsx)(p.A,{size:16,color:"#d32f2f"});case"warning":return(0,y.jsx)(G.A,{size:16,color:"#f57c00"});case"info":return(0,y.jsx)(W,{size:16,color:"#1976d2"});default:return null}};if(a)return(0,y.jsxs)("div",{className:"validation-report loading",children:[(0,y.jsx)(J,{className:"spinner",size:32}),(0,y.jsx)("p",{children:"Analizando archivos..."})]});if(!e)return(0,y.jsxs)("div",{className:"validation-report error",children:[(0,y.jsx)(p.A,{size:48}),(0,y.jsx)("p",{children:"No se pudo cargar el an\xe1lisis de validaci\xf3n"})]});const x=e.groupSummaries||[],f=e.yearCoverage||[],b=f.length,j=f.reduce((e,n)=>e+n.monthsWithData,0),N=12*b,C=Math.max(N-j,0),A=N>0?j/N*100:0,w=f[0]||null,O=x.length>0,E=f.length>0;return(0,y.jsxs)("div",{className:"validation-report",children:[(0,y.jsx)("style",{children:"\n        .validation-report {\n          max-width: 1400px;\n          margin: 0 auto;\n          padding: 20px;\n        }\n\n        .validation-report.loading,\n        .validation-report.error {\n          display: flex;\n          flex-direction: column;\n          align-items: center;\n          justify-content: center;\n          min-height: 400px;\n          color: #666;\n        }\n\n        .spinner {\n          animation: spin 1s linear infinite;\n        }\n\n        @keyframes spin {\n          from { transform: rotate(0deg); }\n          to { transform: rotate(360deg); }\n        }\n\n        .report-header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          margin-bottom: 30px;\n          padding-bottom: 20px;\n          border-bottom: 2px solid #e0e0e0;\n        }\n\n        .report-title {\n          font-size: 1.8em;\n          font-weight: 700;\n          color: #333;\n          display: flex;\n          align-items: center;\n          gap: 12px;\n        }\n\n        .report-actions {\n          display: flex;\n          gap: 10px;\n        }\n\n        .btn {\n          padding: 10px 20px;\n          border: none;\n          border-radius: 6px;\n          font-size: 0.95em;\n          cursor: pointer;\n          display: flex;\n          align-items: center;\n          gap: 8px;\n          transition: all 0.2s;\n        }\n\n        .btn-primary {\n          background: #667eea;\n          color: white;\n        }\n\n        .btn-primary:hover {\n          background: #5568d3;\n        }\n\n        .btn-secondary {\n          background: #f5f5f5;\n          color: #333;\n        }\n\n        .btn-secondary:hover {\n          background: #e0e0e0;\n        }\n\n        .date-filters-section {\n          background: #f0f4ff;\n          border: 1px solid #d0dff5;\n          border-radius: 8px;\n          padding: 20px;\n          margin-bottom: 30px;\n        }\n\n        .filter-title {\n          font-size: 1.1em;\n          font-weight: 600;\n          color: #1976d2;\n          margin-bottom: 15px;\n          display: flex;\n          align-items: center;\n          gap: 8px;\n        }\n\n        .filters-container {\n          display: flex;\n          gap: 20px;\n          align-items: flex-end;\n          flex-wrap: wrap;\n        }\n\n        .filter-group {\n          display: flex;\n          flex-direction: column;\n          gap: 8px;\n        }\n\n        .filter-group label {\n          font-size: 0.9em;\n          font-weight: 500;\n          color: #333;\n        }\n\n        .filter-select {\n          padding: 10px 15px;\n          border: 1px solid #ccc;\n          border-radius: 6px;\n          font-size: 0.95em;\n          min-width: 180px;\n          background: white;\n          cursor: pointer;\n          transition: border-color 0.2s;\n        }\n\n        .filter-select:hover {\n          border-color: #667eea;\n        }\n\n        .filter-select:focus {\n          outline: none;\n          border-color: #667eea;\n          box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);\n        }\n\n        .btn-clear-filters {\n          padding: 10px 20px;\n          background: #f57c00;\n          color: white;\n          border: none;\n          border-radius: 6px;\n          font-size: 0.9em;\n          cursor: pointer;\n          transition: background 0.2s;\n        }\n\n        .btn-clear-filters:hover {\n          background: #e65100;\n        }\n\n        .active-filters-info {\n          margin-top: 15px;\n          padding: 12px;\n          background: white;\n          border-radius: 6px;\n          border-left: 4px solid #1976d2;\n          font-size: 0.95em;\n          color: #333;\n          font-weight: 500;\n        }\n\n        .summary-section {\n          display: grid;\n          grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));\n          gap: 20px;\n          margin-bottom: 30px;\n        }\n\n        .summary-card {\n          background: white;\n          border-radius: 8px;\n          padding: 25px;\n          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\n          border-left: 4px solid #667eea;\n        }\n\n        .summary-card.warning {\n          border-left-color: #f57c00;\n        }\n\n        .summary-card.error {\n          border-left-color: #d32f2f;\n        }\n\n        .summary-card.success {\n          border-left-color: #4CAF50;\n        }\n\n        .summary-label {\n          font-size: 0.9em;\n          color: #666;\n          margin-bottom: 10px;\n          display: flex;\n          align-items: center;\n          gap: 8px;\n        }\n\n        .summary-value {\n          font-size: 2.5em;\n          font-weight: 700;\n          color: #333;\n        }\n\n        .summary-subvalue {\n          font-size: 0.85em;\n          color: #999;\n          margin-top: 5px;\n        }\n\n        .completeness-bar {\n          width: 100%;\n          height: 8px;\n          background: #e0e0e0;\n          border-radius: 4px;\n          overflow: hidden;\n          margin-top: 10px;\n        }\n\n        .completeness-fill {\n          height: 100%;\n          background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);\n          transition: width 0.3s;\n        }\n\n        .missing-files-section {\n          background: #fff9e6;\n          border-left: 4px solid #f57c00;\n          padding: 20px;\n          border-radius: 8px;\n          margin-bottom: 30px;\n        }\n\n        .missing-files-title {\n          font-size: 1.2em;\n          font-weight: 600;\n          color: #f57c00;\n          margin-bottom: 15px;\n          display: flex;\n          align-items: center;\n          gap: 10px;\n        }\n\n        .missing-files-grid {\n          display: grid;\n          grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));\n          gap: 15px;\n        }\n\n        .missing-file-item {\n          background: white;\n          padding: 15px;\n          border-radius: 6px;\n          border: 1px solid #ffe0b2;\n        }\n\n        .missing-file-type {\n          font-weight: 600;\n          color: #333;\n          margin-bottom: 5px;\n        }\n\n        .missing-file-desc {\n          font-size: 0.9em;\n          color: #666;\n        }\n\n        .recommendations-section {\n          background: #e3f2fd;\n          border-left: 4px solid #1976d2;\n          padding: 20px;\n          border-radius: 8px;\n          margin-bottom: 30px;\n        }\n\n        .recommendations-title {\n          font-size: 1.2em;\n          font-weight: 600;\n          color: #1976d2;\n          margin-bottom: 15px;\n          display: flex;\n          align-items: center;\n          gap: 10px;\n        }\n\n        .recommendation-item {\n          background: white;\n          padding: 12px 15px;\n          border-radius: 6px;\n          margin-bottom: 10px;\n          display: flex;\n          align-items: start;\n          gap: 10px;\n        }\n\n        .recommendation-number {\n          background: #1976d2;\n          color: white;\n          width: 24px;\n          height: 24px;\n          border-radius: 50%;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          font-size: 0.85em;\n          font-weight: 600;\n          flex-shrink: 0;\n        }\n\n        .files-validation-section {\n          background: white;\n          border-radius: 8px;\n          padding: 25px;\n          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\n        }\n\n        .section-title {\n          font-size: 1.3em;\n          font-weight: 600;\n          color: #333;\n          margin-bottom: 20px;\n        }\n\n        .file-validation-item {\n          border: 1px solid #e0e0e0;\n          border-radius: 8px;\n          margin-bottom: 15px;\n          overflow: hidden;\n        }\n\n        .file-validation-header {\n          padding: 15px 20px;\n          background: #f8f9fa;\n          display: flex;\n          align-items: center;\n          justify-content: space-between;\n          cursor: pointer;\n          transition: background 0.2s;\n        }\n\n        .file-validation-header:hover {\n          background: #e9ecef;\n        }\n\n        .file-header-left {\n          display: flex;\n          align-items: center;\n          gap: 12px;\n          flex: 1;\n        }\n\n        .file-status-icon {\n          flex-shrink: 0;\n        }\n\n        .file-name {\n          font-weight: 500;\n          color: #333;\n        }\n\n        .file-type-badge {\n          background: #667eea;\n          color: white;\n          padding: 3px 10px;\n          border-radius: 12px;\n          font-size: 0.85em;\n        }\n\n        .file-stats {\n          display: flex;\n          gap: 20px;\n          font-size: 0.9em;\n          color: #666;\n        }\n\n        .file-validation-details {\n          padding: 20px;\n          background: white;\n          border-top: 1px solid #e0e0e0;\n        }\n\n        .stats-grid {\n          display: grid;\n          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n          gap: 15px;\n          margin-bottom: 20px;\n        }\n\n        .stat-item {\n          background: #f8f9fa;\n          padding: 15px;\n          border-radius: 6px;\n        }\n\n        .stat-label {\n          font-size: 0.85em;\n          color: #666;\n          margin-bottom: 5px;\n        }\n\n        .stat-value {\n          font-size: 1.3em;\n          font-weight: 600;\n          color: #333;\n        }\n\n        .issues-list {\n          margin-top: 15px;\n        }\n\n        .issue-item {\n          display: flex;\n          align-items: start;\n          gap: 10px;\n          padding: 12px;\n          margin-bottom: 8px;\n          border-radius: 6px;\n          background: #f8f9fa;\n          border-left: 3px solid #ccc;\n        }\n\n        .issue-item.error {\n          background: #ffebee;\n          border-left-color: #d32f2f;\n        }\n\n        .issue-item.warning {\n          background: #fff9e6;\n          border-left-color: #f57c00;\n        }\n\n        .issue-item.info {\n          background: #e3f2fd;\n          border-left-color: #1976d2;\n        }\n\n        .issue-message {\n          flex: 1;\n          font-size: 0.95em;\n        }\n\n        .issue-field-tag {\n          display: inline-block;\n          background: rgba(0,0,0,0.1);\n          padding: 2px 8px;\n          border-radius: 4px;\n          font-size: 0.85em;\n          font-family: monospace;\n          margin-top: 5px;\n        }\n\n        .coverage-grid {\n          display: grid;\n          grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));\n          gap: 15px;\n        }\n\n        .coverage-item {\n          background: #f8f9fa;\n          padding: 12px;\n          border-radius: 6px;\n        }\n\n        .coverage-field {\n          font-size: 0.9em;\n          color: #666;\n          margin-bottom: 8px;\n        }\n\n        .coverage-bar-container {\n          background: #e0e0e0;\n          height: 6px;\n          border-radius: 3px;\n          overflow: hidden;\n        }\n\n        .coverage-bar-fill {\n          height: 100%;\n          background: #4CAF50;\n          transition: width 0.3s;\n        }\n\n        .coverage-bar-fill.low {\n          background: #d32f2f;\n        }\n\n        .coverage-bar-fill.medium {\n          background: #f57c00;\n        }\n\n        .coverage-percentage {\n          font-size: 0.85em;\n          color: #666;\n          margin-top: 5px;\n        }\n\n        .group-coverage-section,\n        .year-coverage-section {\n          background: white;\n          border-radius: 8px;\n          padding: 25px;\n          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\n          margin-bottom: 30px;\n        }\n\n        .coverage-table {\n          width: 100%;\n          border-collapse: collapse;\n          margin-top: 15px;\n        }\n\n        .coverage-table th,\n        .coverage-table td {\n          padding: 12px 15px;\n          border-bottom: 1px solid #e0e0e0;\n          text-align: left;\n          font-size: 0.95em;\n        }\n\n        .coverage-table th {\n          background: #f8f9fa;\n          font-weight: 600;\n          color: #333;\n        }\n\n        .coverage-table tr:last-child td {\n          border-bottom: none;\n        }\n\n        .chip-list {\n          display: flex;\n          flex-wrap: wrap;\n          gap: 6px;\n          margin-top: 6px;\n        }\n\n        .chip {\n          background: #f0f4ff;\n          color: #3f51b5;\n          padding: 4px 10px;\n          border-radius: 12px;\n          font-size: 0.85em;\n        }\n\n        .chip-empty {\n          background: #ffebee;\n          color: #c62828;\n        }\n\n        .chip-warning {\n          background: #fff8e1;\n          color: #ef6c00;\n        }\n\n        .chip-ok {\n          background: #e8f5e9;\n          color: #2e7d32;\n        }\n\n        .count-label {\n          font-weight: 600;\n          color: #333;\n        }\n\n        .group-badge {\n          display: inline-flex;\n          align-items: center;\n          gap: 6px;\n          background: #eef2ff;\n          color: #3f51b5;\n          padding: 4px 10px;\n          border-radius: 12px;\n          font-size: 0.75em;\n          margin-left: 8px;\n        }\n\n        .progress-badge {\n          display: inline-flex;\n          align-items: center;\n          gap: 8px;\n        }\n\n        .progress-meter {\n          width: 120px;\n          height: 8px;\n          background: #e0e0e0;\n          border-radius: 4px;\n          overflow: hidden;\n        }\n\n        .progress-fill {\n          height: 100%;\n          background: linear-gradient(90deg, #42a5f5 0%, #1e88e5 100%);\n        }\n      "}),(0,y.jsxs)("div",{className:"report-header",children:[(0,y.jsxs)("h2",{className:"report-title",children:[(0,y.jsx)(R.A,{size:28}),"Reporte de Validaci\xf3n"]}),(0,y.jsxs)("div",{className:"report-actions",children:[(0,y.jsxs)("button",{className:"btn btn-secondary",onClick:h,children:[(0,y.jsx)(J,{size:18}),"Actualizar"]}),(0,y.jsxs)("button",{className:"btn btn-primary",onClick:async()=>{try{const e=await v.generateValidationReport(),n=new Blob([e],{type:"text/plain"}),a=URL.createObjectURL(n),t=document.createElement("a");t.href=a,t.download="validation_report_".concat((new Date).toISOString().split("T")[0],".txt"),t.click(),URL.revokeObjectURL(a)}catch(e){console.error("Error downloading report:",e)}},children:[(0,y.jsx)(_,{size:18}),"Descargar Reporte"]})]})]}),(0,y.jsxs)("div",{className:"date-filters-section",children:[(0,y.jsxs)("h3",{className:"filter-title",children:[(0,y.jsx)(W,{size:20}),"Filtrar por Per\xedodo de Carga (LITES)"]}),(0,y.jsxs)("div",{className:"filters-container",children:[(0,y.jsxs)("div",{className:"filter-group",children:[(0,y.jsx)("label",{htmlFor:"month-select",children:"Mes:"}),(0,y.jsxs)("select",{id:"month-select",className:"filter-select",value:r,onChange:e=>l(e.target.value),children:[(0,y.jsx)("option",{value:"",children:"Todos los meses"}),(0,y.jsx)("option",{value:"01",children:"Enero"}),(0,y.jsx)("option",{value:"02",children:"Febrero"}),(0,y.jsx)("option",{value:"03",children:"Marzo"}),(0,y.jsx)("option",{value:"04",children:"Abril"}),(0,y.jsx)("option",{value:"05",children:"Mayo"}),(0,y.jsx)("option",{value:"06",children:"Junio"}),(0,y.jsx)("option",{value:"07",children:"Julio"}),(0,y.jsx)("option",{value:"08",children:"Agosto"}),(0,y.jsx)("option",{value:"09",children:"Septiembre"}),(0,y.jsx)("option",{value:"10",children:"Octubre"}),(0,y.jsx)("option",{value:"11",children:"Noviembre"}),(0,y.jsx)("option",{value:"12",children:"Diciembre"})]})]}),(0,y.jsxs)("div",{className:"filter-group",children:[(0,y.jsx)("label",{htmlFor:"year-select",children:"A\xf1o:"}),(0,y.jsxs)("select",{id:"year-select",className:"filter-select",value:c,onChange:e=>d(e.target.value),children:[(0,y.jsx)("option",{value:"",children:"Todos los a\xf1os"}),Array.from({length:10},(e,n)=>2025-n).map(e=>(0,y.jsx)("option",{value:e.toString(),children:e},e))]})]}),(r||c)&&(0,y.jsx)("button",{className:"btn btn-clear-filters",onClick:()=>{l(""),d("")},children:"Limpiar filtros"})]}),(r||c)&&(0,y.jsxs)("div",{className:"active-filters-info",children:["Mostrando datos de: ",r?"".concat(["","Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][parseInt(r)]):"Todos los meses",c?" ".concat(c):""]})]}),(0,y.jsxs)("div",{className:"summary-section",children:[(0,y.jsxs)("div",{className:"summary-card",children:[(0,y.jsxs)("div",{className:"summary-label",children:[(0,y.jsx)(R.A,{size:18}),"Total de Archivos"]}),(0,y.jsx)("div",{className:"summary-value",children:e.totalFiles}),(0,y.jsx)("div",{className:"summary-subvalue",children:"Archivos analizados"})]}),(0,y.jsxs)("div",{className:"summary-card success",children:[(0,y.jsxs)("div",{className:"summary-label",children:[(0,y.jsx)(m.A,{size:18}),"Archivos V\xe1lidos"]}),(0,y.jsx)("div",{className:"summary-value",children:e.validFiles}),(0,y.jsx)("div",{className:"summary-subvalue",children:e.totalFiles>0?"".concat((e.validFiles/e.totalFiles*100).toFixed(1),"% sin errores"):"No hay archivos"})]}),(0,y.jsxs)("div",{className:"summary-card error",children:[(0,y.jsxs)("div",{className:"summary-label",children:[(0,y.jsx)(p.A,{size:18}),"Con Errores"]}),(0,y.jsx)("div",{className:"summary-value",children:e.filesWithErrors}),(0,y.jsx)("div",{className:"summary-subvalue",children:"Requieren correcci\xf3n"})]}),(0,y.jsxs)("div",{className:"summary-card warning",children:[(0,y.jsxs)("div",{className:"summary-label",children:[(0,y.jsx)(G.A,{size:18}),"Con Advertencias"]}),(0,y.jsx)("div",{className:"summary-value",children:e.filesWithWarnings}),(0,y.jsx)("div",{className:"summary-subvalue",children:"Revisar datos"})]}),(0,y.jsxs)("div",{className:"summary-card",children:[(0,y.jsxs)("div",{className:"summary-label",children:[(0,y.jsx)(z.A,{size:18}),"Completitud"]}),(0,y.jsxs)("div",{className:"summary-value",children:[e.completeness.toFixed(1),"%"]}),(0,y.jsx)("div",{className:"completeness-bar",children:(0,y.jsx)("div",{className:"completeness-fill",style:{width:"".concat(e.completeness,"%")}})}),(0,y.jsxs)("div",{className:"summary-subvalue",children:[e.totalFiles," de ",u.length," tipos"]})]}),(0,y.jsxs)("div",{className:"summary-card",children:[(0,y.jsxs)("div",{className:"summary-label",children:[(0,y.jsx)(I.A,{size:18}),"A\xf1os con datos"]}),(0,y.jsx)("div",{className:"summary-value",children:b}),(0,y.jsx)("div",{className:"summary-subvalue",children:w?"\xdaltimo a\xf1o: ".concat(w.year):"Sin registros disponibles"})]}),(0,y.jsxs)("div",{className:"summary-card",children:[(0,y.jsxs)("div",{className:"summary-label",children:[(0,y.jsx)($,{size:18}),"Cobertura mensual"]}),(0,y.jsxs)("div",{className:"summary-value",children:[A.toFixed(1),"%"]}),(0,y.jsx)("div",{className:"summary-subvalue",children:N>0?"".concat(j," de ").concat(N," meses con datos (").concat(C," pendientes)"):"Sin periodos registrados"})]})]}),(0,y.jsxs)("div",{className:"group-coverage-section",children:[(0,y.jsx)("h3",{className:"section-title",children:"Cobertura por grupo de datos"}),O?(0,y.jsxs)("table",{className:"coverage-table",children:[(0,y.jsx)("thead",{children:(0,y.jsxs)("tr",{children:[(0,y.jsx)("th",{children:"Grupo"}),(0,y.jsx)("th",{children:"Tipos cargados"}),(0,y.jsx)("th",{children:"Tipos pendientes"}),(0,y.jsx)("th",{children:"Completitud"})]})}),(0,y.jsx)("tbody",{children:x.map(e=>{const n=Math.min(e.completion,100);return(0,y.jsxs)("tr",{children:[(0,y.jsxs)("td",{children:[e.group,(0,y.jsxs)("span",{className:"group-badge",children:["Total ",e.totalTypes]})]}),(0,y.jsxs)("td",{children:[(0,y.jsxs)("div",{className:"count-label",children:[e.loadedTypes.length," / ",e.totalTypes]}),(0,y.jsx)("div",{className:"chip-list",children:0===e.loadedTypes.length?(0,y.jsx)("span",{className:"chip chip-empty",children:"Sin datos"}):e.loadedTypes.map(e=>(0,y.jsx)("span",{className:"chip",children:e},e))})]}),(0,y.jsxs)("td",{children:[(0,y.jsx)("div",{className:"count-label",children:e.missingTypes.length}),(0,y.jsx)("div",{className:"chip-list",children:0===e.missingTypes.length?(0,y.jsx)("span",{className:"chip chip-ok",children:"Completo"}):e.missingTypes.map(e=>(0,y.jsx)("span",{className:"chip chip-warning",children:e},e))})]}),(0,y.jsx)("td",{children:(0,y.jsxs)("div",{className:"progress-badge",children:[(0,y.jsx)("div",{className:"progress-meter",children:(0,y.jsx)("div",{className:"progress-fill",style:{width:"".concat(n,"%")}})}),(0,y.jsxs)("span",{children:[e.completion.toFixed(1),"%"]})]})})]},e.group)})})]}):(0,y.jsx)("p",{children:"No hay agrupaciones disponibles."})]}),(0,y.jsxs)("div",{className:"year-coverage-section",children:[(0,y.jsx)("h3",{className:"section-title",children:"Cobertura por a\xf1o y mes"}),E?(0,y.jsxs)("table",{className:"coverage-table",children:[(0,y.jsx)("thead",{children:(0,y.jsxs)("tr",{children:[(0,y.jsx)("th",{children:"A\xf1o"}),(0,y.jsx)("th",{children:"Meses con datos"}),(0,y.jsx)("th",{children:"Meses faltantes"}),(0,y.jsx)("th",{children:"Completitud"}),(0,y.jsx)("th",{children:"Meses sin datos"})]})}),(0,y.jsx)("tbody",{children:f.map(e=>{const n=Math.min(e.completion,100),a=e.detail.filter(e=>!e.hasData);return(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{children:e.year}),(0,y.jsx)("td",{children:e.monthsWithData}),(0,y.jsx)("td",{children:e.monthsMissing}),(0,y.jsx)("td",{children:(0,y.jsxs)("div",{className:"progress-badge",children:[(0,y.jsx)("div",{className:"progress-meter",children:(0,y.jsx)("div",{className:"progress-fill",style:{width:"".concat(n,"%")}})}),(0,y.jsxs)("span",{children:[e.completion.toFixed(1),"%"]})]})}),(0,y.jsx)("td",{children:0===a.length?(0,y.jsx)("span",{className:"chip chip-ok",children:"Cobertura completa"}):(0,y.jsx)("div",{className:"chip-list",children:a.map(n=>(0,y.jsx)("span",{className:"chip chip-warning",children:n.monthLabel},"".concat(e.year,"-").concat(n.month)))})})]},e.year)})})]}):(0,y.jsx)("p",{children:"No hay informaci\xf3n temporal disponible para los criterios seleccionados."})]}),e.missingFileTypes.length>0&&(0,y.jsxs)("div",{className:"missing-files-section",children:[(0,y.jsxs)("h3",{className:"missing-files-title",children:[(0,y.jsx)(G.A,{size:24}),"Tipos de Archivos Faltantes (",e.missingFileTypes.length,")"]}),(0,y.jsx)("div",{className:"missing-files-grid",children:e.missingFileTypes.map(n=>{const a=e.fileValidations.find(e=>e.type===n);return(0,y.jsxs)("div",{className:"missing-file-item",children:[(0,y.jsx)("div",{className:"missing-file-type",children:n}),(0,y.jsx)("div",{className:"missing-file-desc",children:(null===a||void 0===a?void 0:a.type)||"Archivo de datos SICOP"})]},n)})})]}),e.recommendations.length>0&&(0,y.jsxs)("div",{className:"recommendations-section",children:[(0,y.jsxs)("h3",{className:"recommendations-title",children:[(0,y.jsx)(W,{size:24}),"Recomendaciones"]}),e.recommendations.map((e,n)=>(0,y.jsxs)("div",{className:"recommendation-item",children:[(0,y.jsx)("div",{className:"recommendation-number",children:n+1}),(0,y.jsx)("div",{children:e})]},n))]}),(0,y.jsxs)("div",{className:"files-validation-section",children:[(0,y.jsx)("h3",{className:"section-title",children:"Validaci\xf3n Detallada por Archivo"}),e.fileValidations.map(e=>(0,y.jsxs)("div",{className:"file-validation-item",children:[(0,y.jsxs)("div",{className:"file-validation-header",onClick:()=>(e=>{const n=new Set(i);n.has(e)?n.delete(e):n.add(e),o(n)})(e.fileId),children:[(0,y.jsxs)("div",{className:"file-header-left",children:[(0,y.jsx)("div",{className:"file-status-icon",children:e.isValid?(0,y.jsx)(m.A,{size:20,color:"#4CAF50"}):(0,y.jsx)(p.A,{size:20,color:"#d32f2f"})}),(0,y.jsxs)("div",{children:[(0,y.jsx)("div",{className:"file-name",children:e.fileName}),(0,y.jsx)("span",{className:"file-type-badge",children:e.type})]})]}),(0,y.jsxs)("div",{className:"file-stats",children:[(0,y.jsxs)("span",{children:[e.stats.totalRecords.toLocaleString()," registros"]}),(0,y.jsxs)("span",{children:[e.issues.length," problema(s)"]})]})]}),i.has(e.fileId)&&(0,y.jsxs)("div",{className:"file-validation-details",children:[(0,y.jsxs)("div",{className:"stats-grid",children:[(0,y.jsxs)("div",{className:"stat-item",children:[(0,y.jsx)("div",{className:"stat-label",children:"Registros Totales"}),(0,y.jsx)("div",{className:"stat-value",children:e.stats.totalRecords.toLocaleString()})]}),(0,y.jsxs)("div",{className:"stat-item",children:[(0,y.jsx)("div",{className:"stat-label",children:"Registros V\xe1lidos"}),(0,y.jsx)("div",{className:"stat-value",children:e.stats.validRecords.toLocaleString()})]}),(0,y.jsxs)("div",{className:"stat-item",children:[(0,y.jsx)("div",{className:"stat-label",children:"Tasa de Validez"}),(0,y.jsxs)("div",{className:"stat-value",children:[e.stats.totalRecords>0?(e.stats.validRecords/e.stats.totalRecords*100).toFixed(1):0,"%"]})]})]}),e.issues.length>0&&(0,y.jsxs)("div",{className:"issues-list",children:[(0,y.jsxs)("h4",{style:{marginBottom:"15px",color:"#333",display:"flex",alignItems:"center",gap:"8px"},children:[(0,y.jsx)(p.A,{size:20}),"Problemas Detectados (",e.issues.length,")"]}),e.issues.filter(e=>"error"===e.type).map((e,n)=>(0,y.jsxs)("div",{className:"issue-item ".concat(e.type),children:[g(e.type),(0,y.jsxs)("div",{className:"issue-message",children:[(0,y.jsx)("strong",{children:"ERROR:"})," ",e.message,e.field&&(0,y.jsxs)("div",{className:"issue-field-tag",children:["Campo: ",e.field]})]})]},"error-".concat(n))),e.issues.filter(e=>"warning"===e.type).map((e,n)=>(0,y.jsxs)("div",{className:"issue-item ".concat(e.type),children:[g(e.type),(0,y.jsxs)("div",{className:"issue-message",children:[(0,y.jsx)("strong",{children:"ADVERTENCIA:"})," ",e.message,e.field&&(0,y.jsxs)("div",{className:"issue-field-tag",children:["Campo: ",e.field]})]})]},"warning-".concat(n))),e.issues.filter(e=>"info"===e.type).map((e,n)=>(0,y.jsxs)("div",{className:"issue-item ".concat(e.type),children:[g(e.type),(0,y.jsxs)("div",{className:"issue-message",children:[(0,y.jsx)("strong",{children:"INFO:"})," ",e.message,e.field&&(0,y.jsxs)("div",{className:"issue-field-tag",children:["Campo: ",e.field]})]})]},"info-".concat(n)))]}),Object.keys(e.stats.fieldsCoverage).length>0&&(0,y.jsxs)("div",{style:{marginTop:"20px"},children:[(0,y.jsx)("h4",{style:{marginBottom:"15px",color:"#333"},children:"Cobertura de Campos:"}),(0,y.jsx)("div",{className:"coverage-grid",children:Object.entries(e.stats.fieldsCoverage).map(e=>{let[n,a]=e;return(0,y.jsxs)("div",{className:"coverage-item",children:[(0,y.jsx)("div",{className:"coverage-field",children:n}),(0,y.jsx)("div",{className:"coverage-bar-container",children:(0,y.jsx)("div",{className:"coverage-bar-fill ".concat(a<50?"low":a<80?"medium":""),style:{width:"".concat(a,"%")}})}),(0,y.jsxs)("div",{className:"coverage-percentage",children:[a.toFixed(1),"%"]})]},n)})})]})]})]},e.fileId))]})]})};var K=a(8406);const Z=(0,l.A)("table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);const Q=new class{async analyzeAllFiles(e,n){const a=await h.q.getConsolidatedData(),t=[];for(const[s,i]of Object.entries(a)){if(!Array.isArray(i)||0===i.length)continue;let a=i;if(void 0!==e&&(a=a.filter(n=>n._YEAR===e)),void 0!==n&&(a=a.filter(e=>e._MONTH===n)),0===a.length)continue;const o=this.analyzeTable(s,a);t.push(o)}return L().sortBy(t,e=>-e.totalRows)}analyzeTable(e,n){console.log("\ud83d\udcca Analizando schema de ".concat(e,"..."));const a=u.find(n=>n.type===e),t=M.Dj[e]||{},s=this.extractAllColumnNames(n),i=[];for(const u of s){const e=this.analyzeColumn(u,n,t);i.push(e)}const o=["_YEAR","_MONTH","_FILE_SOURCE","_UPLOAD_DATE"],r=i.filter(e=>!o.includes(e.columnName)),l=i.filter(e=>o.includes(e.columnName)),c=new Set(i.map(e=>e.columnName)),d=((null===a||void 0===a?void 0:a.requiredFields)||[]).map(e=>{const n=e.trim().toLowerCase(),a=t[n]||e,s=c.has(a),i=void 0!==t[n]&&t[n]!==e;return{field:e,mappedFieldName:a,isMapped:s,wasMapped:i,sourceColumn:i?e:void 0}}),p=d.filter(e=>!e.isMapped).map(e=>e.field),m=d.filter(e=>e.isMapped&&e.wasMapped),h=r.filter(e=>{var n,t;const s=e.mappedName||e.columnName,i=null===a||void 0===a||null===(n=a.requiredFields)||void 0===n?void 0:n.includes(s),o=null===a||void 0===a||null===(t=a.optionalFields)||void 0===t?void 0:t.includes(s);return!i&&!o}).map(e=>e.columnName),g=this.calculateQualityScore(i,p,m,n.length),x=this.extractTemporalCoverage(n);return{tableName:e,originalFileName:this.getOriginalFileName(e),totalRows:n.length,totalColumns:r.length,columns:[...r,...l],headerMapping:t,unmappedColumns:h,expectedSchema:a?{type:a.type,requiredFields:a.requiredFields,optionalFields:a.optionalFields||[]}:void 0,missingRequiredFields:p,extraFields:h,qualityScore:g.score,issues:g.issues,temporalCoverage:x}}analyzeColumn(e,n,a){const t=n.map(n=>n[e]),s=t.filter(e=>null!=e&&""!==e),i=a[e.trim().toLowerCase()]||a[e],o=this.detectDataType(s),r=t.length,l=r-s.length,c=L().uniq(s).length,d=r>0?s.length/r*100:0,p=s.length>0?c/s.length*100:0,m=L().sampleSize(s,Math.min(5,s.length)),h=this.getTopValues(s,10),g={columnName:e,originalName:e,mappedName:i,dataType:o.type,confidence:o.confidence,totalValues:r,nullCount:l,uniqueCount:c,completeness:d,distinctness:p,sampleValues:m,topValues:h};if("number"===o.type||"currency"===o.type){const e=this.calculateNumericStats(s);Object.assign(g,e)}if("string"===o.type){const e=this.calculateTextStats(s);Object.assign(g,e)}return g.patterns=this.detectPatterns(s,o.type),g.issues=this.detectIssues(g),g}detectDataType(e){if(0===e.length)return{type:"null",confidence:1};const n=e.slice(0,Math.min(1e3,e.length));let a=0,t=0,s=0,i=0,o=0,r=0,l=0,c=0;for(const m of n){const e=String(m).trim();/^(true|false|yes|no|si|no|1|0)$/i.test(e)?s++:/^[\u20a1$]?[\d,]+\.?\d*\s*(CRC|USD|\u20a1|\$)?$/i.test(e)&&/\d/.test(e)?(o++,a++):/^\d+\.?\d*\s*%$/.test(e)?(r++,a++):isNaN(Number(e))||""===e?this.isDate(e)?t++:/^\d{4,}-?\d*$/.test(e)||/^\d{9,}$/.test(e)?(l++,i++):/^[A-Z0-9]{2,}-[A-Z0-9]+$/i.test(e)||/^[A-Z]{2,}\d+$/i.test(e)?(c++,i++):i++:a++}const d=n.length,p=.8;return t/d>p?{type:"date",confidence:t/d}:s/d>p?{type:"boolean",confidence:s/d}:o/d>p?{type:"currency",confidence:o/d}:r/d>p?{type:"percentage",confidence:r/d}:l/d>p?{type:"id",confidence:l/d}:c/d>p?{type:"code",confidence:c/d}:a/d>p?{type:"number",confidence:a/d}:i/d>p?{type:"string",confidence:i/d}:{type:"mixed",confidence:.5}}isDate(e){if(/^\d{1,2}[/-]\d{1,2}[/-]\d{4}$/.test(e))return!0;if(/^\d{4}-\d{1,2}-\d{1,2}$/.test(e))return!0;if(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/.test(e))return!0;const n=new Date(e);return!isNaN(n.getTime())}calculateNumericStats(e){const n=e.map(e=>{const n=String(e).replace(/[\u20a1$,\s%CRCUSDcrcusd]/g,"");return parseFloat(n)}).filter(e=>!isNaN(e)&&isFinite(e));if(0===n.length)return{};const a=L().sortBy(n),t=L().sum(n)/n.length,s=a[Math.floor(a.length/2)],i=L().sumBy(n,e=>Math.pow(e-t,2))/n.length,o=Math.sqrt(i);return{min:L().min(n),max:L().max(n),mean:Math.round(100*t)/100,median:Math.round(100*s)/100,stdDev:Math.round(100*o)/100}}calculateTextStats(e){const n=e.map(e=>String(e)).map(e=>e.length);return{minLength:L().min(n),maxLength:L().max(n),avgLength:Math.round(100*L().mean(n))/100}}getTopValues(e,n){const a=L().countBy(e),t=L().orderBy(Object.entries(a),e=>{let[,n]=e;return n},"desc"),s=e.length;return t.slice(0,n).map(e=>{let[n,a]=e;return{value:n,count:a,percentage:Math.round(a/s*1e4)/100}})}detectPatterns(e,n){const a=[],t=e.slice(0,Math.min(100,e.length));if("id"===n||"code"===n){const e=t.map(e=>String(e).length),n=L().uniq(e);1===n.length?a.push("Longitud fija: ".concat(n[0]," caracteres")):a.push("Longitud variable: ".concat(L().min(e),"-").concat(L().max(e)," caracteres"))}if("string"===n){const e=t.some(e=>/[A-Z]/.test(String(e))),n=t.some(e=>/[a-z]/.test(String(e))),s=t.some(e=>/\d/.test(String(e)));e&&!n&&a.push("Solo may\xfasculas"),n&&!e&&a.push("Solo min\xfasculas"),s&&a.push("Contiene n\xfameros")}if("date"===n){const e={};t.forEach(n=>{const a=String(n);/^\d{1,2}[/-]\d{1,2}[/-]\d{4}$/.test(a)&&(e["DD/MM/YYYY"]=(e["DD/MM/YYYY"]||0)+1),/^\d{4}-\d{2}-\d{2}$/.test(a)&&(e["YYYY-MM-DD"]=(e["YYYY-MM-DD"]||0)+1),/^\d{4}-\d{2}-\d{2}T/.test(a)&&(e["ISO 8601"]=(e["ISO 8601"]||0)+1)});const n=L().maxBy(Object.entries(e),e=>{let[,n]=e;return n});n&&a.push("Formato predominante: ".concat(n[0]))}return a}detectIssues(e){const n=[];return e.completeness<50&&n.push("Completitud baja: ".concat(e.completeness.toFixed(1),"% de valores no nulos")),e.distinctness>95&&e.totalValues>100&&n.push("Alta cardinalidad: casi todos los valores son \xfanicos"),e.uniqueCount<=10&&e.totalValues>100&&n.push("Campo categ\xf3rico: solo ".concat(e.uniqueCount," valores distintos")),"mixed"===e.dataType&&n.push("Tipo de dato mixto o inconsistente"),e.confidence<.7&&n.push("Baja confianza en tipo detectado: ".concat((100*e.confidence).toFixed(0),"%")),n}extractAllColumnNames(e){const n=new Set;return e.forEach(e=>{Object.keys(e).forEach(e=>n.add(e))}),Array.from(n).sort()}calculateQualityScore(e,n,a,t){const s=[];let i=100;return n.length>0&&(i-=10*n.length,n.forEach(e=>{s.push({severity:"error",message:"\u274c Campo requerido faltante: ".concat(e," (no existe ni mapeado)")})})),a.forEach(e=>{s.push({severity:"info",message:'\u2705 Transformaci\xf3n aplicada: "'.concat(e.sourceColumn,'" \u2192 "').concat(e.mappedFieldName,'" (campo requerido mapeado correctamente)')})}),e.forEach(e=>{e.completeness<50&&(i-=5,s.push({severity:"warning",column:e.columnName,message:"Baja completitud (".concat(e.completeness.toFixed(1),"%)")})),"mixed"===e.dataType&&(i-=3,s.push({severity:"warning",column:e.columnName,message:"Tipo de dato inconsistente"}))}),t<10&&(i-=20,s.push({severity:"warning",message:"Muy pocos registros: ".concat(t)})),{score:Math.max(0,Math.min(100,i)),issues:s}}extractTemporalCoverage(e){const n=new Set,a=new Set,t=new Set;if(e.forEach(e=>{e._YEAR&&n.add(String(e._YEAR)),e._MONTH&&a.add(String(e._MONTH)),e._FILE_SOURCE&&t.add(String(e._FILE_SOURCE))}),0!==n.size||0!==a.size||0!==t.size)return{years:Array.from(n).sort(),months:Array.from(a).sort(),files:Array.from(t).sort()}}getOriginalFileName(e){return{InstitucionesRegistradas:"InstitucionesRegistradas.csv",Proveedores:"Proveedores_unido.csv",DetalleCarteles:"DetalleCarteles.csv",DetalleLineaCartel:"DetalleLineaCartel.csv",FechaPorEtapas:"FechaPorEtapas.csv",Ofertas:"Ofertas.csv",LineasOfertadas:"LineasOfertadas.csv",LineasRecibidas:"LineasRecibidas.csv",LineasAdjudicadas:"LineasAdjudicadas.csv",AdjudicacionesFirme:"AdjudicacionesFirme.csv",Contratos:"Contratos.csv",LineasContratadas:"LineasContratadas.csv",OrdenPedido:"OrdenPedido.csv",Recepciones:"Recepciones.csv",Garantias:"Garantias.csv",RecursosObjecion:"RecursosObjecion.csv",SancionProveedores:"SancionProveedores.csv",InvitacionProcedimiento:"InvitacionProcedimiento.csv",ProcedimientoAdjudicacion:"ProcedimientoAdjudicacion.csv",ProcedimientoADM:"ProcedimientoADM.csv",Sistemas:"Sistemas.csv",SistemaEvaluacionOfertas:"SistemaEvaluacionOfertas.csv",ReajustePrecios:"ReajustePrecios.csv",FuncionariosInhibicion:"FuncionariosInhibicion.csv",Remates:"Remates.csv"}[e]||"".concat(e,".csv")}async generateFullReport(){const e=await this.analyzeAllFiles();let n="\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n";return n+="   REPORTE DE AN\xc1LISIS DE SCHEMAS - SISTEMA SICOP\n",n+="\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n",n+="Fecha de generaci\xf3n: ".concat((new Date).toLocaleString("es-CR"),"\n"),n+="Total de tablas analizadas: ".concat(e.length,"\n"),n+="Total de registros: ".concat(L().sumBy(e,"totalRows").toLocaleString(),"\n\n"),e.forEach((e,a)=>{n+="\n".concat("\u2500".repeat(60),"\n"),n+="".concat(a+1,". ").concat(e.tableName,"\n"),n+="".concat("\u2500".repeat(60),"\n"),n+="Archivo: ".concat(e.originalFileName,"\n"),n+="Registros: ".concat(e.totalRows.toLocaleString(),"\n"),n+="Columnas: ".concat(e.totalColumns,"\n"),n+="Calidad: ".concat(e.qualityScore.toFixed(0),"%\n\n"),e.expectedSchema&&(n+="Schema Esperado:\n",n+="  Campos requeridos: ".concat(e.expectedSchema.requiredFields.join(", "),"\n"),e.missingRequiredFields.length>0&&(n+="  \u26a0\ufe0f  Faltantes: ".concat(e.missingRequiredFields.join(", "),"\n"))),n+="\nColumnas:\n",e.columns.forEach(e=>{const a=e.mappedName?" \u2192 ".concat(e.mappedName):"";var t,s,i;(n+="  \u2022 ".concat(e.columnName).concat(a,"\n"),n+="    Tipo: ".concat(e.dataType," (").concat((100*e.confidence).toFixed(0),"% confianza)\n"),n+="    Completitud: ".concat(e.completeness.toFixed(1),"% | \xdanicos: ").concat(e.uniqueCount.toLocaleString(),"\n"),void 0!==e.min)&&(n+="    Rango: ".concat(e.min.toLocaleString()," - ").concat(null===(t=e.max)||void 0===t?void 0:t.toLocaleString(),"\n"),n+="    Promedio: ".concat(null===(s=e.mean)||void 0===s?void 0:s.toLocaleString()," | Mediana: ").concat(null===(i=e.median)||void 0===i?void 0:i.toLocaleString(),"\n"));e.issues&&e.issues.length>0&&(n+="    \u26a0\ufe0f  ".concat(e.issues.join("; "),"\n"))}),e.issues.length>0&&(n+="\nProblemas detectados:\n",e.issues.forEach(e=>{const a="error"===e.severity?"\u274c":"warning"===e.severity?"\u26a0\ufe0f":"\u2139\ufe0f";n+="  ".concat(a," ").concat(e.message),e.column&&(n+=" (".concat(e.column,")")),n+="\n"}))}),n+="\n".concat("\u2550".repeat(60),"\n"),n+="Fin del reporte\n",n+="".concat("\u2550".repeat(60),"\n"),n}},ee=e=>{let{tableName:n,onClose:a}=e;const[s,i]=(0,t.useState)([]),[o,r]=(0,t.useState)(null),[l,c]=(0,t.useState)(null),[d,p]=(0,t.useState)(!0),[g,u]=(0,t.useState)(""),[x,f]=(0,t.useState)(""),[b,v]=(0,t.useState)([]),[j,N]=(0,t.useState)([]);(0,t.useEffect)(()=>{C()},[]),(0,t.useEffect)(()=>{A()},[n,g,x]);const C=async()=>{try{const e=(await h.q.getCacheStats()).yearsList.map(e=>String(e)).sort((e,n)=>Number(n)-Number(e));v(e);const n=Array.from({length:12},(e,n)=>String(n+1).padStart(2,"0"));N(n)}catch(e){console.error("Error cargando fechas disponibles:",e)}},A=async()=>{p(!0);try{const e=await Q.analyzeAllFiles(g?Number(g):void 0,x?Number(x):void 0);if(n){const a=e.filter(e=>e.tableName===n);i(a),a.length>0&&r(a[0])}else i(e)}catch(e){console.error("Error cargando an\xe1lisis de schemas:",e)}finally{p(!1)}},O=e=>["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][parseInt(e,10)-1]||e,S=e=>({string:"\ud83d\udcdd",number:"\ud83d\udd22",date:"\ud83d\udcc5",boolean:"\u2611\ufe0f",currency:"\ud83d\udcb0",percentage:"\ud83d\udcca",id:"\ud83d\udd11",code:"\ud83c\udff7\ufe0f",mixed:"\ud83d\udd00",null:"\u2205",email:"\ud83d\udce7",phone:"\ud83d\udcde"}[e]||"\u2753"),k=e=>e>=90?"#4caf50":e>=70?"#ff9800":"#f44336";return d?(0,y.jsxs)("div",{className:"schema-analysis-panel loading",children:[(0,y.jsx)(K.A,{className:"spinner",size:40}),(0,y.jsx)("p",{children:"Analizando schemas..."})]}):0===s.length?(0,y.jsxs)("div",{className:"schema-analysis-panel empty",children:[(0,y.jsx)(w.A,{size:48,color:"#999"}),(0,y.jsx)("p",{children:"No hay datos para analizar"})]}):(0,y.jsxs)("div",{className:"schema-analysis-panel",children:[(0,y.jsx)("style",{children:"\n        .schema-analysis-panel {\n          max-width: 1600px;\n          margin: 0 auto;\n          padding: 20px;\n          background: linear-gradient(135deg, #f0f4f8 0%, #e8eef5 50%, #dfe7f0 100%);\n          position: relative;\n        }\n\n        .schema-analysis-panel::before {\n          content: '';\n          position: absolute;\n          top: 0;\n          left: 0;\n          right: 0;\n          height: 300px;\n          background: \n            radial-gradient(circle at 20% 30%, rgba(59, 130, 246, 0.08) 0%, transparent 50%),\n            radial-gradient(circle at 80% 20%, rgba(147, 51, 234, 0.06) 0%, transparent 50%);\n          pointer-events: none;\n          z-index: 0;\n        }\n\n        .schema-analysis-panel > * {\n          position: relative;\n          z-index: 1;\n        }\n\n        .schema-analysis-panel.loading,\n        .schema-analysis-panel.empty {\n          display: flex;\n          flex-direction: column;\n          align-items: center;\n          justify-content: center;\n          min-height: 400px;\n          gap: 20px;\n        }\n\n        .spinner {\n          animation: spin 1s linear infinite;\n        }\n\n        @keyframes spin {\n          from { transform: rotate(0deg); }\n          to { transform: rotate(360deg); }\n        }\n\n        .schema-header {\n          background: linear-gradient(135deg, #ffffff 0%, #f8faff 100%);\n          padding: 30px;\n          border-radius: 16px;\n          margin-bottom: 25px;\n          box-shadow: \n            0 4px 16px rgba(59, 130, 246, 0.1),\n            0 2px 8px rgba(0, 0, 0, 0.05);\n          border: 1px solid rgba(59, 130, 246, 0.1);\n          position: relative;\n          overflow: hidden;\n        }\n\n        .schema-header::before {\n          content: '';\n          position: absolute;\n          top: 0;\n          left: 0;\n          width: 100%;\n          height: 6px;\n          background: linear-gradient(90deg, #3b82f6 0%, #8b5cf6 50%, #ec4899 100%);\n        }\n\n        .schema-title {\n          font-size: 1.9em;\n          font-weight: 800;\n          color: #1e293b;\n          display: flex;\n          align-items: center;\n          gap: 12px;\n          margin-bottom: 10px;\n          letter-spacing: -0.5px;\n        }\n\n        .schema-title svg {\n          color: #3b82f6;\n          filter: drop-shadow(0 2px 6px rgba(59, 130, 246, 0.3));\n        }\n\n        .schema-subtitle {\n          color: #64748b;\n          font-size: 1em;\n          line-height: 1.6;\n        }\n\n        .filters-section {\n          background: linear-gradient(135deg, #ffffff 0%, #fefeff 100%);\n          padding: 25px;\n          border-radius: 16px;\n          margin-bottom: 25px;\n          box-shadow: \n            0 4px 16px rgba(147, 51, 234, 0.08),\n            0 2px 8px rgba(0, 0, 0, 0.05);\n          border: 1px solid rgba(147, 51, 234, 0.1);\n        }\n\n        .filters-header {\n          display: flex;\n          align-items: center;\n          gap: 10px;\n          font-size: 1.15em;\n          font-weight: 700;\n          color: #1e293b;\n          margin-bottom: 18px;\n        }\n\n        .filters-header svg {\n          color: #8b5cf6;\n          filter: drop-shadow(0 2px 4px rgba(139, 92, 246, 0.3));\n        }\n\n        .filters-controls {\n          display: flex;\n          gap: 15px;\n          align-items: flex-end;\n          flex-wrap: wrap;\n        }\n\n        .filter-group {\n          display: flex;\n          flex-direction: column;\n          gap: 5px;\n        }\n\n        .filter-group label {\n          display: flex;\n          align-items: center;\n          gap: 5px;\n          font-size: 0.9em;\n          font-weight: 500;\n          color: #555;\n        }\n\n        .filter-select {\n          padding: 10px 14px;\n          border: 2px solid #e2e8f0;\n          border-radius: 10px;\n          font-size: 0.95em;\n          background: white;\n          cursor: pointer;\n          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n          min-width: 180px;\n          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);\n        }\n\n        .filter-select:hover:not(:disabled) {\n          border-color: #3b82f6;\n          box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);\n          transform: translateY(-2px);\n        }\n\n        .filter-select:focus {\n          outline: none;\n          border-color: #3b82f6;\n          box-shadow: \n            0 0 0 4px rgba(59, 130, 246, 0.1),\n            0 4px 12px rgba(59, 130, 246, 0.15);\n        }\n\n        .filter-select:disabled {\n          background: #f5f5f5;\n          cursor: not-allowed;\n          opacity: 0.6;\n        }\n\n        .clear-filters-btn {\n          padding: 10px 20px;\n          background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);\n          color: white;\n          border: none;\n          border-radius: 10px;\n          font-size: 0.9em;\n          font-weight: 600;\n          cursor: pointer;\n          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n          box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);\n        }\n\n        .clear-filters-btn:hover {\n          background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);\n          transform: translateY(-2px);\n          box-shadow: 0 6px 20px rgba(239, 68, 68, 0.4);\n        }\n\n        .active-filters {\n          margin-top: 18px;\n          padding-top: 18px;\n          border-top: 2px solid #e5e7eb;\n          display: flex;\n          gap: 12px;\n          align-items: center;\n          font-size: 0.9em;\n        }\n\n        .filter-tag {\n          background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);\n          color: #1e40af;\n          padding: 6px 14px;\n          border-radius: 16px;\n          font-weight: 600;\n          box-shadow: 0 2px 6px rgba(59, 130, 246, 0.15);\n        }\n\n        .schema-layout {\n          display: grid;\n          grid-template-columns: 300px 1fr;\n          gap: 20px;\n          height: calc(100vh - 200px);\n        }\n\n        .file-list {\n          background: linear-gradient(135deg, #ffffff 0%, #fefeff 100%);\n          border-radius: 16px;\n          padding: 20px;\n          overflow-y: auto;\n          box-shadow: \n            0 4px 16px rgba(59, 130, 246, 0.08),\n            0 2px 8px rgba(0, 0, 0, 0.05);\n          border: 1px solid rgba(59, 130, 246, 0.1);\n        }\n\n        .file-list-title {\n          font-size: 1.15em;\n          font-weight: 700;\n          color: #1e293b;\n          margin-bottom: 18px;\n          padding-bottom: 12px;\n          border-bottom: 3px solid #e5e7eb;\n          background: linear-gradient(90deg, #3b82f6 0%, #8b5cf6 100%);\n          -webkit-background-clip: text;\n          -webkit-text-fill-color: transparent;\n          background-clip: text;\n        }\n\n        .file-item {\n          padding: 14px;\n          margin-bottom: 10px;\n          border-radius: 12px;\n          cursor: pointer;\n          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n          border: 2px solid transparent;\n          background: white;\n          box-shadow: 0 2px 6px rgba(0, 0, 0, 0.04);\n        }\n\n        .file-item:hover {\n          background: linear-gradient(135deg, #eff6ff 0%, #f0f9ff 100%);\n          border-color: #3b82f6;\n          transform: translateX(4px);\n          box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);\n        }\n\n        .file-item.selected {\n          background: linear-gradient(135deg, #dbeafe 0%, #e0f2fe 100%);\n          border-color: #3b82f6;\n          box-shadow: 0 4px 16px rgba(59, 130, 246, 0.2);\n          transform: translateX(8px);\n        }\n\n        .file-item-name {\n          font-weight: 700;\n          color: #1e293b;\n          font-size: 0.92em;\n          margin-bottom: 6px;\n        }\n\n        .file-item-stats {\n          font-size: 0.82em;\n          color: #64748b;\n          display: flex;\n          justify-content: space-between;\n          gap: 8px;\n        }\n\n        .file-item-quality {\n          display: flex;\n          align-items: center;\n          gap: 6px;\n          margin-top: 8px;\n        }\n\n        .quality-badge {\n          padding: 4px 10px;\n          border-radius: 14px;\n          font-size: 0.75em;\n          font-weight: 700;\n          color: white;\n          box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);\n          text-transform: uppercase;\n          letter-spacing: 0.3px;\n        }\n\n        .file-detail {\n          background: linear-gradient(135deg, #ffffff 0%, #fefeff 100%);\n          border-radius: 16px;\n          padding: 25px;\n          overflow-y: auto;\n          box-shadow: \n            0 4px 16px rgba(139, 92, 246, 0.08),\n            0 2px 8px rgba(0, 0, 0, 0.05);\n          border: 1px solid rgba(139, 92, 246, 0.1);\n        }\n\n        .detail-header {\n          margin-bottom: 30px;\n          padding-bottom: 25px;\n          border-bottom: 3px solid #e5e7eb;\n          position: relative;\n        }\n\n        .detail-header::after {\n          content: '';\n          position: absolute;\n          bottom: -3px;\n          left: 0;\n          width: 120px;\n          height: 3px;\n          background: linear-gradient(90deg, #3b82f6 0%, #8b5cf6 100%);\n        }\n\n        .detail-title {\n          font-size: 1.5em;\n          font-weight: 800;\n          color: #1e293b;\n          margin-bottom: 12px;\n          letter-spacing: -0.3px;\n        }\n\n        .detail-metrics {\n          display: grid;\n          grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));\n          gap: 18px;\n          margin-top: 18px;\n        }\n\n        .metric-card {\n          background: linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%);\n          padding: 18px;\n          border-radius: 12px;\n          border-left: 5px solid #3b82f6;\n          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n          box-shadow: 0 2px 8px rgba(59, 130, 246, 0.08);\n        }\n\n        .metric-card:hover {\n          transform: translateY(-4px);\n          box-shadow: 0 6px 20px rgba(59, 130, 246, 0.15);\n          border-left-width: 5px;\n        }\n\n        .metric-label {\n          font-size: 0.82em;\n          color: #64748b;\n          text-transform: uppercase;\n          letter-spacing: 0.8px;\n          margin-bottom: 8px;\n          font-weight: 700;\n        }\n        }\n\n        .metric-value {\n          font-size: 1.6em;\n          font-weight: 800;\n          color: #1e293b;\n          letter-spacing: -0.5px;\n        }\n\n        .section-title {\n          font-size: 1.25em;\n          font-weight: 700;\n          color: #1e293b;\n          margin: 30px 0 18px;\n          display: flex;\n          align-items: center;\n          gap: 10px;\n          padding-bottom: 12px;\n          border-bottom: 2px solid #e5e7eb;\n        }\n\n        .section-title svg {\n          color: #8b5cf6;\n          filter: drop-shadow(0 2px 4px rgba(139, 92, 246, 0.3));\n        }\n\n        .issues-list {\n          margin-bottom: 30px;\n        }\n\n        .issue-item {\n          padding: 14px;\n          border-radius: 12px;\n          margin-bottom: 10px;\n          display: flex;\n          align-items: flex-start;\n          gap: 12px;\n          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n          box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06);\n        }\n\n        .issue-item:hover {\n          transform: translateX(4px);\n          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n        }\n\n        .issue-item.error {\n          background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);\n          border-left: 5px solid #ef4444;\n        }\n\n        .issue-item.warning {\n          background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);\n          border-left: 5px solid #f59e0b;\n        }\n\n        .issue-item.info {\n          background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);\n          border-left: 5px solid #3b82f6;\n        }\n\n        .columns-table {\n          width: 100%;\n          border-collapse: collapse;\n          margin-top: 15px;\n          font-size: 0.9em;\n          box-shadow: 0 2px 12px rgba(0, 0, 0, 0.06);\n          border-radius: 12px;\n          overflow: hidden;\n        }\n\n        .columns-table th {\n          background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);\n          padding: 14px;\n          text-align: left;\n          font-weight: 700;\n          color: white;\n          border-bottom: none;\n          position: sticky;\n          top: 0;\n          z-index: 10;\n          text-transform: uppercase;\n          letter-spacing: 0.5px;\n          font-size: 0.85em;\n        }\n\n        .columns-table td {\n          padding: 12px 14px;\n          border-bottom: 1px solid #e5e7eb;\n          background: white;\n        }\n\n        .columns-table tr:hover td {\n          background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);\n          cursor: pointer;\n        }\n\n        .columns-table tr.selected td {\n          background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);\n          font-weight: 600;\n        }\n\n        .column-name {\n          font-weight: 700;\n          color: #1e293b;\n        }\n\n        .column-mapped {\n          color: #64748b;\n          font-size: 0.9em;\n          font-style: italic;\n          margin-left: 8px;\n        }\n\n        .data-type-badge {\n          display: inline-flex;\n          align-items: center;\n          gap: 6px;\n          padding: 5px 12px;\n          border-radius: 14px;\n          font-size: 0.85em;\n          font-weight: 600;\n          background: linear-gradient(135deg, #e5e7eb 0%, #d1d5db 100%);\n          color: #1e293b;\n          box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);\n        }\n\n        .completeness-bar {\n          width: 110px;\n          height: 24px;\n          background: #e5e7eb;\n          border-radius: 12px;\n          overflow: hidden;\n          position: relative;\n          box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);\n        }\n\n        .completeness-fill {\n          height: 100%;\n          background: linear-gradient(90deg, #10b981 0%, #059669 100%);\n          transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n          box-shadow: 0 2px 6px rgba(16, 185, 129, 0.4);\n        }\n\n        .completeness-fill.low {\n          background: linear-gradient(90deg, #ef4444 0%, #dc2626 100%);\n          box-shadow: 0 2px 6px rgba(239, 68, 68, 0.4);\n        }\n\n        .completeness-fill.medium {\n          background: linear-gradient(90deg, #f59e0b 0%, #d97706 100%);\n          box-shadow: 0 2px 6px rgba(245, 158, 11, 0.4);\n        }\n\n        .column-detail {\n          margin-top: 25px;\n          padding: 25px;\n          background: linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%);\n          border-radius: 16px;\n          border: 2px solid #e5e7eb;\n          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);\n        }\n\n        .column-detail-title {\n          font-size: 1.3em;\n          font-weight: 700;\n          color: #333;\n          margin-bottom: 15px;\n        }\n\n        .column-detail-grid {\n          display: grid;\n          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n          gap: 15px;\n          margin-bottom: 20px;\n        }\n\n        .detail-stat {\n          padding: 10px;\n          background: white;\n          border-radius: 6px;\n        }\n\n        .detail-stat-label {\n          font-size: 0.8em;\n          color: #666;\n          margin-bottom: 5px;\n        }\n\n        .detail-stat-value {\n          font-size: 1.2em;\n          font-weight: 600;\n          color: #333;\n        }\n\n        .sample-values {\n          margin-top: 15px;\n        }\n\n        .sample-values-title {\n          font-size: 1em;\n          font-weight: 600;\n          color: #333;\n          margin-bottom: 10px;\n        }\n\n        .sample-chips {\n          display: flex;\n          flex-wrap: wrap;\n          gap: 8px;\n        }\n\n        .sample-chip {\n          padding: 6px 12px;\n          background: white;\n          border: 1px solid #ddd;\n          border-radius: 16px;\n          font-size: 0.85em;\n          color: #333;\n        }\n\n        .top-values-table {\n          width: 100%;\n          margin-top: 10px;\n          font-size: 0.9em;\n        }\n\n        .top-values-table th {\n          text-align: left;\n          padding: 8px;\n          background: white;\n          font-weight: 600;\n          color: #333;\n          border-bottom: 2px solid #ddd;\n        }\n\n        .top-values-table td {\n          padding: 8px;\n          border-bottom: 1px solid #eee;\n        }\n\n        .schema-mapping {\n          margin-top: 20px;\n          padding: 15px;\n          background: #f0f4ff;\n          border-radius: 6px;\n          border: 1px solid #d0dff5;\n        }\n\n        .schema-mapping-title {\n          font-weight: 600;\n          color: #1976d2;\n          margin-bottom: 10px;\n        }\n\n        .mapping-list {\n          display: grid;\n          grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));\n          gap: 10px;\n        }\n\n        .mapping-item {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n          font-size: 0.85em;\n          color: #333;\n        }\n\n        .mapping-arrow {\n          color: #2196f3;\n          font-weight: bold;\n        }\n      "}),(0,y.jsxs)("div",{className:"schema-header",children:[(0,y.jsxs)("div",{className:"schema-title",children:[(0,y.jsx)(Z,{size:28}),"An\xe1lisis de Schemas y Datos"]}),(0,y.jsx)("div",{className:"schema-subtitle",children:"Inspecci\xf3n detallada de tipos de datos, estad\xedsticas y calidad - Similar a Tableau Prep"})]}),(0,y.jsxs)("div",{className:"filters-section",children:[(0,y.jsxs)("div",{className:"filters-header",children:[(0,y.jsx)(E.A,{size:18}),(0,y.jsx)("span",{children:"Filtros Temporales"})]}),(0,y.jsxs)("div",{className:"filters-controls",children:[(0,y.jsxs)("div",{className:"filter-group",children:[(0,y.jsxs)("label",{children:[(0,y.jsx)(I.A,{size:16}),"A\xf1o"]}),(0,y.jsxs)("select",{value:g,onChange:e=>u(e.target.value),className:"filter-select",children:[(0,y.jsx)("option",{value:"",children:"Todos los a\xf1os"}),b.map(e=>(0,y.jsx)("option",{value:e,children:e},e))]})]}),(0,y.jsxs)("div",{className:"filter-group",children:[(0,y.jsxs)("label",{children:[(0,y.jsx)(I.A,{size:16}),"Mes"]}),(0,y.jsxs)("select",{value:x,onChange:e=>f(e.target.value),className:"filter-select",disabled:!g,children:[(0,y.jsx)("option",{value:"",children:"Todos los meses"}),j.map(e=>(0,y.jsx)("option",{value:e,children:O(e)},e))]})]}),(g||x)&&(0,y.jsx)("button",{onClick:()=>{u(""),f("")},className:"clear-filters-btn",children:"Limpiar Filtros"})]}),(g||x)&&(0,y.jsxs)("div",{className:"active-filters",children:[(0,y.jsx)("strong",{children:"Filtros activos:"}),g&&(0,y.jsxs)("span",{className:"filter-tag",children:["A\xf1o: ",g]}),x&&(0,y.jsxs)("span",{className:"filter-tag",children:["Mes: ",O(x)]})]})]}),(0,y.jsxs)("div",{className:"schema-layout",children:[(0,y.jsxs)("div",{className:"file-list",children:[(0,y.jsxs)("div",{className:"file-list-title",children:["Tablas (",s.length,")"]}),s.map(e=>(0,y.jsxs)("div",{className:"file-item ".concat((null===o||void 0===o?void 0:o.tableName)===e.tableName?"selected":""),onClick:()=>{r(e),c(null)},children:[(0,y.jsx)("div",{className:"file-item-name",children:e.tableName}),(0,y.jsxs)("div",{className:"file-item-stats",children:[(0,y.jsxs)("span",{children:["\ud83d\udcca ",e.totalRows.toLocaleString()," filas"]}),(0,y.jsxs)("span",{children:["\ud83d\udccb ",e.totalColumns," cols"]})]}),(0,y.jsx)("div",{className:"file-item-quality",children:(0,y.jsxs)("div",{className:"quality-badge",style:{background:k(e.qualityScore)},children:[e.qualityScore.toFixed(0),"%"]})})]},e.tableName))]}),(0,y.jsx)("div",{className:"file-detail",children:o?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{className:"detail-header",children:[(0,y.jsxs)("div",{className:"detail-title",children:[(0,y.jsx)(R.A,{size:24,style:{marginRight:"8px",display:"inline"}}),o.tableName]}),(0,y.jsxs)("div",{style:{color:"#666",fontSize:"0.9em",marginBottom:"5px"},children:["Archivo: ",o.originalFileName]}),(0,y.jsxs)("div",{className:"detail-metrics",children:[(0,y.jsxs)("div",{className:"metric-card",children:[(0,y.jsx)("div",{className:"metric-label",children:"Total Registros"}),(0,y.jsx)("div",{className:"metric-value",children:o.totalRows.toLocaleString()})]}),(0,y.jsxs)("div",{className:"metric-card",children:[(0,y.jsx)("div",{className:"metric-label",children:"Columnas"}),(0,y.jsx)("div",{className:"metric-value",children:o.totalColumns})]}),(0,y.jsxs)("div",{className:"metric-card",children:[(0,y.jsx)("div",{className:"metric-label",children:"Calidad"}),(0,y.jsxs)("div",{className:"metric-value",style:{color:k(o.qualityScore)},children:[o.qualityScore.toFixed(0),"%"]})]}),o.expectedSchema&&(0,y.jsxs)("div",{className:"metric-card",children:[(0,y.jsx)("div",{className:"metric-label",children:"Campos Requeridos"}),(0,y.jsx)("div",{className:"metric-value",children:o.expectedSchema.requiredFields.length})]})]})]}),o.issues.length>0&&(()=>{const e=o.issues.filter(e=>"info"===e.severity),n=o.issues.filter(e=>"error"===e.severity),a=o.issues.filter(e=>"warning"===e.severity);return(0,y.jsxs)(y.Fragment,{children:[e.length>0&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{className:"section-title",style:{color:"#2196f3"},children:[(0,y.jsx)(m.A,{size:20}),"Transformaciones Aplicadas (",e.length,")"]}),(0,y.jsx)("div",{className:"issues-list",children:e.map((e,n)=>(0,y.jsxs)("div",{className:"issue-item info",children:[(0,y.jsx)(m.A,{size:18,color:"#2196f3"}),(0,y.jsx)("div",{children:e.message})]},n))})]}),n.length>0&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{className:"section-title",style:{color:"#f44336"},children:[(0,y.jsx)(G.A,{size:20}),"Problemas Cr\xedticos (",n.length,")"]}),(0,y.jsx)("div",{className:"issues-list",children:n.map((e,n)=>(0,y.jsxs)("div",{className:"issue-item error",children:[(0,y.jsx)(G.A,{size:18,color:"#f44336"}),(0,y.jsxs)("div",{children:[e.message,e.column&&(0,y.jsxs)("span",{style:{color:"#666"},children:[" (columna: ",e.column,")"]})]})]},n))})]}),a.length>0&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{className:"section-title",style:{color:"#ff9800"},children:[(0,y.jsx)(G.A,{size:20}),"Advertencias (",a.length,")"]}),(0,y.jsx)("div",{className:"issues-list",children:a.map((e,n)=>(0,y.jsxs)("div",{className:"issue-item warning",children:[(0,y.jsx)(G.A,{size:18,color:"#ff9800"}),(0,y.jsxs)("div",{children:[e.message,e.column&&(0,y.jsxs)("span",{style:{color:"#666"},children:[" (columna: ",e.column,")"]})]})]},n))})]})]})})(),Object.keys(o.headerMapping).length>0&&(0,y.jsxs)("div",{className:"schema-mapping",children:[(0,y.jsx)("div",{className:"schema-mapping-title",children:"\ud83d\udccb Schema Aplicado - Mapeo de Columnas"}),(0,y.jsxs)("div",{className:"mapping-list",children:[Object.entries(o.headerMapping).slice(0,10).map(e=>{let[n,a]=e;return(0,y.jsxs)("div",{className:"mapping-item",children:[(0,y.jsx)("span",{style:{color:"#666"},children:n}),(0,y.jsx)("span",{className:"mapping-arrow",children:"\u2192"}),(0,y.jsx)("span",{style:{fontWeight:600},children:a})]},n)}),Object.keys(o.headerMapping).length>10&&(0,y.jsxs)("div",{className:"mapping-item",style:{color:"#999",fontStyle:"italic"},children:["... y ",Object.keys(o.headerMapping).length-10," m\xe1s"]})]})]}),(0,y.jsxs)("div",{className:"section-title",children:[(0,y.jsx)(T.A,{size:20}),"An\xe1lisis Descriptivo de Columnas"]}),(0,y.jsxs)("table",{className:"columns-table",children:[(0,y.jsx)("thead",{children:(0,y.jsxs)("tr",{children:[(0,y.jsx)("th",{children:"Columna"}),(0,y.jsx)("th",{children:"Tipo"}),(0,y.jsx)("th",{children:"Completitud"}),(0,y.jsx)("th",{children:"Valores \xdanicos"}),(0,y.jsx)("th",{children:"Estad\xedsticas"})]})}),(0,y.jsx)("tbody",{children:o.columns.map(e=>{var n,a,t;return(0,y.jsxs)("tr",{className:(null===l||void 0===l?void 0:l.columnName)===e.columnName?"selected":"",onClick:()=>c(e),children:[(0,y.jsxs)("td",{children:[(0,y.jsx)("div",{className:"column-name",children:e.columnName}),e.mappedName&&e.mappedName!==e.columnName&&(0,y.jsxs)("div",{className:"column-mapped",children:["\u2192 ",e.mappedName]})]}),(0,y.jsx)("td",{children:(0,y.jsxs)("span",{className:"data-type-badge",children:[(0,y.jsx)("span",{children:S(e.dataType)}),(0,y.jsx)("span",{children:e.dataType})]})}),(0,y.jsxs)("td",{children:[(0,y.jsx)("div",{className:"completeness-bar",children:(0,y.jsx)("div",{className:"completeness-fill ".concat(e.completeness<50?"low":e.completeness<80?"medium":""),style:{width:"".concat(e.completeness,"%")}})}),(0,y.jsxs)("div",{style:{fontSize:"0.8em",marginTop:"3px"},children:[e.completeness.toFixed(1),"%"]})]}),(0,y.jsxs)("td",{children:[e.uniqueCount.toLocaleString(),(0,y.jsxs)("div",{style:{fontSize:"0.8em",color:"#666"},children:["(",e.distinctness.toFixed(1),"%)"]})]}),(0,y.jsxs)("td",{children:[void 0!==e.min&&(0,y.jsxs)("div",{style:{fontSize:"0.85em"},children:["Min: ",e.min.toLocaleString(),(0,y.jsx)("br",{}),"Max: ",null===(n=e.max)||void 0===n?void 0:n.toLocaleString(),(0,y.jsx)("br",{}),"Media: ",null===(a=e.mean)||void 0===a?void 0:a.toLocaleString()]}),void 0!==e.minLength&&(0,y.jsxs)("div",{style:{fontSize:"0.85em"},children:["Long: ",e.minLength,"-",e.maxLength,(0,y.jsx)("br",{}),"Promedio: ",null===(t=e.avgLength)||void 0===t?void 0:t.toFixed(1)]})]})]},e.columnName)})})]}),l&&(0,y.jsxs)("div",{className:"column-detail",children:[(0,y.jsxs)("div",{className:"column-detail-title",children:["Detalle de Columna: ",l.columnName]}),(0,y.jsxs)("div",{className:"column-detail-grid",children:[(0,y.jsxs)("div",{className:"detail-stat",children:[(0,y.jsx)("div",{className:"detail-stat-label",children:"Tipo de Dato"}),(0,y.jsxs)("div",{className:"detail-stat-value",children:[S(l.dataType)," ",l.dataType]})]}),(0,y.jsxs)("div",{className:"detail-stat",children:[(0,y.jsx)("div",{className:"detail-stat-label",children:"Confianza"}),(0,y.jsxs)("div",{className:"detail-stat-value",children:[(100*l.confidence).toFixed(0),"%"]})]}),(0,y.jsxs)("div",{className:"detail-stat",children:[(0,y.jsx)("div",{className:"detail-stat-label",children:"Total Valores"}),(0,y.jsx)("div",{className:"detail-stat-value",children:l.totalValues.toLocaleString()})]}),(0,y.jsxs)("div",{className:"detail-stat",children:[(0,y.jsx)("div",{className:"detail-stat-label",children:"Valores Nulos"}),(0,y.jsx)("div",{className:"detail-stat-value",children:l.nullCount.toLocaleString()})]})]}),l.sampleValues.length>0&&(0,y.jsxs)("div",{className:"sample-values",children:[(0,y.jsx)("div",{className:"sample-values-title",children:"Valores de Muestra:"}),(0,y.jsx)("div",{className:"sample-chips",children:l.sampleValues.map((e,n)=>(0,y.jsxs)("div",{className:"sample-chip",children:[String(e).substring(0,50),String(e).length>50?"...":""]},n))})]}),l.topValues&&l.topValues.length>0&&(0,y.jsxs)("div",{className:"sample-values",children:[(0,y.jsx)("div",{className:"sample-values-title",children:"Valores M\xe1s Frecuentes:"}),(0,y.jsxs)("table",{className:"top-values-table",children:[(0,y.jsx)("thead",{children:(0,y.jsxs)("tr",{children:[(0,y.jsx)("th",{children:"Valor"}),(0,y.jsx)("th",{children:"Frecuencia"}),(0,y.jsx)("th",{children:"Porcentaje"})]})}),(0,y.jsx)("tbody",{children:l.topValues.slice(0,10).map((e,n)=>(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{children:String(e.value).substring(0,50)}),(0,y.jsx)("td",{children:e.count.toLocaleString()}),(0,y.jsxs)("td",{children:[e.percentage.toFixed(2),"%"]})]},n))})]})]}),l.issues&&l.issues.length>0&&(0,y.jsxs)("div",{className:"sample-values",children:[(0,y.jsx)("div",{className:"sample-values-title",children:"\u26a0\ufe0f Problemas de Calidad:"}),(0,y.jsx)("div",{style:{paddingLeft:"10px"},children:l.issues.map((e,n)=>(0,y.jsxs)("div",{style:{marginBottom:"5px",color:"#f57c00"},children:["\u2022 ",e]},n))})]}),l.patterns&&l.patterns.length>0&&(0,y.jsxs)("div",{className:"sample-values",children:[(0,y.jsx)("div",{className:"sample-values-title",children:"\ud83d\udd0d Patrones Detectados:"}),(0,y.jsx)("div",{style:{paddingLeft:"10px"},children:l.patterns.map((e,n)=>(0,y.jsxs)("div",{style:{marginBottom:"5px",color:"#1976d2"},children:["\u2022 ",e]},n))})]})]})]}):(0,y.jsxs)("div",{style:{textAlign:"center",padding:"60px",color:"#999"},children:[(0,y.jsx)(w.A,{size:64,color:"#ccc"}),(0,y.jsx)("p",{style:{marginTop:"20px",fontSize:"1.1em"},children:"Selecciona una tabla para ver su an\xe1lisis detallado"})]})})]})]})},ne=(0,l.A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),ae=e=>{let{steps:n,onComplete:a,onSkip:s,autoStart:i=!1}=e;const[o,r]=(0,t.useState)(0),[l,c]=(0,t.useState)(i),[p,m]=(0,t.useState)(null);(0,t.useEffect)(()=>{i&&(c(!0),r(0))},[i]),(0,t.useEffect)(()=>{const e=n[o],a=(null===e||void 0===e?void 0:e.targetSelector)||(null===e||void 0===e?void 0:e.target);if(l&&a)return h(),window.addEventListener("resize",h),()=>window.removeEventListener("resize",h);m(null),l&&null!==e&&void 0!==e&&e.onEnter&&e.onEnter()},[o,l]);const h=(0,t.useCallback)(()=>{const e=n[o],a=(null===e||void 0===e?void 0:e.targetSelector)||(null===e||void 0===e?void 0:e.target);if(a){const e=document.querySelector(a);e&&m(e.getBoundingClientRect())}else m(null)},[n,o]),g=()=>{c(!1),a()},u=()=>{c(!1),s()};if(!l)return null;const x=n[o],f=(o+1)/n.length*100;return(0,y.jsxs)("div",{className:"guided-tour-overlay",children:[p&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:"tour-spotlight",style:{top:p.top-10,left:p.left-10,width:p.width+20,height:p.height+20}}),x.highlightPulse&&(0,y.jsx)("div",{className:"tour-pulse",style:{top:p.top-10,left:p.left-10,width:p.width+20,height:p.height+20}})]}),(0,y.jsxs)("div",{className:"tour-card ".concat(p&&"center"!==x.position?"tour-card-".concat(x.position||"bottom"):"tour-card-center"),style:p&&"center"!==x.position?{top:"bottom"===x.position?p.bottom+20:"top"===x.position?p.top-220:p.top+p.height/2-100,left:"right"===x.position?p.right+20:"left"===x.position?p.left-420:p.left+p.width/2-200}:{},children:[(0,y.jsxs)("div",{className:"tour-card-header",children:[(0,y.jsxs)("div",{className:"tour-step-info",children:[(0,y.jsxs)("span",{className:"tour-step-badge",children:["Paso ",o+1," de ",n.length]}),(0,y.jsx)("h3",{className:"tour-title",children:x.title})]}),(0,y.jsx)("button",{className:"tour-close-btn",onClick:u,children:(0,y.jsx)(d.A,{size:20})})]}),(0,y.jsx)("div",{className:"tour-card-body",children:x.content?(0,y.jsx)("div",{className:"tour-content",children:x.content}):(0,y.jsx)("p",{className:"tour-description",children:x.description})}),(0,y.jsxs)("div",{className:"tour-card-footer",children:[(0,y.jsx)("div",{className:"tour-progress",children:(0,y.jsx)("div",{className:"tour-progress-bar",style:{width:"".concat(f,"%")}})}),(0,y.jsxs)("div",{className:"tour-buttons",children:[(0,y.jsx)("button",{className:"tour-btn tour-btn-secondary",onClick:u,children:"Saltar Tour"}),(0,y.jsxs)("div",{className:"tour-nav-buttons",children:[o>0&&(0,y.jsxs)("button",{className:"tour-btn tour-btn-outline",onClick:()=>{o>0&&r(o-1)},children:[(0,y.jsx)(ne,{size:18}),"Anterior"]}),(0,y.jsxs)("button",{className:"tour-btn tour-btn-primary",onClick:async()=>{const e=n[o];e.action&&await e.action(),o<n.length-1?r(o+1):g()},children:[o===n.length-1?"Finalizar":"Siguiente",o<n.length-1&&(0,y.jsx)(D,{size:18})]})]})]})]})]})]})},te=(0,l.A)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]]);var se=a(8562);const ie=(0,l.A)("file-check",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]),oe=e=>{let{onDataReady:n,onLaunchApp:a,onGoBack:s,startTour:i=!1,onTourComplete:o}=e;const[l,c]=(0,t.useState)("upload"),[d,p]=(0,t.useState)(!1),[m,g]=(0,t.useState)(!1),[u,x]=(0,t.useState)(!0);(0,t.useEffect)(()=>{if(i&&!u){const e=setTimeout(()=>{g(!0),c("upload")},300);return()=>clearTimeout(e)}},[i,u]),(0,t.useEffect)(()=>{(async()=>{try{const e=await h.q.getMetadata(),a=e.files.length>0;p(a),a?(console.log("\u2705 Datos detectados en cach\xe9: ".concat(e.files.length," archivos, ").concat(e.totalRecords," registros")),null===n||void 0===n||n()):console.log("\u2139\ufe0f No hay datos en el cach\xe9")}catch(e){console.error("Error verificando datos en cach\xe9:",e),p(!1)}finally{x(!1)}})()},[n]);const f=[{id:"welcome",title:"\ud83c\udf93 Bienvenido al Sistema de Gesti\xf3n de Datos SICOP",content:(0,y.jsxs)("div",{children:[(0,y.jsx)("p",{children:(0,y.jsx)("strong",{children:"Este tour te mostrar\xe1 el flujo completo de trabajo:"})}),(0,y.jsxs)("ol",{style:{textAlign:"left",marginLeft:"20px",marginTop:"10px"},children:[(0,y.jsxs)("li",{children:["\ud83d\udcc1 ",(0,y.jsx)("strong",{children:"Cargar"})," archivos CSV"]}),(0,y.jsxs)("li",{children:["\u2705 ",(0,y.jsx)("strong",{children:"Validar"})," datos (an\xe1lisis general)"]}),(0,y.jsxs)("li",{children:["\ud83d\udd0d ",(0,y.jsx)("strong",{children:"Schema"})," (an\xe1lisis detallado si hay errores)"]}),(0,y.jsxs)("li",{children:["\ufffd ",(0,y.jsx)("strong",{children:"Cache"})," (revisar datos hist\xf3ricos)"]}),(0,y.jsxs)("li",{children:["\ud83d\udcca ",(0,y.jsx)("strong",{children:"An\xe1lisis"})," (exportar - opcional)"]}),(0,y.jsxs)("li",{children:["\ud83d\uddd1\ufe0f ",(0,y.jsx)("strong",{children:"Limpiar"})," cache cuando sea necesario"]}),(0,y.jsxs)("li",{children:["\ud83d\ude80 ",(0,y.jsx)("strong",{children:"Lanzar"})," aplicaci\xf3n principal"]})]}),(0,y.jsxs)("p",{style:{marginTop:"15px",fontSize:"0.9em",opacity:.8},children:["\ud83d\udca1 ",(0,y.jsx)("em",{children:"Seguiremos el flujo profesional de trabajo con datos."})]})]}),position:"center"},{id:"upload-tab",title:"\ud83d\udcc1 Paso 1: Cargar Archivos CSV",content:(0,y.jsxs)("div",{children:[(0,y.jsx)("p",{children:(0,y.jsx)("strong",{children:"Todo empieza aqu\xed: carga tus archivos CSV de SICOP."})}),(0,y.jsx)("p",{children:"Funcionalidades:"}),(0,y.jsxs)("ul",{style:{textAlign:"left",marginLeft:"20px",marginTop:"10px"},children:[(0,y.jsx)("li",{children:"\u2728 Arrastra y suelta archivos CSV"}),(0,y.jsx)("li",{children:"\ud83d\udcc2 Selecciona m\xfaltiples archivos a la vez"}),(0,y.jsx)("li",{children:"\u26a1 Progreso de carga en tiempo real"}),(0,y.jsx)("li",{children:"\ud83d\udcbe Guardado autom\xe1tico en cach\xe9"})]}),(0,y.jsxs)("p",{style:{marginTop:"10px",fontSize:"0.9em",color:"#667eea"},children:["\ufffd ",(0,y.jsx)("em",{children:"Los datos quedan disponibles para an\xe1lisis inmediato."})]})]}),targetSelector:'[data-tour="upload-tab"]',position:"bottom"},{id:"upload-area",title:"\ud83d\udce4 Zona de Carga - Tipos de Archivos",content:(0,y.jsxs)("div",{children:[(0,y.jsx)("p",{children:(0,y.jsx)("strong",{children:"Aqu\xed arrastras tus archivos CSV de SICOP."})}),(0,y.jsx)("p",{children:"Archivos soportados:"}),(0,y.jsxs)("ul",{style:{textAlign:"left",marginLeft:"20px",marginTop:"10px"},children:[(0,y.jsxs)("li",{children:["\ud83c\udfdb\ufe0f ",(0,y.jsx)("strong",{children:"Carteles"})," - Licitaciones p\xfablicas"]}),(0,y.jsxs)("li",{children:["\ud83d\udcc4 ",(0,y.jsx)("strong",{children:"Contratos"})," - Contratos adjudicados"]}),(0,y.jsxs)("li",{children:["\ud83d\udeab ",(0,y.jsx)("strong",{children:"Sanciones"})," - Proveedores sancionados"]}),(0,y.jsxs)("li",{children:["\ud83d\udce8 ",(0,y.jsx)("strong",{children:"Invitaciones"})," - Procedimientos por invitaci\xf3n"]}),(0,y.jsxs)("li",{children:["\ud83d\uddf3\ufe0f ",(0,y.jsx)("strong",{children:"Votaciones"})," - Resultados de votaciones"]})]}),(0,y.jsxs)("p",{style:{marginTop:"10px",fontSize:"0.9em",color:"#667eea"},children:["\ud83d\udca1 ",(0,y.jsx)("em",{children:"El sistema detecta autom\xe1ticamente el tipo de cada archivo."})]})]}),targetSelector:".file-uploader",position:"right"},{id:"validation-tab",title:"\u2705 Paso 2: Validaci\xf3n - An\xe1lisis General",content:(0,y.jsxs)("div",{children:[(0,y.jsx)("p",{children:(0,y.jsx)("strong",{children:"IMPORTANTE: Despu\xe9s de cargar, siempre revisa la validaci\xf3n primero."})}),(0,y.jsx)("p",{children:"Aqu\xed ver\xe1s el an\xe1lisis general de calidad:"}),(0,y.jsxs)("ul",{style:{textAlign:"left",marginLeft:"20px",marginTop:"10px"},children:[(0,y.jsx)("li",{children:"\u26a0\ufe0f Campos vac\xedos o incompletos"}),(0,y.jsx)("li",{children:"\ufffd Errores de formato"}),(0,y.jsx)("li",{children:"\u26a1 Registros duplicados"}),(0,y.jsx)("li",{children:"\ufffd Estad\xedsticas de calidad general"})]}),(0,y.jsxs)("p",{style:{marginTop:"10px",fontSize:"0.9em",color:"#ff6b6b"},children:["\ufffd ",(0,y.jsx)("em",{children:'Si hay muchos errores, pasa a la pesta\xf1a "Schema" para an\xe1lisis detallado.'})]})]}),targetSelector:'[data-tour="validation-tab"]',position:"bottom",onEnter:()=>c("validation")},{id:"schema-tab",title:"\ufffd Paso 3: An\xe1lisis de Schema - Diagn\xf3stico Profundo",content:(0,y.jsxs)("div",{children:[(0,y.jsx)("p",{children:(0,y.jsx)("strong",{children:"Si la validaci\xf3n muestra errores, usa esta pesta\xf1a para identificar QU\xc9 est\xe1 pasando."})}),(0,y.jsx)("p",{children:"An\xe1lisis detallado por archivo:"}),(0,y.jsxs)("ul",{style:{textAlign:"left",marginLeft:"20px",marginTop:"10px"},children:[(0,y.jsx)("li",{children:"\ud83d\udccb Estructura de columnas detectadas"}),(0,y.jsx)("li",{children:"\ud83d\udd22 Tipos de datos por campo"}),(0,y.jsx)("li",{children:"\ud83d\udcca Valores \xfanicos y estad\xedsticas"}),(0,y.jsx)("li",{children:"\u26a0\ufe0f Inconsistencias en el schema"})]}),(0,y.jsxs)("p",{style:{marginTop:"10px",fontSize:"0.9em",color:"#667eea"},children:["\ufffd ",(0,y.jsx)("em",{children:"Te ayuda a identificar problemas en la estructura de los archivos CSV."})]})]}),targetSelector:'[data-tour="schema-tab"]',position:"bottom",onEnter:()=>c("schema")},{id:"manage-tab",title:"\ufffd Paso 4: Gestionar Cache - Datos Hist\xf3ricos",content:(0,y.jsxs)("div",{children:[(0,y.jsx)("p",{children:(0,y.jsx)("strong",{children:"Aqu\xed revisas TODOS los datos guardados: actuales e hist\xf3ricos."})}),(0,y.jsx)("p",{children:"Informaci\xf3n disponible:"}),(0,y.jsxs)("ul",{style:{textAlign:"left",marginLeft:"20px",marginTop:"10px"},children:[(0,y.jsx)("li",{children:"\ufffd Lista completa de archivos cargados"}),(0,y.jsx)("li",{children:"\ud83d\udcc5 Fechas de carga de cada archivo"}),(0,y.jsx)("li",{children:"\ud83d\udd22 N\xfamero de registros por tipo"}),(0,y.jsx)("li",{children:"\ud83d\udcbe Tama\xf1o total del cach\xe9"})]}),(0,y.jsxs)("p",{style:{marginTop:"10px",fontSize:"0.9em",color:"#667eea"},children:["\ufffd ",(0,y.jsx)("em",{children:"\xdatil para verificar qu\xe9 datos tienes disponibles para an\xe1lisis."})]})]}),targetSelector:'[data-tour="manage-tab"]',position:"bottom",onEnter:()=>c("manage")},{id:"cache-manager",title:"\ud83d\udcc2 Vista Detallada del Cache",content:(0,y.jsxs)("div",{children:[(0,y.jsx)("p",{children:(0,y.jsx)("strong",{children:"Detalle de cada archivo guardado en el cach\xe9:"})}),(0,y.jsxs)("ul",{style:{textAlign:"left",marginLeft:"20px",marginTop:"10px"},children:[(0,y.jsx)("li",{children:"\ud83c\udff7\ufe0f Tipo de archivo (Cartel, Contrato, etc.)"}),(0,y.jsx)("li",{children:"\ud83d\udd22 Cantidad exacta de registros"}),(0,y.jsx)("li",{children:"\ud83d\udcca Porcentaje del total de datos"}),(0,y.jsx)("li",{children:"\ud83d\uddd1\ufe0f Eliminar archivos individuales si es necesario"})]})]}),targetSelector:".cache-manager",position:"left"},{id:"analyze-tab",title:"\ud83d\udcc8 Paso 5: An\xe1lisis de Datos (Opcional)",content:(0,y.jsxs)("div",{children:[(0,y.jsx)("p",{children:(0,y.jsx)("strong",{children:"Esta pesta\xf1a es OPCIONAL: \xfasala para exportar o transformar datos."})}),(0,y.jsx)("p",{children:"Funciones avanzadas:"}),(0,y.jsxs)("ul",{style:{textAlign:"left",marginLeft:"20px",marginTop:"10px"},children:[(0,y.jsx)("li",{children:"\ud83d\udce5 Exportar datos consolidados (CSV/Excel)"}),(0,y.jsx)("li",{children:"\ud83d\udcca Generar reportes personalizados"}),(0,y.jsx)("li",{children:"\ud83d\udd0d Aplicar filtros y transformaciones"}),(0,y.jsx)("li",{children:"\ud83d\udcc8 Visualizar estad\xedsticas agregadas"})]}),(0,y.jsxs)("p",{style:{marginTop:"10px",fontSize:"0.9em",color:"#667eea"},children:["\ud83d\udca1 ",(0,y.jsx)("em",{children:"No es necesario para continuar a la aplicaci\xf3n principal."})]})]}),targetSelector:'[data-tour="analyze-tab"]',position:"bottom",onEnter:()=>c("analyze")},{id:"clear-cache-button",title:"\ud83d\uddd1\ufe0f Paso 6: Limpiar Cache",content:(0,y.jsxs)("div",{children:[(0,y.jsx)("p",{children:(0,y.jsx)("strong",{children:"Usa este bot\xf3n cuando necesites empezar de cero."})}),(0,y.jsx)("p",{children:"\xbfCu\xe1ndo limpiar el cach\xe9?"}),(0,y.jsxs)("ul",{style:{textAlign:"left",marginLeft:"20px",marginTop:"10px"},children:[(0,y.jsx)("li",{children:"\ud83d\udd04 Tienes nuevos archivos con datos actualizados"}),(0,y.jsx)("li",{children:"\u26a0\ufe0f Los datos actuales tienen muchos errores"}),(0,y.jsx)("li",{children:"\ufffd Quieres liberar espacio en el navegador"}),(0,y.jsx)("li",{children:"\ud83d\udd27 Necesitas empezar un an\xe1lisis completamente nuevo"})]}),(0,y.jsxs)("p",{style:{marginTop:"10px",fontSize:"0.9em",color:"#ff6b6b"},children:["\u26a0\ufe0f ",(0,y.jsx)("em",{children:"CUIDADO: Esta acci\xf3n elimina TODOS los datos guardados y NO se puede deshacer."})]})]}),targetSelector:".clear-cache-button",position:"bottom"},{id:"app-button",title:"\ud83d\ude80 Paso 7: Lanzar Aplicaci\xf3n Principal",content:(0,y.jsxs)("div",{children:[(0,y.jsx)("p",{children:(0,y.jsx)("strong",{children:"Una vez validados tus datos, este bot\xf3n te lleva a los dashboards."})}),(0,y.jsx)("p",{children:"En la aplicaci\xf3n principal podr\xe1s:"}),(0,y.jsxs)("ul",{style:{textAlign:"left",marginLeft:"20px",marginTop:"10px"},children:[(0,y.jsx)("li",{children:"\ud83d\udcca Ver dashboards interactivos con gr\xe1ficas"}),(0,y.jsx)("li",{children:"\ud83c\udfdb\ufe0f Analizar instituciones y proveedores"}),(0,y.jsx)("li",{children:"\ud83d\udcc8 Generar reportes ejecutivos avanzados"}),(0,y.jsx)("li",{children:"\ud83d\udd0d Explorar datos con filtros din\xe1micos"}),(0,y.jsx)("li",{children:"\ud83d\udcc9 An\xe1lisis de tendencias y estad\xedsticas"})]}),(0,y.jsxs)("p",{style:{marginTop:"10px",fontSize:"0.9em",color:"#667eea"},children:["\u2705 ",(0,y.jsx)("em",{children:"El bot\xf3n se activa autom\xe1ticamente cuando hay datos en cach\xe9."})]})]}),targetSelector:".launch-app-button",position:"bottom"},{id:"complete",title:"\ud83c\udf89 \xa1Tour Completado!",content:(0,y.jsxs)("div",{children:[(0,y.jsx)("p",{children:(0,y.jsx)("strong",{children:"Ahora conoces el flujo profesional de trabajo con datos SICOP."})}),(0,y.jsx)("p",{style:{marginTop:"15px"},children:"Resumen del flujo:"}),(0,y.jsxs)("ol",{style:{textAlign:"left",marginLeft:"20px",marginTop:"10px",lineHeight:"1.8"},children:[(0,y.jsxs)("li",{children:[(0,y.jsx)("strong",{children:"Cargar"})," \u2192 Sube tus CSV"]}),(0,y.jsxs)("li",{children:[(0,y.jsx)("strong",{children:"Validar"})," \u2192 Revisa calidad general"]}),(0,y.jsxs)("li",{children:[(0,y.jsx)("strong",{children:"Schema"})," \u2192 Diagn\xf3stico si hay errores"]}),(0,y.jsxs)("li",{children:[(0,y.jsx)("strong",{children:"Cache"})," \u2192 Ver datos hist\xf3ricos"]}),(0,y.jsxs)("li",{children:[(0,y.jsx)("strong",{children:"An\xe1lisis"})," \u2192 Exportar (opcional)"]}),(0,y.jsxs)("li",{children:[(0,y.jsx)("strong",{children:"Limpiar"})," \u2192 Cuando sea necesario"]}),(0,y.jsxs)("li",{children:[(0,y.jsx)("strong",{children:"Lanzar"})," \u2192 Ir a dashboards"]})]}),(0,y.jsx)("p",{style:{marginTop:"15px",fontSize:"0.95em",fontWeight:"bold",color:"#667eea"},children:"\u2728 \xa1Est\xe1s listo para trabajar profesionalmente con tus datos!"})]}),position:"center"}],b=()=>{g(!1),c("upload"),null===o||void 0===o||o(),console.log("\u2705 Tour guiado completado")};return(0,y.jsxs)("div",{className:"data-management-hub",children:[(0,y.jsx)("style",{children:"\n        .data-management-hub {\n          min-height: 100vh;\n          background: linear-gradient(135deg, #f0f4f8 0%, #e2e8f0 100%);\n          position: relative;\n          overflow-x: hidden;\n        }\n\n        /* Background decorative elements */\n        .data-management-hub::before {\n          content: '';\n          position: fixed;\n          top: -50%;\n          right: -10%;\n          width: 600px;\n          height: 600px;\n          background: radial-gradient(circle, rgba(102, 126, 234, 0.08) 0%, transparent 70%);\n          border-radius: 50%;\n          pointer-events: none;\n          animation: float 20s ease-in-out infinite;\n        }\n\n        .data-management-hub::after {\n          content: '';\n          position: fixed;\n          bottom: -50%;\n          left: -10%;\n          width: 600px;\n          height: 600px;\n          background: radial-gradient(circle, rgba(118, 75, 162, 0.08) 0%, transparent 70%);\n          border-radius: 50%;\n          pointer-events: none;\n          animation: float 25s ease-in-out infinite reverse;\n        }\n\n        @keyframes float {\n          0%, 100% { transform: translate(0, 0) scale(1); }\n          50% { transform: translate(30px, -30px) scale(1.05); }\n        }\n\n        .hub-header {\n          background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 25%, #0369a1 50%, #075985 75%, #0c4a6e 100%);\n          color: white;\n          padding: 40px 50px;\n          box-shadow: 0 10px 30px rgba(30, 58, 138, 0.3);\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          position: relative;\n          z-index: 10;\n          border-bottom: 4px solid rgba(255, 255, 255, 0.15);\n        }\n\n        .hub-header::before {\n          content: '';\n          position: absolute;\n          top: 0;\n          left: 0;\n          right: 0;\n          bottom: 0;\n          background: \n            radial-gradient(circle at 20% 50%, rgba(59, 130, 246, 0.2) 0%, transparent 50%),\n            radial-gradient(circle at 80% 50%, rgba(14, 165, 233, 0.15) 0%, transparent 50%);\n          pointer-events: none;\n        }\n\n        .hub-header-content {\n          flex: 1;\n          position: relative;\n          z-index: 1;\n        }\n\n        .hub-header-actions {\n          display: flex;\n          gap: 12px;\n          position: relative;\n          z-index: 1;\n        }\n\n        .back-home-button {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n          padding: 12px 24px;\n          background: rgba(255, 255, 255, 0.15);\n          color: white;\n          border: 2px solid rgba(255, 255, 255, 0.3);\n          border-radius: 12px;\n          font-size: 0.95em;\n          font-weight: 600;\n          cursor: pointer;\n          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n          backdrop-filter: blur(10px);\n        }\n\n        .back-home-button:hover {\n          background: white;\n          color: #1e3a8a;\n          transform: translateY(-3px);\n          box-shadow: 0 8px 25px rgba(255, 255, 255, 0.4);\n          border-color: white;\n        }\n\n        .clear-cache-button {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n          padding: 12px 24px;\n          background: linear-gradient(135deg, #ff4444 0%, #cc0000 100%);\n          color: white;\n          border: none;\n          border-radius: 12px;\n          font-size: 0.95em;\n          font-weight: 600;\n          cursor: pointer;\n          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n          box-shadow: 0 4px 15px rgba(255, 68, 68, 0.3);\n        }\n\n        .clear-cache-button:hover {\n          background: linear-gradient(135deg, #ff0000 0%, #aa0000 100%);\n          transform: translateY(-3px);\n          box-shadow: 0 8px 25px rgba(255, 68, 68, 0.5);\n        }\n\n        .launch-app-button {\n          display: flex;\n          align-items: center;\n          gap: 10px;\n          padding: 14px 28px;\n          background: white;\n          color: #1e3a8a;\n          border: 2px solid white;\n          border-radius: 12px;\n          font-size: 1.05em;\n          font-weight: 700;\n          cursor: pointer;\n          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n          box-shadow: 0 6px 20px rgba(255, 255, 255, 0.3);\n          position: relative;\n          overflow: hidden;\n        }\n\n        .launch-app-button::before {\n          content: '';\n          position: absolute;\n          top: 0;\n          left: -100%;\n          width: 100%;\n          height: 100%;\n          background: linear-gradient(90deg, transparent, rgba(30, 58, 138, 0.1), transparent);\n          transition: left 0.5s;\n        }\n\n        .launch-app-button:hover::before {\n          left: 100%;\n        }\n\n        .launch-app-button:hover {\n          transform: translateY(-3px) scale(1.02);\n          box-shadow: 0 10px 30px rgba(255, 255, 255, 0.5);\n          background: #f8f9ff;\n        }\n\n        .launch-app-button:disabled {\n          opacity: 0.4;\n          cursor: not-allowed;\n          background: rgba(255, 255, 255, 0.5);\n        }\n\n        .launch-app-button:disabled:hover {\n          transform: none;\n          box-shadow: 0 6px 20px rgba(255, 255, 255, 0.3);\n        }\n\n        .hub-title {\n          font-size: 2.2em;\n          font-weight: 800;\n          margin: 0 0 10px 0;\n          letter-spacing: -0.5px;\n          color: white;\n          text-shadow: \n            0 2px 10px rgba(0, 0, 0, 0.3),\n            0 0 30px rgba(30, 58, 138, 0.5),\n            0 0 60px rgba(14, 74, 110, 0.3);\n        }\n\n        .hub-subtitle {\n          font-size: 1.15em;\n          opacity: 0.95;\n          margin: 0;\n          font-weight: 600;\n          color: rgba(255, 255, 255, 0.95);\n          text-shadow: \n            0 1px 3px rgba(0, 0, 0, 0.2),\n            0 0 20px rgba(30, 58, 138, 0.3);\n        }\n\n        .hub-tabs {\n          display: flex;\n          gap: 0;\n          background: white;\n          border-bottom: 2px solid #e0e7ef;\n          padding: 0 50px;\n          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);\n          position: relative;\n          z-index: 5;\n        }\n\n        .hub-tab {\n          display: flex;\n          align-items: center;\n          gap: 10px;\n          padding: 20px 32px;\n          border: none;\n          background: none;\n          cursor: pointer;\n          font-size: 1em;\n          font-weight: 600;\n          color: #64748b;\n          border-bottom: 3px solid transparent;\n          transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n          position: relative;\n          overflow: hidden;\n        }\n\n        .hub-tab::before {\n          content: '';\n          position: absolute;\n          bottom: 0;\n          left: 50%;\n          transform: translateX(-50%) scaleX(0);\n          width: 100%;\n          height: 3px;\n          background: linear-gradient(90deg, #1e3a8a, #0c4a6e);\n          transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n        }\n\n        .hub-tab:hover {\n          color: #1e3a8a;\n          background: linear-gradient(180deg, rgba(30, 58, 138, 0.08) 0%, rgba(30, 58, 138, 0.02) 100%);\n        }\n\n        .hub-tab:hover::before {\n          transform: translateX(-50%) scaleX(0.5);\n        }\n\n        .hub-tab.active {\n          color: #1e3a8a;\n          border-bottom-color: transparent;\n          background: linear-gradient(180deg, rgba(30, 58, 138, 0.12) 0%, rgba(30, 58, 138, 0.04) 100%);\n          font-weight: 700;\n        }\n\n        .hub-tab.active::before {\n          transform: translateX(-50%) scaleX(1);\n        }\n\n        .hub-tab-badge {\n          background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);\n          color: white;\n          padding: 4px 10px;\n          border-radius: 12px;\n          font-size: 0.75em;\n          font-weight: 700;\n          box-shadow: 0 2px 6px rgba(76, 175, 80, 0.3);\n        }\n\n        .hub-content {\n          padding: 50px 60px;\n          max-width: 1600px;\n          margin: 0 auto;\n          background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);\n          border-radius: 0 0 16px 16px;\n          box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.03);\n          min-height: 500px;\n        }\n\n        .welcome-section {\n          background: linear-gradient(135deg, #ffffff 0%, #f8faff 100%);\n          border-radius: 20px;\n          padding: 70px;\n          text-align: center;\n          box-shadow: 0 8px 24px rgba(30, 58, 138, 0.08);\n          border: 1px solid rgba(30, 58, 138, 0.1);\n          position: relative;\n          overflow: hidden;\n        }\n\n        .welcome-section::before {\n          content: '';\n          position: absolute;\n          top: -50%;\n          right: -50%;\n          width: 100%;\n          height: 100%;\n          background: radial-gradient(circle, rgba(30, 58, 138, 0.08) 0%, transparent 70%);\n          pointer-events: none;\n        }\n\n        .welcome-icon {\n          margin: 0 auto 30px;\n          color: #1e3a8a;\n          filter: drop-shadow(0 4px 12px rgba(30, 58, 138, 0.3));\n          position: relative;\n          z-index: 1;\n        }\n\n        .welcome-title {\n          font-size: 2.2em;\n          font-weight: 800;\n          color: #1e293b;\n          margin: 0 0 15px 0;\n          letter-spacing: -0.5px;\n          position: relative;\n          z-index: 1;\n        }\n\n        .welcome-text {\n          font-size: 1.15em;\n          color: #64748b;\n          margin: 0 0 30px 0;\n          line-height: 1.7;\n          max-width: 700px;\n          margin-left: auto;\n          margin-right: auto;\n          position: relative;\n          z-index: 1;\n        }\n\n        .welcome-features {\n          display: grid;\n          grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\n          gap: 30px;\n          margin-top: 50px;\n          text-align: left;\n          position: relative;\n          z-index: 1;\n        }\n\n        .feature-card {\n          background: linear-gradient(135deg, #ffffff 0%, #f8faff 100%);\n          padding: 30px;\n          border-radius: 16px;\n          border-left: 5px solid #667eea;\n          box-shadow: 0 4px 16px rgba(102, 126, 234, 0.08);\n          transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n          border: 1px solid rgba(102, 126, 234, 0.1);\n          position: relative;\n          overflow: hidden;\n        }\n\n        .feature-card::before {\n          content: '';\n          position: absolute;\n          top: 0;\n          left: 0;\n          width: 100%;\n          height: 100%;\n          background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, transparent 50%);\n          opacity: 0;\n          transition: opacity 0.4s;\n        }\n\n        .feature-card:hover {\n          transform: translateY(-8px);\n          box-shadow: 0 12px 32px rgba(102, 126, 234, 0.15);\n          border-left-width: 5px;\n        }\n\n        .feature-card:hover::before {\n          opacity: 1;\n        }\n\n        .feature-icon {\n          color: #667eea;\n          margin-bottom: 15px;\n          filter: drop-shadow(0 2px 6px rgba(102, 126, 234, 0.25));\n          position: relative;\n          z-index: 1;\n        }\n\n        .feature-title {\n          font-size: 1.25em;\n          font-weight: 700;\n          color: #1e293b;\n          margin: 0 0 12px 0;\n          position: relative;\n          z-index: 1;\n        }\n\n        .feature-description {\n          color: #64748b;\n          line-height: 1.6;\n          margin: 0;\n          position: relative;\n          z-index: 1;\n        }\n\n        .cta-button {\n          display: inline-flex;\n          align-items: center;\n          gap: 12px;\n          padding: 16px 36px;\n          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n          color: white;\n          border: none;\n          border-radius: 12px;\n          font-size: 1.15em;\n          font-weight: 700;\n          cursor: pointer;\n          transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n          box-shadow: 0 6px 20px rgba(102, 126, 234, 0.35);\n          position: relative;\n          overflow: hidden;\n        }\n\n        .cta-button::before {\n          content: '';\n          position: absolute;\n          top: 0;\n          left: -100%;\n          width: 100%;\n          height: 100%;\n          background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);\n          transition: left 0.6s;\n        }\n\n        .cta-button:hover::before {\n          left: 100%;\n        }\n\n        .cta-button:hover {\n          transform: translateY(-4px) scale(1.02);\n          box-shadow: 0 12px 32px rgba(102, 126, 234, 0.5);\n        }\n\n        .quick-stats {\n          display: grid;\n          grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));\n          gap: 24px;\n          margin-bottom: 35px;\n        }\n\n        .stat-box {\n          background: linear-gradient(135deg, #ffffff 0%, #f8faff 100%);\n          padding: 24px;\n          border-radius: 16px;\n          box-shadow: 0 4px 16px rgba(102, 126, 234, 0.08);\n          border-left: 5px solid #667eea;\n          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n          border: 1px solid rgba(102, 126, 234, 0.1);\n        }\n\n        .stat-box:hover {\n          transform: translateY(-4px);\n          box-shadow: 0 8px 24px rgba(102, 126, 234, 0.15);\n        }\n\n        .stat-label {\n          font-size: 0.95em;\n          color: #64748b;\n          margin-bottom: 10px;\n          font-weight: 600;\n          text-transform: uppercase;\n          letter-spacing: 0.5px;\n        }\n\n        .stat-value {\n          font-size: 2em;\n          font-weight: 800;\n          color: #1e293b;\n          letter-spacing: -0.5px;\n        }\n\n        /* Responsive Design */\n        @media (max-width: 1024px) {\n          .data-management-hub {\n            padding: 30px;\n          }\n\n          .hub-header {\n            padding: 30px 40px;\n          }\n\n          .hub-title {\n            font-size: 1.8em;\n          }\n\n          .hub-tabs {\n            padding: 0 30px;\n          }\n\n          .hub-content {\n            padding: 35px 40px;\n          }\n\n          .welcome-section {\n            padding: 50px 40px;\n          }\n\n          .welcome-features {\n            grid-template-columns: 1fr;\n          }\n        }\n\n        @media (max-width: 640px) {\n          .data-management-hub {\n            padding: 20px;\n            border-radius: 0;\n          }\n\n          .hub-header {\n            padding: 25px 20px;\n            flex-direction: column;\n            gap: 20px;\n          }\n\n          .hub-header-content {\n            text-align: center;\n          }\n\n          .hub-header-actions {\n            flex-direction: column;\n            width: 100%;\n          }\n\n          .back-home-button,\n          .clear-cache-button,\n          .launch-app-button {\n            width: 100%;\n            justify-content: center;\n          }\n\n          .hub-title {\n            font-size: 1.5em;\n          }\n\n          .hub-subtitle {\n            font-size: 1em;\n          }\n\n          .hub-tabs {\n            padding: 0 15px;\n            overflow-x: auto;\n            flex-wrap: nowrap;\n          }\n\n          .hub-tab {\n            padding: 16px 20px;\n            font-size: 0.9em;\n            white-space: nowrap;\n          }\n\n          .hub-content {\n            padding: 25px 20px;\n          }\n\n          .welcome-section {\n            padding: 35px 25px;\n          }\n\n          .welcome-title {\n            font-size: 1.6em;\n          }\n\n          .welcome-text {\n            font-size: 1em;\n          }\n\n          .quick-stats {\n            grid-template-columns: 1fr;\n          }\n\n          .stat-value {\n            font-size: 1.6em;\n          }\n        }\n      "}),(0,y.jsxs)("div",{className:"hub-header",children:[(0,y.jsxs)("div",{className:"hub-header-content",children:[(0,y.jsx)("h1",{className:"hub-title",children:"Sistema de Gesti\xf3n de Datos SICOP"}),(0,y.jsx)("p",{className:"hub-subtitle",children:"Carga, organiza y consolida archivos CSV por a\xf1o y mes"})]}),(0,y.jsxs)("div",{className:"hub-header-actions",children:[(0,y.jsxs)("button",{className:"back-home-button",onClick:s,title:"Volver a la pantalla de inicio",children:[(0,y.jsx)(te,{size:18}),"Volver al Inicio"]}),(0,y.jsxs)("button",{className:"clear-cache-button",onClick:async()=>{if(window.confirm("\xbfEst\xe1s seguro de que deseas eliminar TODOS los datos guardados? Esta acci\xf3n no se puede deshacer."))try{await h.q.clearCache(),p(!1),c("upload"),console.log("\u2705 Todos los datos han sido eliminados exitosamente."),window.alert("\u2705 Todos los datos han sido eliminados exitosamente.")}catch(e){console.error("Error limpiando cach\xe9:",e),window.alert("\u274c Error al eliminar los datos. Verifica la consola.")}},title:"Eliminar todos los datos guardados",children:[(0,y.jsx)(O.A,{size:18}),"Limpiar Cach\xe9"]}),(0,y.jsxs)("button",{className:"launch-app-button",onClick:a,title:"Ir a la aplicaci\xf3n principal",children:[(0,y.jsx)(se.A,{size:20}),"Ir a Aplicaci\xf3n Principal"]})]})]}),(0,y.jsxs)("div",{className:"hub-tabs",children:[(0,y.jsxs)("button",{className:"hub-tab ".concat("upload"===l?"active":""),onClick:()=>c("upload"),"data-tour":"upload-tab",children:[(0,y.jsx)(r.A,{size:20}),"Cargar Archivos"]}),(0,y.jsxs)("button",{className:"hub-tab ".concat("validation"===l?"active":""),onClick:()=>c("validation"),"data-tour":"validation-tab",children:[(0,y.jsx)(ie,{size:20}),"Validaci\xf3n",d&&(0,y.jsx)("span",{className:"hub-tab-badge",children:"\u2022"})]}),(0,y.jsxs)("button",{className:"hub-tab ".concat("schema"===l?"active":""),onClick:()=>c("schema"),"data-tour":"schema-tab",children:[(0,y.jsx)(Z,{size:20}),"An\xe1lisis de Schema",d&&(0,y.jsx)("span",{className:"hub-tab-badge",children:"\u2022"})]}),(0,y.jsxs)("button",{className:"hub-tab ".concat("manage"===l?"active":""),onClick:()=>c("manage"),"data-tour":"manage-tab",children:[(0,y.jsx)(w.A,{size:20}),"Gestionar Cach\xe9"]}),(0,y.jsxs)("button",{className:"hub-tab ".concat("analyze"===l?"active":""),onClick:()=>c("analyze"),"data-tour":"analyze-tab",children:[(0,y.jsx)(T.A,{size:20}),"Analizar Datos"]})]}),(0,y.jsxs)("div",{className:"hub-content",children:["upload"===l&&(0,y.jsx)(C,{onUploadComplete:()=>{p(!0),c("manage"),null===n||void 0===n||n()}}),"validation"===l&&(0,y.jsx)(X,{}),"schema"===l&&(0,y.jsx)(ee,{}),"manage"===l&&(0,y.jsx)(V,{onDataChange:async()=>{try{const e=(await h.q.getMetadata()).files.length>0;p(e),e&&(null===n||void 0===n||n())}catch(e){console.error("Error verificando cambios en datos:",e)}}}),"analyze"===l&&(0,y.jsx)(Y,{})]}),m&&(0,y.jsx)(ae,{steps:f,onComplete:b,onSkip:b,autoStart:!0})]})},re=oe},2828:(e,n,a)=>{a.d(n,{A:()=>t});const t=(0,a(6230).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},3270:(e,n,a)=>{a.d(n,{A:()=>t});const t=(0,a(6230).A)("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]])},3986:(e,n,a)=>{function t(e,n){if(null==e)return{};var a,t,s=function(e,n){if(null==e)return{};var a={};for(var t in e)if({}.hasOwnProperty.call(e,t)){if(-1!==n.indexOf(t))continue;a[t]=e[t]}return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(t=0;t<i.length;t++)a=i[t],-1===n.indexOf(a)&&{}.propertyIsEnumerable.call(e,a)&&(s[a]=e[a])}return s}a.d(n,{A:()=>t})},4814:(e,n,a)=>{a.d(n,{A:()=>t});const t=(0,a(6230).A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},5833:(e,n,a)=>{a.d(n,{A:()=>t});const t=(0,a(6230).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},5924:(e,n,a)=>{a.d(n,{A:()=>t});const t=(0,a(6230).A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},6230:(e,n,a)=>{a.d(n,{A:()=>m});var t=a(9379),s=a(3986),i=a(9950);const o=e=>{const n=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,a)=>a?a.toUpperCase():n.toLowerCase()))(e);return n.charAt(0).toUpperCase()+n.slice(1)},r=function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return n.filter((e,n,a)=>Boolean(e)&&""!==e.trim()&&a.indexOf(e)===n).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const c=["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"],d=(0,i.forwardRef)((e,n)=>{let{color:a="currentColor",size:o=24,strokeWidth:d=2,absoluteStrokeWidth:p,className:m="",children:h,iconNode:g}=e,u=(0,s.A)(e,c);return(0,i.createElement)("svg",(0,t.A)((0,t.A)((0,t.A)({ref:n},l),{},{width:o,height:o,stroke:a,strokeWidth:p?24*Number(d)/Number(o):d,className:r("lucide",m)},!h&&!(e=>{for(const n in e)if(n.startsWith("aria-")||"role"===n||"title"===n)return!0})(u)&&{"aria-hidden":"true"}),u),[...g.map(e=>{let[n,a]=e;return(0,i.createElement)(n,a)}),...Array.isArray(h)?h:[h]])}),p=["className"],m=(e,n)=>{const a=(0,i.forwardRef)((a,l)=>{let{className:c}=a,m=(0,s.A)(a,p);return(0,i.createElement)(d,(0,t.A)({ref:l,iconNode:n,className:r("lucide-".concat((h=o(e),h.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase())),"lucide-".concat(e),c)},m));var h});return a.displayName=o(e),a}},6355:(e,n,a)=>{a.d(n,{A:()=>t});const t=(0,a(6230).A)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]])},6479:(e,n,a)=>{a.d(n,{A:()=>t});const t=(0,a(6230).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},6890:(e,n,a)=>{a.d(n,{A:()=>t});const t=(0,a(6230).A)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]])},7637:(e,n,a)=>{a.d(n,{A:()=>t});const t=(0,a(6230).A)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},7834:(e,n,a)=>{a.d(n,{A:()=>t});const t=(0,a(6230).A)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},8134:(e,n,a)=>{a.d(n,{A:()=>t});const t=(0,a(6230).A)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},8406:(e,n,a)=>{a.d(n,{A:()=>t});const t=(0,a(6230).A)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]])},8562:(e,n,a)=>{a.d(n,{A:()=>t});const t=(0,a(6230).A)("circle-play",[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},9201:(e,n,a)=>{a.d(n,{A:()=>t});const t=(0,a(6230).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},9318:(e,n,a)=>{a.d(n,{A:()=>t});const t=(0,a(6230).A)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])}}]);